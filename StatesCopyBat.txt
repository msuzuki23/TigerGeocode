set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\7-Zip\7z.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_01_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_01*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AL_place(CONSTRAINT pk_AL_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_01_place.dbf tiger_staging.al_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AL_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('AL_place'), lower('AL_place')); ALTER TABLE tiger_data.AL_place ADD CONSTRAINT uidx_AL_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_AL_place_soundex_name ON tiger_data.AL_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_AL_place_the_geom_gist ON tiger_data.AL_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.AL_place ADD CONSTRAINT chk_statefp CHECK (statefp = '01');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_01_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_01*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AL_cousub(CONSTRAINT pk_AL_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_AL_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_01_cousub.dbf tiger_staging.al_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AL_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('AL_cousub'), lower('AL_cousub')); ALTER TABLE tiger_data.AL_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '01');"
%PSQL% -c "CREATE INDEX tiger_data_AL_cousub_the_geom_gist ON tiger_data.AL_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AL_cousub_countyfp ON tiger_data.AL_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_01_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_01*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AL_tract(CONSTRAINT pk_AL_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_01_tract.dbf tiger_staging.al_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AL_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('AL_tract'), lower('AL_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_AL_tract_the_geom_gist ON tiger_data.AL_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.AL_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.AL_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '01');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_01091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_01067_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_01*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AL_faces(CONSTRAINT pk_AL_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AL_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AL_faces'), lower('AL_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_AL_faces_the_geom_gist ON tiger_data.AL_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AL_faces_tfid ON tiger_data.AL_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AL_faces_countyfp ON tiger_data.AL_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.AL_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '01');"
	%PSQL% -c "vacuum analyze tiger_data.AL_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_01091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_01067_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_01*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AL_featnames(CONSTRAINT pk_AL_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.AL_featnames ALTER COLUMN statefp SET DEFAULT '01';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AL_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AL_featnames'), lower('AL_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_AL_featnames_snd_name ON tiger_data.AL_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_AL_featnames_lname ON tiger_data.AL_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_AL_featnames_tlid_statefp ON tiger_data.AL_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.AL_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '01');"
%PSQL% -c "vacuum analyze tiger_data.AL_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_01091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_01067_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_01*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AL_edges(CONSTRAINT pk_AL_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AL_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AL_edges'), lower('AL_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.AL_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '01');"
%PSQL% -c "CREATE INDEX idx_tiger_data_AL_edges_tlid ON tiger_data.AL_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AL_edgestfidr ON tiger_data.AL_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AL_edges_tfidl ON tiger_data.AL_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AL_edges_countyfp ON tiger_data.AL_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_AL_edges_the_geom_gist ON tiger_data.AL_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AL_edges_zipl ON tiger_data.AL_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.AL_zip_state_loc(CONSTRAINT pk_AL_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.AL_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'AL', '01', p.name FROM tiger_data.AL_edges AS e INNER JOIN tiger_data.AL_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.AL_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_AL_zip_state_loc_place ON tiger_data.AL_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.AL_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '01');"
%PSQL% -c "vacuum analyze tiger_data.AL_edges;"
%PSQL% -c "vacuum analyze tiger_data.AL_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.AL_zip_lookup_base(CONSTRAINT pk_AL_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.AL_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'AL', c.name,p.name,'01'  FROM tiger_data.AL_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '01') INNER JOIN tiger_data.AL_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.AL_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.AL_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '01');"
%PSQL% -c "CREATE INDEX idx_tiger_data_AL_zip_lookup_base_citysnd ON tiger_data.AL_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_01091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_01067_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_01*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AL_addr(CONSTRAINT pk_AL_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.AL_addr ALTER COLUMN statefp SET DEFAULT '01';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AL_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AL_addr'), lower('AL_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.AL_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '01');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AL_addr_least_address ON tiger_data.AL_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AL_addr_tlid_statefp ON tiger_data.AL_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AL_addr_zip ON tiger_data.AL_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.AL_zip_state(CONSTRAINT pk_AL_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.AL_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'AL', '01' FROM tiger_data.AL_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.AL_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '01');"
	%PSQL% -c "vacuum analyze tiger_data.AL_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_02_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_02*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AK_place(CONSTRAINT pk_AK_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_02_place.dbf tiger_staging.ak_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AK_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('AK_place'), lower('AK_place')); ALTER TABLE tiger_data.AK_place ADD CONSTRAINT uidx_AK_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_AK_place_soundex_name ON tiger_data.AK_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_AK_place_the_geom_gist ON tiger_data.AK_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.AK_place ADD CONSTRAINT chk_statefp CHECK (statefp = '02');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_02_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_02*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AK_cousub(CONSTRAINT pk_AK_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_AK_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_02_cousub.dbf tiger_staging.ak_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AK_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('AK_cousub'), lower('AK_cousub')); ALTER TABLE tiger_data.AK_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '02');"
%PSQL% -c "CREATE INDEX tiger_data_AK_cousub_the_geom_gist ON tiger_data.AK_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AK_cousub_countyfp ON tiger_data.AK_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_02_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_02*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AK_tract(CONSTRAINT pk_AK_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_02_tract.dbf tiger_staging.ak_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AK_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('AK_tract'), lower('AK_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_AK_tract_the_geom_gist ON tiger_data.AK_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.AK_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.AK_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '02');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_02130_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02188_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02220_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02290_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02020_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02198_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02195_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02275_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02110_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02122_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02068_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02240_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02261_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02100_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02090_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02050_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02164_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02060_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02070_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02170_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02158_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02185_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02180_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02016_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02150_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02282_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02230_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_02105_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_02*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AK_faces(CONSTRAINT pk_AK_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AK_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AK_faces'), lower('AK_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_AK_faces_the_geom_gist ON tiger_data.AK_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AK_faces_tfid ON tiger_data.AK_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AK_faces_countyfp ON tiger_data.AK_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.AK_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '02');"
	%PSQL% -c "vacuum analyze tiger_data.AK_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_02130_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02188_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02220_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02290_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02020_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02198_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02195_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02275_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02110_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02122_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02068_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02240_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02261_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02100_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02090_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02050_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02164_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02060_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02070_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02170_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02158_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02185_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02180_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02016_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02150_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02282_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02230_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_02105_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_02*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AK_featnames(CONSTRAINT pk_AK_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.AK_featnames ALTER COLUMN statefp SET DEFAULT '02';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AK_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AK_featnames'), lower('AK_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_AK_featnames_snd_name ON tiger_data.AK_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_AK_featnames_lname ON tiger_data.AK_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_AK_featnames_tlid_statefp ON tiger_data.AK_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.AK_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '02');"
%PSQL% -c "vacuum analyze tiger_data.AK_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_02130_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02188_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02220_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02290_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02020_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02198_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02195_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02275_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02110_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02122_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02068_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02240_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02261_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02100_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02090_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02050_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02164_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02060_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02070_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02170_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02158_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02185_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02180_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02016_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02150_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02282_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02230_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_02105_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_02*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AK_edges(CONSTRAINT pk_AK_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AK_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AK_edges'), lower('AK_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.AK_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '02');"
%PSQL% -c "CREATE INDEX idx_tiger_data_AK_edges_tlid ON tiger_data.AK_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AK_edgestfidr ON tiger_data.AK_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AK_edges_tfidl ON tiger_data.AK_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AK_edges_countyfp ON tiger_data.AK_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_AK_edges_the_geom_gist ON tiger_data.AK_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AK_edges_zipl ON tiger_data.AK_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.AK_zip_state_loc(CONSTRAINT pk_AK_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.AK_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'AK', '02', p.name FROM tiger_data.AK_edges AS e INNER JOIN tiger_data.AK_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.AK_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_AK_zip_state_loc_place ON tiger_data.AK_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.AK_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '02');"
%PSQL% -c "vacuum analyze tiger_data.AK_edges;"
%PSQL% -c "vacuum analyze tiger_data.AK_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.AK_zip_lookup_base(CONSTRAINT pk_AK_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.AK_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'AK', c.name,p.name,'02'  FROM tiger_data.AK_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '02') INNER JOIN tiger_data.AK_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.AK_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.AK_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '02');"
%PSQL% -c "CREATE INDEX idx_tiger_data_AK_zip_lookup_base_citysnd ON tiger_data.AK_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_02130_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02188_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02220_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02290_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02020_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02198_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02195_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02275_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02110_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02122_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02068_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02240_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02261_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02100_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02090_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02050_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02164_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02060_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02070_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02170_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02158_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02185_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02180_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02016_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02150_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02282_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02230_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_02105_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_02*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AK_addr(CONSTRAINT pk_AK_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.AK_addr ALTER COLUMN statefp SET DEFAULT '02';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AK_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AK_addr'), lower('AK_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.AK_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '02');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AK_addr_least_address ON tiger_data.AK_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AK_addr_tlid_statefp ON tiger_data.AK_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AK_addr_zip ON tiger_data.AK_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.AK_zip_state(CONSTRAINT pk_AK_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.AK_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'AK', '02' FROM tiger_data.AK_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.AK_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '02');"
	%PSQL% -c "vacuum analyze tiger_data.AK_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_60_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_60*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AS_place(CONSTRAINT pk_AS_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_60_place.dbf tiger_staging.as_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AS_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('AS_place'), lower('AS_place')); ALTER TABLE tiger_data.AS_place ADD CONSTRAINT uidx_AS_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_AS_place_soundex_name ON tiger_data.AS_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_AS_place_the_geom_gist ON tiger_data.AS_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.AS_place ADD CONSTRAINT chk_statefp CHECK (statefp = '60');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_60_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_60*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AS_cousub(CONSTRAINT pk_AS_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_AS_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_60_cousub.dbf tiger_staging.as_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AS_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('AS_cousub'), lower('AS_cousub')); ALTER TABLE tiger_data.AS_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '60');"
%PSQL% -c "CREATE INDEX tiger_data_AS_cousub_the_geom_gist ON tiger_data.AS_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AS_cousub_countyfp ON tiger_data.AS_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_60_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_60*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AS_tract(CONSTRAINT pk_AS_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_60_tract.dbf tiger_staging.as_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AS_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('AS_tract'), lower('AS_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_AS_tract_the_geom_gist ON tiger_data.AS_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.AS_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.AS_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '60');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_60020_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_60010_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_60050_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_60040_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_60030_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_60*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AS_faces(CONSTRAINT pk_AS_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AS_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AS_faces'), lower('AS_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_AS_faces_the_geom_gist ON tiger_data.AS_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AS_faces_tfid ON tiger_data.AS_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AS_faces_countyfp ON tiger_data.AS_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.AS_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '60');"
	%PSQL% -c "vacuum analyze tiger_data.AS_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_60020_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_60010_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_60050_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_60040_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_60030_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_60*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AS_featnames(CONSTRAINT pk_AS_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.AS_featnames ALTER COLUMN statefp SET DEFAULT '60';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AS_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AS_featnames'), lower('AS_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_AS_featnames_snd_name ON tiger_data.AS_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_AS_featnames_lname ON tiger_data.AS_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_AS_featnames_tlid_statefp ON tiger_data.AS_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.AS_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '60');"
%PSQL% -c "vacuum analyze tiger_data.AS_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_60020_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_60010_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_60050_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_60040_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_60030_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_60*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AS_edges(CONSTRAINT pk_AS_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AS_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AS_edges'), lower('AS_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.AS_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '60');"
%PSQL% -c "CREATE INDEX idx_tiger_data_AS_edges_tlid ON tiger_data.AS_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AS_edgestfidr ON tiger_data.AS_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AS_edges_tfidl ON tiger_data.AS_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AS_edges_countyfp ON tiger_data.AS_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_AS_edges_the_geom_gist ON tiger_data.AS_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AS_edges_zipl ON tiger_data.AS_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.AS_zip_state_loc(CONSTRAINT pk_AS_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.AS_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'AS', '60', p.name FROM tiger_data.AS_edges AS e INNER JOIN tiger_data.AS_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.AS_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_AS_zip_state_loc_place ON tiger_data.AS_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.AS_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '60');"
%PSQL% -c "vacuum analyze tiger_data.AS_edges;"
%PSQL% -c "vacuum analyze tiger_data.AS_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.AS_zip_lookup_base(CONSTRAINT pk_AS_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.AS_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'AS', c.name,p.name,'60'  FROM tiger_data.AS_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '60') INNER JOIN tiger_data.AS_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.AS_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.AS_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '60');"
%PSQL% -c "CREATE INDEX idx_tiger_data_AS_zip_lookup_base_citysnd ON tiger_data.AS_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_60020_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_60010_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_60050_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_60040_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_60030_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_60*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AS_addr(CONSTRAINT pk_AS_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.AS_addr ALTER COLUMN statefp SET DEFAULT '60';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AS_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AS_addr'), lower('AS_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.AS_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '60');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AS_addr_least_address ON tiger_data.AS_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AS_addr_tlid_statefp ON tiger_data.AS_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AS_addr_zip ON tiger_data.AS_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.AS_zip_state(CONSTRAINT pk_AS_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.AS_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'AS', '60' FROM tiger_data.AS_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.AS_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '60');"
	%PSQL% -c "vacuum analyze tiger_data.AS_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_04_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_04*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AZ_place(CONSTRAINT pk_AZ_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_04_place.dbf tiger_staging.az_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AZ_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('AZ_place'), lower('AZ_place')); ALTER TABLE tiger_data.AZ_place ADD CONSTRAINT uidx_AZ_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_AZ_place_soundex_name ON tiger_data.AZ_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_AZ_place_the_geom_gist ON tiger_data.AZ_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.AZ_place ADD CONSTRAINT chk_statefp CHECK (statefp = '04');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_04_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_04*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AZ_cousub(CONSTRAINT pk_AZ_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_AZ_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_04_cousub.dbf tiger_staging.az_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AZ_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('AZ_cousub'), lower('AZ_cousub')); ALTER TABLE tiger_data.AZ_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '04');"
%PSQL% -c "CREATE INDEX tiger_data_AZ_cousub_the_geom_gist ON tiger_data.AZ_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_cousub_countyfp ON tiger_data.AZ_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_04_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_04*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AZ_tract(CONSTRAINT pk_AZ_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_04_tract.dbf tiger_staging.az_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AZ_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('AZ_tract'), lower('AZ_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_AZ_tract_the_geom_gist ON tiger_data.AZ_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.AZ_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.AZ_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '04');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_04027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04012_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_04001_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_04*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AZ_faces(CONSTRAINT pk_AZ_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AZ_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AZ_faces'), lower('AZ_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_AZ_faces_the_geom_gist ON tiger_data.AZ_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_faces_tfid ON tiger_data.AZ_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_faces_countyfp ON tiger_data.AZ_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.AZ_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '04');"
	%PSQL% -c "vacuum analyze tiger_data.AZ_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_04027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04012_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_04001_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_04*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AZ_featnames(CONSTRAINT pk_AZ_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.AZ_featnames ALTER COLUMN statefp SET DEFAULT '04';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AZ_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AZ_featnames'), lower('AZ_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_featnames_snd_name ON tiger_data.AZ_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_featnames_lname ON tiger_data.AZ_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_featnames_tlid_statefp ON tiger_data.AZ_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.AZ_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '04');"
%PSQL% -c "vacuum analyze tiger_data.AZ_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_04027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04012_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_04001_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_04*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AZ_edges(CONSTRAINT pk_AZ_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AZ_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AZ_edges'), lower('AZ_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.AZ_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '04');"
%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_edges_tlid ON tiger_data.AZ_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_edgestfidr ON tiger_data.AZ_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_edges_tfidl ON tiger_data.AZ_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_edges_countyfp ON tiger_data.AZ_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_AZ_edges_the_geom_gist ON tiger_data.AZ_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_edges_zipl ON tiger_data.AZ_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.AZ_zip_state_loc(CONSTRAINT pk_AZ_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.AZ_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'AZ', '04', p.name FROM tiger_data.AZ_edges AS e INNER JOIN tiger_data.AZ_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.AZ_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_zip_state_loc_place ON tiger_data.AZ_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.AZ_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '04');"
%PSQL% -c "vacuum analyze tiger_data.AZ_edges;"
%PSQL% -c "vacuum analyze tiger_data.AZ_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.AZ_zip_lookup_base(CONSTRAINT pk_AZ_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.AZ_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'AZ', c.name,p.name,'04'  FROM tiger_data.AZ_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '04') INNER JOIN tiger_data.AZ_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.AZ_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.AZ_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '04');"
%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_zip_lookup_base_citysnd ON tiger_data.AZ_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_04027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04012_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_04001_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_04*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AZ_addr(CONSTRAINT pk_AZ_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.AZ_addr ALTER COLUMN statefp SET DEFAULT '04';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AZ_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AZ_addr'), lower('AZ_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.AZ_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '04');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_addr_least_address ON tiger_data.AZ_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_addr_tlid_statefp ON tiger_data.AZ_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AZ_addr_zip ON tiger_data.AZ_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.AZ_zip_state(CONSTRAINT pk_AZ_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.AZ_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'AZ', '04' FROM tiger_data.AZ_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.AZ_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '04');"
	%PSQL% -c "vacuum analyze tiger_data.AZ_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_05_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_05*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AR_place(CONSTRAINT pk_AR_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_05_place.dbf tiger_staging.ar_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AR_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('AR_place'), lower('AR_place')); ALTER TABLE tiger_data.AR_place ADD CONSTRAINT uidx_AR_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_AR_place_soundex_name ON tiger_data.AR_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_AR_place_the_geom_gist ON tiger_data.AR_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.AR_place ADD CONSTRAINT chk_statefp CHECK (statefp = '05');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_05_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_05*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AR_cousub(CONSTRAINT pk_AR_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_AR_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_05_cousub.dbf tiger_staging.ar_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AR_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('AR_cousub'), lower('AR_cousub')); ALTER TABLE tiger_data.AR_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '05');"
%PSQL% -c "CREATE INDEX tiger_data_AR_cousub_the_geom_gist ON tiger_data.AR_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AR_cousub_countyfp ON tiger_data.AR_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_05_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_05*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AR_tract(CONSTRAINT pk_AR_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_05_tract.dbf tiger_staging.ar_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.AR_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('AR_tract'), lower('AR_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_AR_tract_the_geom_gist ON tiger_data.AR_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.AR_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.AR_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '05');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_05137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_05057_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_05*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AR_faces(CONSTRAINT pk_AR_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AR_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AR_faces'), lower('AR_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_AR_faces_the_geom_gist ON tiger_data.AR_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AR_faces_tfid ON tiger_data.AR_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AR_faces_countyfp ON tiger_data.AR_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.AR_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '05');"
	%PSQL% -c "vacuum analyze tiger_data.AR_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_05137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_05057_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_05*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AR_featnames(CONSTRAINT pk_AR_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.AR_featnames ALTER COLUMN statefp SET DEFAULT '05';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AR_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AR_featnames'), lower('AR_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_AR_featnames_snd_name ON tiger_data.AR_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_AR_featnames_lname ON tiger_data.AR_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_AR_featnames_tlid_statefp ON tiger_data.AR_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.AR_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '05');"
%PSQL% -c "vacuum analyze tiger_data.AR_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_05137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_05057_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_05*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AR_edges(CONSTRAINT pk_AR_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AR_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AR_edges'), lower('AR_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.AR_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '05');"
%PSQL% -c "CREATE INDEX idx_tiger_data_AR_edges_tlid ON tiger_data.AR_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AR_edgestfidr ON tiger_data.AR_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AR_edges_tfidl ON tiger_data.AR_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AR_edges_countyfp ON tiger_data.AR_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_AR_edges_the_geom_gist ON tiger_data.AR_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_AR_edges_zipl ON tiger_data.AR_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.AR_zip_state_loc(CONSTRAINT pk_AR_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.AR_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'AR', '05', p.name FROM tiger_data.AR_edges AS e INNER JOIN tiger_data.AR_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.AR_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_AR_zip_state_loc_place ON tiger_data.AR_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.AR_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '05');"
%PSQL% -c "vacuum analyze tiger_data.AR_edges;"
%PSQL% -c "vacuum analyze tiger_data.AR_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.AR_zip_lookup_base(CONSTRAINT pk_AR_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.AR_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'AR', c.name,p.name,'05'  FROM tiger_data.AR_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '05') INNER JOIN tiger_data.AR_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.AR_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.AR_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '05');"
%PSQL% -c "CREATE INDEX idx_tiger_data_AR_zip_lookup_base_citysnd ON tiger_data.AR_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_05137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_05057_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_05*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.AR_addr(CONSTRAINT pk_AR_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.AR_addr ALTER COLUMN statefp SET DEFAULT '05';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.AR_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('AR_addr'), lower('AR_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.AR_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '05');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AR_addr_least_address ON tiger_data.AR_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AR_addr_tlid_statefp ON tiger_data.AR_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_AR_addr_zip ON tiger_data.AR_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.AR_zip_state(CONSTRAINT pk_AR_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.AR_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'AR', '05' FROM tiger_data.AR_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.AR_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '05');"
	%PSQL% -c "vacuum analyze tiger_data.AR_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_06_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_06*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CA_place(CONSTRAINT pk_CA_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_06_place.dbf tiger_staging.ca_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.CA_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('CA_place'), lower('CA_place')); ALTER TABLE tiger_data.CA_place ADD CONSTRAINT uidx_CA_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_CA_place_soundex_name ON tiger_data.CA_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_CA_place_the_geom_gist ON tiger_data.CA_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.CA_place ADD CONSTRAINT chk_statefp CHECK (statefp = '06');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_06_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_06*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CA_cousub(CONSTRAINT pk_CA_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_CA_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_06_cousub.dbf tiger_staging.ca_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.CA_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('CA_cousub'), lower('CA_cousub')); ALTER TABLE tiger_data.CA_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '06');"
%PSQL% -c "CREATE INDEX tiger_data_CA_cousub_the_geom_gist ON tiger_data.CA_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CA_cousub_countyfp ON tiger_data.CA_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_06_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_06*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CA_tract(CONSTRAINT pk_CA_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_06_tract.dbf tiger_staging.ca_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.CA_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('CA_tract'), lower('CA_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_CA_tract_the_geom_gist ON tiger_data.CA_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.CA_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.CA_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '06');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_06091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_06079_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_06*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CA_faces(CONSTRAINT pk_CA_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.CA_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('CA_faces'), lower('CA_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_CA_faces_the_geom_gist ON tiger_data.CA_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CA_faces_tfid ON tiger_data.CA_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CA_faces_countyfp ON tiger_data.CA_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.CA_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '06');"
	%PSQL% -c "vacuum analyze tiger_data.CA_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_06091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_06079_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_06*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CA_featnames(CONSTRAINT pk_CA_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.CA_featnames ALTER COLUMN statefp SET DEFAULT '06';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.CA_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('CA_featnames'), lower('CA_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_CA_featnames_snd_name ON tiger_data.CA_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_CA_featnames_lname ON tiger_data.CA_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_CA_featnames_tlid_statefp ON tiger_data.CA_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.CA_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '06');"
%PSQL% -c "vacuum analyze tiger_data.CA_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_06091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_06079_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_06*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CA_edges(CONSTRAINT pk_CA_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.CA_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('CA_edges'), lower('CA_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.CA_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '06');"
%PSQL% -c "CREATE INDEX idx_tiger_data_CA_edges_tlid ON tiger_data.CA_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CA_edgestfidr ON tiger_data.CA_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CA_edges_tfidl ON tiger_data.CA_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CA_edges_countyfp ON tiger_data.CA_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_CA_edges_the_geom_gist ON tiger_data.CA_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CA_edges_zipl ON tiger_data.CA_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.CA_zip_state_loc(CONSTRAINT pk_CA_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.CA_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'CA', '06', p.name FROM tiger_data.CA_edges AS e INNER JOIN tiger_data.CA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.CA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_CA_zip_state_loc_place ON tiger_data.CA_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.CA_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '06');"
%PSQL% -c "vacuum analyze tiger_data.CA_edges;"
%PSQL% -c "vacuum analyze tiger_data.CA_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.CA_zip_lookup_base(CONSTRAINT pk_CA_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.CA_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'CA', c.name,p.name,'06'  FROM tiger_data.CA_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '06') INNER JOIN tiger_data.CA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.CA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.CA_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '06');"
%PSQL% -c "CREATE INDEX idx_tiger_data_CA_zip_lookup_base_citysnd ON tiger_data.CA_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_06091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_06079_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_06*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CA_addr(CONSTRAINT pk_CA_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.CA_addr ALTER COLUMN statefp SET DEFAULT '06';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.CA_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('CA_addr'), lower('CA_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.CA_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '06');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CA_addr_least_address ON tiger_data.CA_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CA_addr_tlid_statefp ON tiger_data.CA_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CA_addr_zip ON tiger_data.CA_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.CA_zip_state(CONSTRAINT pk_CA_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.CA_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'CA', '06' FROM tiger_data.CA_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.CA_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '06');"
	%PSQL% -c "vacuum analyze tiger_data.CA_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_08_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_08*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CO_place(CONSTRAINT pk_CO_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_08_place.dbf tiger_staging.co_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.CO_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('CO_place'), lower('CO_place')); ALTER TABLE tiger_data.CO_place ADD CONSTRAINT uidx_CO_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_CO_place_soundex_name ON tiger_data.CO_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_CO_place_the_geom_gist ON tiger_data.CO_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.CO_place ADD CONSTRAINT chk_statefp CHECK (statefp = '08');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_08_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_08*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CO_cousub(CONSTRAINT pk_CO_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_CO_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_08_cousub.dbf tiger_staging.co_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.CO_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('CO_cousub'), lower('CO_cousub')); ALTER TABLE tiger_data.CO_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '08');"
%PSQL% -c "CREATE INDEX tiger_data_CO_cousub_the_geom_gist ON tiger_data.CO_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CO_cousub_countyfp ON tiger_data.CO_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_08_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_08*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CO_tract(CONSTRAINT pk_CO_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_08_tract.dbf tiger_staging.co_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.CO_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('CO_tract'), lower('CO_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_CO_tract_the_geom_gist ON tiger_data.CO_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.CO_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.CO_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '08');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_08109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08014_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_08049_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_08*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CO_faces(CONSTRAINT pk_CO_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.CO_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('CO_faces'), lower('CO_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_CO_faces_the_geom_gist ON tiger_data.CO_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CO_faces_tfid ON tiger_data.CO_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CO_faces_countyfp ON tiger_data.CO_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.CO_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '08');"
	%PSQL% -c "vacuum analyze tiger_data.CO_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_08109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08014_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_08049_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_08*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CO_featnames(CONSTRAINT pk_CO_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.CO_featnames ALTER COLUMN statefp SET DEFAULT '08';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.CO_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('CO_featnames'), lower('CO_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_CO_featnames_snd_name ON tiger_data.CO_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_CO_featnames_lname ON tiger_data.CO_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_CO_featnames_tlid_statefp ON tiger_data.CO_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.CO_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '08');"
%PSQL% -c "vacuum analyze tiger_data.CO_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_08109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08014_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_08049_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_08*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CO_edges(CONSTRAINT pk_CO_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.CO_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('CO_edges'), lower('CO_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.CO_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '08');"
%PSQL% -c "CREATE INDEX idx_tiger_data_CO_edges_tlid ON tiger_data.CO_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CO_edgestfidr ON tiger_data.CO_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CO_edges_tfidl ON tiger_data.CO_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CO_edges_countyfp ON tiger_data.CO_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_CO_edges_the_geom_gist ON tiger_data.CO_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CO_edges_zipl ON tiger_data.CO_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.CO_zip_state_loc(CONSTRAINT pk_CO_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.CO_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'CO', '08', p.name FROM tiger_data.CO_edges AS e INNER JOIN tiger_data.CO_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.CO_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_CO_zip_state_loc_place ON tiger_data.CO_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.CO_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '08');"
%PSQL% -c "vacuum analyze tiger_data.CO_edges;"
%PSQL% -c "vacuum analyze tiger_data.CO_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.CO_zip_lookup_base(CONSTRAINT pk_CO_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.CO_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'CO', c.name,p.name,'08'  FROM tiger_data.CO_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '08') INNER JOIN tiger_data.CO_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.CO_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.CO_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '08');"
%PSQL% -c "CREATE INDEX idx_tiger_data_CO_zip_lookup_base_citysnd ON tiger_data.CO_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_08109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08014_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_08049_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_08*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CO_addr(CONSTRAINT pk_CO_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.CO_addr ALTER COLUMN statefp SET DEFAULT '08';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.CO_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('CO_addr'), lower('CO_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.CO_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '08');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CO_addr_least_address ON tiger_data.CO_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CO_addr_tlid_statefp ON tiger_data.CO_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CO_addr_zip ON tiger_data.CO_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.CO_zip_state(CONSTRAINT pk_CO_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.CO_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'CO', '08' FROM tiger_data.CO_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.CO_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '08');"
	%PSQL% -c "vacuum analyze tiger_data.CO_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_09_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_09*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CT_place(CONSTRAINT pk_CT_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_09_place.dbf tiger_staging.ct_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.CT_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('CT_place'), lower('CT_place')); ALTER TABLE tiger_data.CT_place ADD CONSTRAINT uidx_CT_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_CT_place_soundex_name ON tiger_data.CT_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_CT_place_the_geom_gist ON tiger_data.CT_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.CT_place ADD CONSTRAINT chk_statefp CHECK (statefp = '09');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_09_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_09*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CT_cousub(CONSTRAINT pk_CT_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_CT_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_09_cousub.dbf tiger_staging.ct_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.CT_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('CT_cousub'), lower('CT_cousub')); ALTER TABLE tiger_data.CT_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '09');"
%PSQL% -c "CREATE INDEX tiger_data_CT_cousub_the_geom_gist ON tiger_data.CT_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CT_cousub_countyfp ON tiger_data.CT_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_09_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_09*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CT_tract(CONSTRAINT pk_CT_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_09_tract.dbf tiger_staging.ct_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.CT_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('CT_tract'), lower('CT_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_CT_tract_the_geom_gist ON tiger_data.CT_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.CT_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.CT_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '09');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_09007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_09011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_09009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_09013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_09003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_09015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_09001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_09005_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_09*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CT_faces(CONSTRAINT pk_CT_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.CT_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('CT_faces'), lower('CT_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_CT_faces_the_geom_gist ON tiger_data.CT_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CT_faces_tfid ON tiger_data.CT_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CT_faces_countyfp ON tiger_data.CT_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.CT_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '09');"
	%PSQL% -c "vacuum analyze tiger_data.CT_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_09007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_09011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_09009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_09013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_09003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_09015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_09001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_09005_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_09*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CT_featnames(CONSTRAINT pk_CT_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.CT_featnames ALTER COLUMN statefp SET DEFAULT '09';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.CT_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('CT_featnames'), lower('CT_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_CT_featnames_snd_name ON tiger_data.CT_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_CT_featnames_lname ON tiger_data.CT_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_CT_featnames_tlid_statefp ON tiger_data.CT_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.CT_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '09');"
%PSQL% -c "vacuum analyze tiger_data.CT_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_09007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_09011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_09009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_09013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_09003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_09015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_09001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_09005_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_09*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CT_edges(CONSTRAINT pk_CT_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.CT_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('CT_edges'), lower('CT_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.CT_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '09');"
%PSQL% -c "CREATE INDEX idx_tiger_data_CT_edges_tlid ON tiger_data.CT_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CT_edgestfidr ON tiger_data.CT_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CT_edges_tfidl ON tiger_data.CT_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CT_edges_countyfp ON tiger_data.CT_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_CT_edges_the_geom_gist ON tiger_data.CT_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_CT_edges_zipl ON tiger_data.CT_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.CT_zip_state_loc(CONSTRAINT pk_CT_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.CT_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'CT', '09', p.name FROM tiger_data.CT_edges AS e INNER JOIN tiger_data.CT_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.CT_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_CT_zip_state_loc_place ON tiger_data.CT_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.CT_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '09');"
%PSQL% -c "vacuum analyze tiger_data.CT_edges;"
%PSQL% -c "vacuum analyze tiger_data.CT_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.CT_zip_lookup_base(CONSTRAINT pk_CT_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.CT_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'CT', c.name,p.name,'09'  FROM tiger_data.CT_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '09') INNER JOIN tiger_data.CT_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.CT_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.CT_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '09');"
%PSQL% -c "CREATE INDEX idx_tiger_data_CT_zip_lookup_base_citysnd ON tiger_data.CT_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_09007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_09011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_09009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_09013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_09003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_09015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_09001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_09005_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_09*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.CT_addr(CONSTRAINT pk_CT_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.CT_addr ALTER COLUMN statefp SET DEFAULT '09';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.CT_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('CT_addr'), lower('CT_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.CT_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '09');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CT_addr_least_address ON tiger_data.CT_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CT_addr_tlid_statefp ON tiger_data.CT_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_CT_addr_zip ON tiger_data.CT_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.CT_zip_state(CONSTRAINT pk_CT_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.CT_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'CT', '09' FROM tiger_data.CT_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.CT_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '09');"
	%PSQL% -c "vacuum analyze tiger_data.CT_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_10_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_10*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DE_place(CONSTRAINT pk_DE_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_10_place.dbf tiger_staging.de_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.DE_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('DE_place'), lower('DE_place')); ALTER TABLE tiger_data.DE_place ADD CONSTRAINT uidx_DE_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_DE_place_soundex_name ON tiger_data.DE_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_DE_place_the_geom_gist ON tiger_data.DE_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.DE_place ADD CONSTRAINT chk_statefp CHECK (statefp = '10');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_10_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_10*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DE_cousub(CONSTRAINT pk_DE_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_DE_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_10_cousub.dbf tiger_staging.de_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.DE_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('DE_cousub'), lower('DE_cousub')); ALTER TABLE tiger_data.DE_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '10');"
%PSQL% -c "CREATE INDEX tiger_data_DE_cousub_the_geom_gist ON tiger_data.DE_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_DE_cousub_countyfp ON tiger_data.DE_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_10_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_10*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DE_tract(CONSTRAINT pk_DE_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_10_tract.dbf tiger_staging.de_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.DE_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('DE_tract'), lower('DE_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_DE_tract_the_geom_gist ON tiger_data.DE_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.DE_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.DE_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '10');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_10003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_10005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_10001_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_10*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DE_faces(CONSTRAINT pk_DE_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.DE_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('DE_faces'), lower('DE_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_DE_faces_the_geom_gist ON tiger_data.DE_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_DE_faces_tfid ON tiger_data.DE_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_DE_faces_countyfp ON tiger_data.DE_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.DE_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '10');"
	%PSQL% -c "vacuum analyze tiger_data.DE_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_10003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_10005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_10001_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_10*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DE_featnames(CONSTRAINT pk_DE_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.DE_featnames ALTER COLUMN statefp SET DEFAULT '10';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.DE_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('DE_featnames'), lower('DE_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_DE_featnames_snd_name ON tiger_data.DE_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_DE_featnames_lname ON tiger_data.DE_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_DE_featnames_tlid_statefp ON tiger_data.DE_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.DE_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '10');"
%PSQL% -c "vacuum analyze tiger_data.DE_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_10003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_10005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_10001_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_10*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DE_edges(CONSTRAINT pk_DE_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.DE_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('DE_edges'), lower('DE_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.DE_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '10');"
%PSQL% -c "CREATE INDEX idx_tiger_data_DE_edges_tlid ON tiger_data.DE_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_DE_edgestfidr ON tiger_data.DE_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_DE_edges_tfidl ON tiger_data.DE_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_DE_edges_countyfp ON tiger_data.DE_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_DE_edges_the_geom_gist ON tiger_data.DE_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_DE_edges_zipl ON tiger_data.DE_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.DE_zip_state_loc(CONSTRAINT pk_DE_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.DE_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'DE', '10', p.name FROM tiger_data.DE_edges AS e INNER JOIN tiger_data.DE_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.DE_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_DE_zip_state_loc_place ON tiger_data.DE_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.DE_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '10');"
%PSQL% -c "vacuum analyze tiger_data.DE_edges;"
%PSQL% -c "vacuum analyze tiger_data.DE_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.DE_zip_lookup_base(CONSTRAINT pk_DE_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.DE_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'DE', c.name,p.name,'10'  FROM tiger_data.DE_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '10') INNER JOIN tiger_data.DE_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.DE_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.DE_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '10');"
%PSQL% -c "CREATE INDEX idx_tiger_data_DE_zip_lookup_base_citysnd ON tiger_data.DE_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_10003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_10005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_10001_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_10*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DE_addr(CONSTRAINT pk_DE_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.DE_addr ALTER COLUMN statefp SET DEFAULT '10';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.DE_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('DE_addr'), lower('DE_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.DE_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '10');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_DE_addr_least_address ON tiger_data.DE_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_DE_addr_tlid_statefp ON tiger_data.DE_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_DE_addr_zip ON tiger_data.DE_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.DE_zip_state(CONSTRAINT pk_DE_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.DE_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'DE', '10' FROM tiger_data.DE_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.DE_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '10');"
	%PSQL% -c "vacuum analyze tiger_data.DE_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_11_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_11*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DC_place(CONSTRAINT pk_DC_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_11_place.dbf tiger_staging.dc_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.DC_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('DC_place'), lower('DC_place')); ALTER TABLE tiger_data.DC_place ADD CONSTRAINT uidx_DC_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_DC_place_soundex_name ON tiger_data.DC_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_DC_place_the_geom_gist ON tiger_data.DC_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.DC_place ADD CONSTRAINT chk_statefp CHECK (statefp = '11');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_11_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_11*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DC_cousub(CONSTRAINT pk_DC_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_DC_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_11_cousub.dbf tiger_staging.dc_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.DC_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('DC_cousub'), lower('DC_cousub')); ALTER TABLE tiger_data.DC_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '11');"
%PSQL% -c "CREATE INDEX tiger_data_DC_cousub_the_geom_gist ON tiger_data.DC_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_DC_cousub_countyfp ON tiger_data.DC_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_11_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_11*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DC_tract(CONSTRAINT pk_DC_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_11_tract.dbf tiger_staging.dc_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.DC_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('DC_tract'), lower('DC_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_DC_tract_the_geom_gist ON tiger_data.DC_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.DC_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.DC_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '11');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_11001_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_11*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DC_faces(CONSTRAINT pk_DC_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.DC_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('DC_faces'), lower('DC_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_DC_faces_the_geom_gist ON tiger_data.DC_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_DC_faces_tfid ON tiger_data.DC_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_DC_faces_countyfp ON tiger_data.DC_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.DC_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '11');"
	%PSQL% -c "vacuum analyze tiger_data.DC_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_11001_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_11*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DC_featnames(CONSTRAINT pk_DC_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.DC_featnames ALTER COLUMN statefp SET DEFAULT '11';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.DC_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('DC_featnames'), lower('DC_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_DC_featnames_snd_name ON tiger_data.DC_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_DC_featnames_lname ON tiger_data.DC_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_DC_featnames_tlid_statefp ON tiger_data.DC_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.DC_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '11');"
%PSQL% -c "vacuum analyze tiger_data.DC_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_11001_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_11*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DC_edges(CONSTRAINT pk_DC_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.DC_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('DC_edges'), lower('DC_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.DC_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '11');"
%PSQL% -c "CREATE INDEX idx_tiger_data_DC_edges_tlid ON tiger_data.DC_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_DC_edgestfidr ON tiger_data.DC_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_DC_edges_tfidl ON tiger_data.DC_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_DC_edges_countyfp ON tiger_data.DC_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_DC_edges_the_geom_gist ON tiger_data.DC_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_DC_edges_zipl ON tiger_data.DC_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.DC_zip_state_loc(CONSTRAINT pk_DC_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.DC_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'DC', '11', p.name FROM tiger_data.DC_edges AS e INNER JOIN tiger_data.DC_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.DC_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_DC_zip_state_loc_place ON tiger_data.DC_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.DC_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '11');"
%PSQL% -c "vacuum analyze tiger_data.DC_edges;"
%PSQL% -c "vacuum analyze tiger_data.DC_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.DC_zip_lookup_base(CONSTRAINT pk_DC_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.DC_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'DC', c.name,p.name,'11'  FROM tiger_data.DC_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '11') INNER JOIN tiger_data.DC_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.DC_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.DC_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '11');"
%PSQL% -c "CREATE INDEX idx_tiger_data_DC_zip_lookup_base_citysnd ON tiger_data.DC_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_11001_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_11*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.DC_addr(CONSTRAINT pk_DC_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.DC_addr ALTER COLUMN statefp SET DEFAULT '11';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.DC_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('DC_addr'), lower('DC_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.DC_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '11');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_DC_addr_least_address ON tiger_data.DC_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_DC_addr_tlid_statefp ON tiger_data.DC_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_DC_addr_zip ON tiger_data.DC_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.DC_zip_state(CONSTRAINT pk_DC_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.DC_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'DC', '11' FROM tiger_data.DC_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.DC_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '11');"
	%PSQL% -c "vacuum analyze tiger_data.DC_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_12_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_12*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.FL_place(CONSTRAINT pk_FL_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_12_place.dbf tiger_staging.fl_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.FL_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('FL_place'), lower('FL_place')); ALTER TABLE tiger_data.FL_place ADD CONSTRAINT uidx_FL_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_FL_place_soundex_name ON tiger_data.FL_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_FL_place_the_geom_gist ON tiger_data.FL_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.FL_place ADD CONSTRAINT chk_statefp CHECK (statefp = '12');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_12_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_12*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.FL_cousub(CONSTRAINT pk_FL_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_FL_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_12_cousub.dbf tiger_staging.fl_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.FL_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('FL_cousub'), lower('FL_cousub')); ALTER TABLE tiger_data.FL_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '12');"
%PSQL% -c "CREATE INDEX tiger_data_FL_cousub_the_geom_gist ON tiger_data.FL_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_FL_cousub_countyfp ON tiger_data.FL_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_12_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_12*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.FL_tract(CONSTRAINT pk_FL_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_12_tract.dbf tiger_staging.fl_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.FL_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('FL_tract'), lower('FL_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_FL_tract_the_geom_gist ON tiger_data.FL_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.FL_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.FL_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '12');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_12131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12086_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_12015_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_12*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.FL_faces(CONSTRAINT pk_FL_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.FL_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('FL_faces'), lower('FL_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_FL_faces_the_geom_gist ON tiger_data.FL_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_FL_faces_tfid ON tiger_data.FL_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_FL_faces_countyfp ON tiger_data.FL_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.FL_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '12');"
	%PSQL% -c "vacuum analyze tiger_data.FL_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_12131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12086_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_12015_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_12*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.FL_featnames(CONSTRAINT pk_FL_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.FL_featnames ALTER COLUMN statefp SET DEFAULT '12';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.FL_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('FL_featnames'), lower('FL_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_FL_featnames_snd_name ON tiger_data.FL_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_FL_featnames_lname ON tiger_data.FL_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_FL_featnames_tlid_statefp ON tiger_data.FL_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.FL_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '12');"
%PSQL% -c "vacuum analyze tiger_data.FL_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_12131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12086_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_12015_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_12*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.FL_edges(CONSTRAINT pk_FL_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.FL_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('FL_edges'), lower('FL_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.FL_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '12');"
%PSQL% -c "CREATE INDEX idx_tiger_data_FL_edges_tlid ON tiger_data.FL_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_FL_edgestfidr ON tiger_data.FL_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_FL_edges_tfidl ON tiger_data.FL_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_FL_edges_countyfp ON tiger_data.FL_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_FL_edges_the_geom_gist ON tiger_data.FL_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_FL_edges_zipl ON tiger_data.FL_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.FL_zip_state_loc(CONSTRAINT pk_FL_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.FL_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'FL', '12', p.name FROM tiger_data.FL_edges AS e INNER JOIN tiger_data.FL_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.FL_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_FL_zip_state_loc_place ON tiger_data.FL_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.FL_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '12');"
%PSQL% -c "vacuum analyze tiger_data.FL_edges;"
%PSQL% -c "vacuum analyze tiger_data.FL_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.FL_zip_lookup_base(CONSTRAINT pk_FL_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.FL_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'FL', c.name,p.name,'12'  FROM tiger_data.FL_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '12') INNER JOIN tiger_data.FL_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.FL_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.FL_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '12');"
%PSQL% -c "CREATE INDEX idx_tiger_data_FL_zip_lookup_base_citysnd ON tiger_data.FL_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_12131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12086_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_12015_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_12*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.FL_addr(CONSTRAINT pk_FL_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.FL_addr ALTER COLUMN statefp SET DEFAULT '12';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.FL_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('FL_addr'), lower('FL_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.FL_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '12');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_FL_addr_least_address ON tiger_data.FL_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_FL_addr_tlid_statefp ON tiger_data.FL_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_FL_addr_zip ON tiger_data.FL_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.FL_zip_state(CONSTRAINT pk_FL_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.FL_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'FL', '12' FROM tiger_data.FL_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.FL_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '12');"
	%PSQL% -c "vacuum analyze tiger_data.FL_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_13_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_13*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GA_place(CONSTRAINT pk_GA_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_13_place.dbf tiger_staging.ga_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.GA_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('GA_place'), lower('GA_place')); ALTER TABLE tiger_data.GA_place ADD CONSTRAINT uidx_GA_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_GA_place_soundex_name ON tiger_data.GA_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_GA_place_the_geom_gist ON tiger_data.GA_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.GA_place ADD CONSTRAINT chk_statefp CHECK (statefp = '13');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_13_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_13*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GA_cousub(CONSTRAINT pk_GA_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_GA_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_13_cousub.dbf tiger_staging.ga_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.GA_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('GA_cousub'), lower('GA_cousub')); ALTER TABLE tiger_data.GA_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '13');"
%PSQL% -c "CREATE INDEX tiger_data_GA_cousub_the_geom_gist ON tiger_data.GA_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_GA_cousub_countyfp ON tiger_data.GA_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_13_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_13*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GA_tract(CONSTRAINT pk_GA_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_13_tract.dbf tiger_staging.ga_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.GA_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('GA_tract'), lower('GA_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_GA_tract_the_geom_gist ON tiger_data.GA_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.GA_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.GA_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '13');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_13025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13189_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13273_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13193_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13233_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13227_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13265_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13279_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13181_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13297_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13251_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13293_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13183_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13223_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13291_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13319_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13199_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13277_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13283_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13215_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13261_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13197_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13263_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13303_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13225_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13311_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13289_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13211_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13309_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13307_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13321_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13229_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13231_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13259_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13285_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13257_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13245_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13305_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13179_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13247_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13315_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13281_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13235_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13299_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13249_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13185_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13287_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13243_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13213_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13239_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13221_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13269_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13209_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13301_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13295_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13241_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13219_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13271_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13201_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13195_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13253_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13237_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13275_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13205_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13217_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13267_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13317_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13313_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13255_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13187_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13191_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13207_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13177_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_13123_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_13*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GA_faces(CONSTRAINT pk_GA_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.GA_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('GA_faces'), lower('GA_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_GA_faces_the_geom_gist ON tiger_data.GA_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_GA_faces_tfid ON tiger_data.GA_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_GA_faces_countyfp ON tiger_data.GA_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.GA_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '13');"
	%PSQL% -c "vacuum analyze tiger_data.GA_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_13025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13189_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13273_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13193_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13233_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13227_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13265_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13279_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13181_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13297_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13251_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13293_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13183_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13223_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13291_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13319_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13199_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13277_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13283_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13215_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13261_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13197_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13263_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13303_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13225_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13311_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13289_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13211_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13309_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13307_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13321_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13229_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13231_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13259_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13285_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13257_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13245_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13305_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13179_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13247_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13315_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13281_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13235_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13299_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13249_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13185_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13287_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13243_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13213_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13239_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13221_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13269_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13209_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13301_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13295_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13241_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13219_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13271_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13201_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13195_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13253_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13237_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13275_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13205_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13217_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13267_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13317_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13313_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13255_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13187_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13191_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13207_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13177_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_13123_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_13*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GA_featnames(CONSTRAINT pk_GA_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.GA_featnames ALTER COLUMN statefp SET DEFAULT '13';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.GA_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('GA_featnames'), lower('GA_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_GA_featnames_snd_name ON tiger_data.GA_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_GA_featnames_lname ON tiger_data.GA_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_GA_featnames_tlid_statefp ON tiger_data.GA_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.GA_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '13');"
%PSQL% -c "vacuum analyze tiger_data.GA_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_13025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13189_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13273_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13193_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13233_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13227_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13265_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13279_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13181_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13297_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13251_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13293_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13183_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13223_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13291_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13319_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13199_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13277_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13283_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13215_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13261_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13197_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13263_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13303_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13225_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13311_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13289_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13211_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13309_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13307_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13321_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13229_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13231_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13259_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13285_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13257_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13245_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13305_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13179_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13247_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13315_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13281_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13235_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13299_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13249_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13185_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13287_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13243_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13213_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13239_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13221_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13269_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13209_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13301_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13295_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13241_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13219_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13271_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13201_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13195_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13253_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13237_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13275_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13205_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13217_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13267_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13317_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13313_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13255_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13187_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13191_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13207_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13177_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_13123_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_13*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GA_edges(CONSTRAINT pk_GA_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.GA_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('GA_edges'), lower('GA_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.GA_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '13');"
%PSQL% -c "CREATE INDEX idx_tiger_data_GA_edges_tlid ON tiger_data.GA_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_GA_edgestfidr ON tiger_data.GA_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_GA_edges_tfidl ON tiger_data.GA_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_GA_edges_countyfp ON tiger_data.GA_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_GA_edges_the_geom_gist ON tiger_data.GA_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_GA_edges_zipl ON tiger_data.GA_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.GA_zip_state_loc(CONSTRAINT pk_GA_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.GA_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'GA', '13', p.name FROM tiger_data.GA_edges AS e INNER JOIN tiger_data.GA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.GA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_GA_zip_state_loc_place ON tiger_data.GA_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.GA_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '13');"
%PSQL% -c "vacuum analyze tiger_data.GA_edges;"
%PSQL% -c "vacuum analyze tiger_data.GA_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.GA_zip_lookup_base(CONSTRAINT pk_GA_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.GA_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'GA', c.name,p.name,'13'  FROM tiger_data.GA_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '13') INNER JOIN tiger_data.GA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.GA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.GA_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '13');"
%PSQL% -c "CREATE INDEX idx_tiger_data_GA_zip_lookup_base_citysnd ON tiger_data.GA_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_13025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13189_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13273_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13193_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13233_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13227_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13265_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13279_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13181_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13297_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13251_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13293_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13183_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13223_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13291_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13319_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13199_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13277_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13283_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13215_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13261_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13197_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13263_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13303_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13225_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13311_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13289_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13211_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13309_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13307_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13321_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13229_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13231_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13259_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13285_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13257_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13245_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13305_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13179_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13247_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13315_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13281_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13235_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13299_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13249_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13185_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13287_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13243_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13213_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13239_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13221_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13269_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13209_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13301_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13295_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13241_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13219_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13271_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13201_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13195_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13253_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13237_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13275_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13205_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13217_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13267_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13317_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13313_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13255_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13187_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13191_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13207_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13177_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_13123_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_13*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GA_addr(CONSTRAINT pk_GA_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.GA_addr ALTER COLUMN statefp SET DEFAULT '13';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.GA_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('GA_addr'), lower('GA_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.GA_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '13');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_GA_addr_least_address ON tiger_data.GA_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_GA_addr_tlid_statefp ON tiger_data.GA_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_GA_addr_zip ON tiger_data.GA_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.GA_zip_state(CONSTRAINT pk_GA_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.GA_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'GA', '13' FROM tiger_data.GA_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.GA_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '13');"
	%PSQL% -c "vacuum analyze tiger_data.GA_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_66_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_66*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GU_place(CONSTRAINT pk_GU_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_66_place.dbf tiger_staging.gu_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.GU_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('GU_place'), lower('GU_place')); ALTER TABLE tiger_data.GU_place ADD CONSTRAINT uidx_GU_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_GU_place_soundex_name ON tiger_data.GU_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_GU_place_the_geom_gist ON tiger_data.GU_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.GU_place ADD CONSTRAINT chk_statefp CHECK (statefp = '66');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_66_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_66*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GU_cousub(CONSTRAINT pk_GU_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_GU_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_66_cousub.dbf tiger_staging.gu_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.GU_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('GU_cousub'), lower('GU_cousub')); ALTER TABLE tiger_data.GU_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '66');"
%PSQL% -c "CREATE INDEX tiger_data_GU_cousub_the_geom_gist ON tiger_data.GU_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_GU_cousub_countyfp ON tiger_data.GU_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_66_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_66*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GU_tract(CONSTRAINT pk_GU_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_66_tract.dbf tiger_staging.gu_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.GU_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('GU_tract'), lower('GU_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_GU_tract_the_geom_gist ON tiger_data.GU_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.GU_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.GU_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '66');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_66010_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_66*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GU_faces(CONSTRAINT pk_GU_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.GU_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('GU_faces'), lower('GU_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_GU_faces_the_geom_gist ON tiger_data.GU_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_GU_faces_tfid ON tiger_data.GU_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_GU_faces_countyfp ON tiger_data.GU_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.GU_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '66');"
	%PSQL% -c "vacuum analyze tiger_data.GU_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_66010_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_66*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GU_featnames(CONSTRAINT pk_GU_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.GU_featnames ALTER COLUMN statefp SET DEFAULT '66';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.GU_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('GU_featnames'), lower('GU_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_GU_featnames_snd_name ON tiger_data.GU_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_GU_featnames_lname ON tiger_data.GU_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_GU_featnames_tlid_statefp ON tiger_data.GU_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.GU_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '66');"
%PSQL% -c "vacuum analyze tiger_data.GU_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_66010_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_66*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GU_edges(CONSTRAINT pk_GU_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.GU_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('GU_edges'), lower('GU_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.GU_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '66');"
%PSQL% -c "CREATE INDEX idx_tiger_data_GU_edges_tlid ON tiger_data.GU_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_GU_edgestfidr ON tiger_data.GU_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_GU_edges_tfidl ON tiger_data.GU_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_GU_edges_countyfp ON tiger_data.GU_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_GU_edges_the_geom_gist ON tiger_data.GU_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_GU_edges_zipl ON tiger_data.GU_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.GU_zip_state_loc(CONSTRAINT pk_GU_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.GU_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'GU', '66', p.name FROM tiger_data.GU_edges AS e INNER JOIN tiger_data.GU_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.GU_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_GU_zip_state_loc_place ON tiger_data.GU_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.GU_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '66');"
%PSQL% -c "vacuum analyze tiger_data.GU_edges;"
%PSQL% -c "vacuum analyze tiger_data.GU_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.GU_zip_lookup_base(CONSTRAINT pk_GU_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.GU_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'GU', c.name,p.name,'66'  FROM tiger_data.GU_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '66') INNER JOIN tiger_data.GU_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.GU_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.GU_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '66');"
%PSQL% -c "CREATE INDEX idx_tiger_data_GU_zip_lookup_base_citysnd ON tiger_data.GU_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_66010_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_66*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.GU_addr(CONSTRAINT pk_GU_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.GU_addr ALTER COLUMN statefp SET DEFAULT '66';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.GU_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('GU_addr'), lower('GU_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.GU_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '66');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_GU_addr_least_address ON tiger_data.GU_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_GU_addr_tlid_statefp ON tiger_data.GU_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_GU_addr_zip ON tiger_data.GU_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.GU_zip_state(CONSTRAINT pk_GU_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.GU_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'GU', '66' FROM tiger_data.GU_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.GU_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '66');"
	%PSQL% -c "vacuum analyze tiger_data.GU_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_15_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_15*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.HI_place(CONSTRAINT pk_HI_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_15_place.dbf tiger_staging.hi_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.HI_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('HI_place'), lower('HI_place')); ALTER TABLE tiger_data.HI_place ADD CONSTRAINT uidx_HI_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_HI_place_soundex_name ON tiger_data.HI_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_HI_place_the_geom_gist ON tiger_data.HI_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.HI_place ADD CONSTRAINT chk_statefp CHECK (statefp = '15');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_15_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_15*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.HI_cousub(CONSTRAINT pk_HI_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_HI_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_15_cousub.dbf tiger_staging.hi_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.HI_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('HI_cousub'), lower('HI_cousub')); ALTER TABLE tiger_data.HI_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '15');"
%PSQL% -c "CREATE INDEX tiger_data_HI_cousub_the_geom_gist ON tiger_data.HI_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_HI_cousub_countyfp ON tiger_data.HI_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_15_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_15*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.HI_tract(CONSTRAINT pk_HI_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_15_tract.dbf tiger_staging.hi_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.HI_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('HI_tract'), lower('HI_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_HI_tract_the_geom_gist ON tiger_data.HI_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.HI_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.HI_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '15');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_15003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_15005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_15007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_15009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_15001_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_15*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.HI_faces(CONSTRAINT pk_HI_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.HI_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('HI_faces'), lower('HI_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_HI_faces_the_geom_gist ON tiger_data.HI_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_HI_faces_tfid ON tiger_data.HI_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_HI_faces_countyfp ON tiger_data.HI_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.HI_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '15');"
	%PSQL% -c "vacuum analyze tiger_data.HI_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_15003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_15005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_15007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_15009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_15001_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_15*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.HI_featnames(CONSTRAINT pk_HI_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.HI_featnames ALTER COLUMN statefp SET DEFAULT '15';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.HI_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('HI_featnames'), lower('HI_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_HI_featnames_snd_name ON tiger_data.HI_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_HI_featnames_lname ON tiger_data.HI_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_HI_featnames_tlid_statefp ON tiger_data.HI_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.HI_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '15');"
%PSQL% -c "vacuum analyze tiger_data.HI_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_15003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_15005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_15007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_15009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_15001_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_15*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.HI_edges(CONSTRAINT pk_HI_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.HI_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('HI_edges'), lower('HI_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.HI_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '15');"
%PSQL% -c "CREATE INDEX idx_tiger_data_HI_edges_tlid ON tiger_data.HI_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_HI_edgestfidr ON tiger_data.HI_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_HI_edges_tfidl ON tiger_data.HI_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_HI_edges_countyfp ON tiger_data.HI_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_HI_edges_the_geom_gist ON tiger_data.HI_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_HI_edges_zipl ON tiger_data.HI_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.HI_zip_state_loc(CONSTRAINT pk_HI_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.HI_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'HI', '15', p.name FROM tiger_data.HI_edges AS e INNER JOIN tiger_data.HI_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.HI_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_HI_zip_state_loc_place ON tiger_data.HI_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.HI_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '15');"
%PSQL% -c "vacuum analyze tiger_data.HI_edges;"
%PSQL% -c "vacuum analyze tiger_data.HI_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.HI_zip_lookup_base(CONSTRAINT pk_HI_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.HI_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'HI', c.name,p.name,'15'  FROM tiger_data.HI_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '15') INNER JOIN tiger_data.HI_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.HI_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.HI_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '15');"
%PSQL% -c "CREATE INDEX idx_tiger_data_HI_zip_lookup_base_citysnd ON tiger_data.HI_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_15003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_15005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_15007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_15009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_15001_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_15*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.HI_addr(CONSTRAINT pk_HI_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.HI_addr ALTER COLUMN statefp SET DEFAULT '15';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.HI_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('HI_addr'), lower('HI_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.HI_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '15');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_HI_addr_least_address ON tiger_data.HI_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_HI_addr_tlid_statefp ON tiger_data.HI_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_HI_addr_zip ON tiger_data.HI_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.HI_zip_state(CONSTRAINT pk_HI_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.HI_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'HI', '15' FROM tiger_data.HI_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.HI_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '15');"
	%PSQL% -c "vacuum analyze tiger_data.HI_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_16_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_16*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ID_place(CONSTRAINT pk_ID_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_16_place.dbf tiger_staging.id_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.ID_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('ID_place'), lower('ID_place')); ALTER TABLE tiger_data.ID_place ADD CONSTRAINT uidx_ID_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_ID_place_soundex_name ON tiger_data.ID_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_ID_place_the_geom_gist ON tiger_data.ID_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.ID_place ADD CONSTRAINT chk_statefp CHECK (statefp = '16');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_16_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_16*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ID_cousub(CONSTRAINT pk_ID_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_ID_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_16_cousub.dbf tiger_staging.id_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.ID_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('ID_cousub'), lower('ID_cousub')); ALTER TABLE tiger_data.ID_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '16');"
%PSQL% -c "CREATE INDEX tiger_data_ID_cousub_the_geom_gist ON tiger_data.ID_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ID_cousub_countyfp ON tiger_data.ID_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_16_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_16*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ID_tract(CONSTRAINT pk_ID_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_16_tract.dbf tiger_staging.id_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.ID_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('ID_tract'), lower('ID_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_ID_tract_the_geom_gist ON tiger_data.ID_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.ID_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.ID_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '16');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_16051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_16027_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_16*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ID_faces(CONSTRAINT pk_ID_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.ID_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('ID_faces'), lower('ID_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_ID_faces_the_geom_gist ON tiger_data.ID_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ID_faces_tfid ON tiger_data.ID_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ID_faces_countyfp ON tiger_data.ID_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.ID_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '16');"
	%PSQL% -c "vacuum analyze tiger_data.ID_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_16051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_16027_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_16*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ID_featnames(CONSTRAINT pk_ID_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.ID_featnames ALTER COLUMN statefp SET DEFAULT '16';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.ID_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('ID_featnames'), lower('ID_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_ID_featnames_snd_name ON tiger_data.ID_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_ID_featnames_lname ON tiger_data.ID_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_ID_featnames_tlid_statefp ON tiger_data.ID_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.ID_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '16');"
%PSQL% -c "vacuum analyze tiger_data.ID_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_16051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_16027_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_16*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ID_edges(CONSTRAINT pk_ID_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.ID_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('ID_edges'), lower('ID_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.ID_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '16');"
%PSQL% -c "CREATE INDEX idx_tiger_data_ID_edges_tlid ON tiger_data.ID_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ID_edgestfidr ON tiger_data.ID_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ID_edges_tfidl ON tiger_data.ID_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ID_edges_countyfp ON tiger_data.ID_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_ID_edges_the_geom_gist ON tiger_data.ID_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ID_edges_zipl ON tiger_data.ID_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.ID_zip_state_loc(CONSTRAINT pk_ID_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.ID_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'ID', '16', p.name FROM tiger_data.ID_edges AS e INNER JOIN tiger_data.ID_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.ID_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_ID_zip_state_loc_place ON tiger_data.ID_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.ID_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '16');"
%PSQL% -c "vacuum analyze tiger_data.ID_edges;"
%PSQL% -c "vacuum analyze tiger_data.ID_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.ID_zip_lookup_base(CONSTRAINT pk_ID_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.ID_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'ID', c.name,p.name,'16'  FROM tiger_data.ID_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '16') INNER JOIN tiger_data.ID_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.ID_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.ID_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '16');"
%PSQL% -c "CREATE INDEX idx_tiger_data_ID_zip_lookup_base_citysnd ON tiger_data.ID_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_16051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_16027_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_16*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ID_addr(CONSTRAINT pk_ID_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.ID_addr ALTER COLUMN statefp SET DEFAULT '16';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.ID_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('ID_addr'), lower('ID_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.ID_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '16');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ID_addr_least_address ON tiger_data.ID_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ID_addr_tlid_statefp ON tiger_data.ID_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ID_addr_zip ON tiger_data.ID_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.ID_zip_state(CONSTRAINT pk_ID_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.ID_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'ID', '16' FROM tiger_data.ID_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.ID_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '16');"
	%PSQL% -c "vacuum analyze tiger_data.ID_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_17_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_17*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IL_place(CONSTRAINT pk_IL_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_17_place.dbf tiger_staging.il_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.IL_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('IL_place'), lower('IL_place')); ALTER TABLE tiger_data.IL_place ADD CONSTRAINT uidx_IL_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_IL_place_soundex_name ON tiger_data.IL_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_IL_place_the_geom_gist ON tiger_data.IL_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.IL_place ADD CONSTRAINT chk_statefp CHECK (statefp = '17');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_17_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_17*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IL_cousub(CONSTRAINT pk_IL_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_IL_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_17_cousub.dbf tiger_staging.il_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.IL_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('IL_cousub'), lower('IL_cousub')); ALTER TABLE tiger_data.IL_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '17');"
%PSQL% -c "CREATE INDEX tiger_data_IL_cousub_the_geom_gist ON tiger_data.IL_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IL_cousub_countyfp ON tiger_data.IL_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_17_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_17*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IL_tract(CONSTRAINT pk_IL_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_17_tract.dbf tiger_staging.il_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.IL_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('IL_tract'), lower('IL_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_IL_tract_the_geom_gist ON tiger_data.IL_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.IL_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.IL_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '17');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_17067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17185_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17189_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17193_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17177_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17181_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17199_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17191_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17203_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17201_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17179_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17183_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17187_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17197_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17195_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_17077_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_17*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IL_faces(CONSTRAINT pk_IL_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.IL_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('IL_faces'), lower('IL_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_IL_faces_the_geom_gist ON tiger_data.IL_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IL_faces_tfid ON tiger_data.IL_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IL_faces_countyfp ON tiger_data.IL_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.IL_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '17');"
	%PSQL% -c "vacuum analyze tiger_data.IL_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_17067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17185_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17189_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17193_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17177_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17181_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17199_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17191_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17203_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17201_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17179_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17183_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17187_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17197_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17195_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_17077_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_17*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IL_featnames(CONSTRAINT pk_IL_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.IL_featnames ALTER COLUMN statefp SET DEFAULT '17';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.IL_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('IL_featnames'), lower('IL_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_IL_featnames_snd_name ON tiger_data.IL_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_IL_featnames_lname ON tiger_data.IL_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_IL_featnames_tlid_statefp ON tiger_data.IL_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.IL_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '17');"
%PSQL% -c "vacuum analyze tiger_data.IL_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_17067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17185_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17189_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17193_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17177_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17181_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17199_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17191_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17203_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17201_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17179_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17183_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17187_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17197_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17195_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_17077_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_17*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IL_edges(CONSTRAINT pk_IL_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.IL_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('IL_edges'), lower('IL_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.IL_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '17');"
%PSQL% -c "CREATE INDEX idx_tiger_data_IL_edges_tlid ON tiger_data.IL_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IL_edgestfidr ON tiger_data.IL_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IL_edges_tfidl ON tiger_data.IL_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IL_edges_countyfp ON tiger_data.IL_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_IL_edges_the_geom_gist ON tiger_data.IL_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IL_edges_zipl ON tiger_data.IL_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.IL_zip_state_loc(CONSTRAINT pk_IL_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.IL_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'IL', '17', p.name FROM tiger_data.IL_edges AS e INNER JOIN tiger_data.IL_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.IL_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_IL_zip_state_loc_place ON tiger_data.IL_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.IL_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '17');"
%PSQL% -c "vacuum analyze tiger_data.IL_edges;"
%PSQL% -c "vacuum analyze tiger_data.IL_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.IL_zip_lookup_base(CONSTRAINT pk_IL_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.IL_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'IL', c.name,p.name,'17'  FROM tiger_data.IL_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '17') INNER JOIN tiger_data.IL_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.IL_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.IL_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '17');"
%PSQL% -c "CREATE INDEX idx_tiger_data_IL_zip_lookup_base_citysnd ON tiger_data.IL_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_17067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17185_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17189_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17193_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17177_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17181_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17199_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17191_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17203_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17201_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17179_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17183_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17187_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17197_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17195_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_17077_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_17*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IL_addr(CONSTRAINT pk_IL_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.IL_addr ALTER COLUMN statefp SET DEFAULT '17';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.IL_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('IL_addr'), lower('IL_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.IL_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '17');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IL_addr_least_address ON tiger_data.IL_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IL_addr_tlid_statefp ON tiger_data.IL_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IL_addr_zip ON tiger_data.IL_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.IL_zip_state(CONSTRAINT pk_IL_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.IL_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'IL', '17' FROM tiger_data.IL_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.IL_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '17');"
	%PSQL% -c "vacuum analyze tiger_data.IL_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_18_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_18*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IN_place(CONSTRAINT pk_IN_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_18_place.dbf tiger_staging.in_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.IN_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('IN_place'), lower('IN_place')); ALTER TABLE tiger_data.IN_place ADD CONSTRAINT uidx_IN_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_IN_place_soundex_name ON tiger_data.IN_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_IN_place_the_geom_gist ON tiger_data.IN_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.IN_place ADD CONSTRAINT chk_statefp CHECK (statefp = '18');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_18_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_18*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IN_cousub(CONSTRAINT pk_IN_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_IN_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_18_cousub.dbf tiger_staging.in_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.IN_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('IN_cousub'), lower('IN_cousub')); ALTER TABLE tiger_data.IN_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '18');"
%PSQL% -c "CREATE INDEX tiger_data_IN_cousub_the_geom_gist ON tiger_data.IN_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IN_cousub_countyfp ON tiger_data.IN_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_18_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_18*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IN_tract(CONSTRAINT pk_IN_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_18_tract.dbf tiger_staging.in_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.IN_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('IN_tract'), lower('IN_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_IN_tract_the_geom_gist ON tiger_data.IN_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.IN_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.IN_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '18');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_18073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18179_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18181_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18177_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18183_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_18093_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_18*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IN_faces(CONSTRAINT pk_IN_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.IN_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('IN_faces'), lower('IN_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_IN_faces_the_geom_gist ON tiger_data.IN_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IN_faces_tfid ON tiger_data.IN_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IN_faces_countyfp ON tiger_data.IN_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.IN_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '18');"
	%PSQL% -c "vacuum analyze tiger_data.IN_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_18073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18179_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18181_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18177_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18183_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_18093_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_18*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IN_featnames(CONSTRAINT pk_IN_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.IN_featnames ALTER COLUMN statefp SET DEFAULT '18';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.IN_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('IN_featnames'), lower('IN_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_IN_featnames_snd_name ON tiger_data.IN_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_IN_featnames_lname ON tiger_data.IN_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_IN_featnames_tlid_statefp ON tiger_data.IN_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.IN_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '18');"
%PSQL% -c "vacuum analyze tiger_data.IN_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_18073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18179_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18181_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18177_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18183_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_18093_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_18*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IN_edges(CONSTRAINT pk_IN_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.IN_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('IN_edges'), lower('IN_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.IN_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '18');"
%PSQL% -c "CREATE INDEX idx_tiger_data_IN_edges_tlid ON tiger_data.IN_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IN_edgestfidr ON tiger_data.IN_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IN_edges_tfidl ON tiger_data.IN_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IN_edges_countyfp ON tiger_data.IN_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_IN_edges_the_geom_gist ON tiger_data.IN_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IN_edges_zipl ON tiger_data.IN_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.IN_zip_state_loc(CONSTRAINT pk_IN_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.IN_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'IN', '18', p.name FROM tiger_data.IN_edges AS e INNER JOIN tiger_data.IN_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.IN_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_IN_zip_state_loc_place ON tiger_data.IN_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.IN_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '18');"
%PSQL% -c "vacuum analyze tiger_data.IN_edges;"
%PSQL% -c "vacuum analyze tiger_data.IN_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.IN_zip_lookup_base(CONSTRAINT pk_IN_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.IN_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'IN', c.name,p.name,'18'  FROM tiger_data.IN_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '18') INNER JOIN tiger_data.IN_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.IN_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.IN_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '18');"
%PSQL% -c "CREATE INDEX idx_tiger_data_IN_zip_lookup_base_citysnd ON tiger_data.IN_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_18073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18179_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18181_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18177_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18183_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_18093_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_18*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IN_addr(CONSTRAINT pk_IN_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.IN_addr ALTER COLUMN statefp SET DEFAULT '18';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.IN_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('IN_addr'), lower('IN_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.IN_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '18');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IN_addr_least_address ON tiger_data.IN_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IN_addr_tlid_statefp ON tiger_data.IN_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IN_addr_zip ON tiger_data.IN_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.IN_zip_state(CONSTRAINT pk_IN_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.IN_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'IN', '18' FROM tiger_data.IN_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.IN_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '18');"
	%PSQL% -c "vacuum analyze tiger_data.IN_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_19_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_19*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IA_place(CONSTRAINT pk_IA_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_19_place.dbf tiger_staging.ia_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.IA_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('IA_place'), lower('IA_place')); ALTER TABLE tiger_data.IA_place ADD CONSTRAINT uidx_IA_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_IA_place_soundex_name ON tiger_data.IA_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_IA_place_the_geom_gist ON tiger_data.IA_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.IA_place ADD CONSTRAINT chk_statefp CHECK (statefp = '19');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_19_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_19*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IA_cousub(CONSTRAINT pk_IA_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_IA_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_19_cousub.dbf tiger_staging.ia_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.IA_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('IA_cousub'), lower('IA_cousub')); ALTER TABLE tiger_data.IA_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '19');"
%PSQL% -c "CREATE INDEX tiger_data_IA_cousub_the_geom_gist ON tiger_data.IA_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IA_cousub_countyfp ON tiger_data.IA_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_19_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_19*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IA_tract(CONSTRAINT pk_IA_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_19_tract.dbf tiger_staging.ia_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.IA_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('IA_tract'), lower('IA_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_IA_tract_the_geom_gist ON tiger_data.IA_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.IA_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.IA_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '19');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_19053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19187_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19195_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19181_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19185_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19177_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19197_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19191_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19193_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19179_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19183_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19189_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_19029_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_19*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IA_faces(CONSTRAINT pk_IA_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.IA_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('IA_faces'), lower('IA_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_IA_faces_the_geom_gist ON tiger_data.IA_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IA_faces_tfid ON tiger_data.IA_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IA_faces_countyfp ON tiger_data.IA_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.IA_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '19');"
	%PSQL% -c "vacuum analyze tiger_data.IA_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_19053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19187_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19195_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19181_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19185_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19177_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19197_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19191_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19193_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19179_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19183_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19189_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_19029_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_19*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IA_featnames(CONSTRAINT pk_IA_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.IA_featnames ALTER COLUMN statefp SET DEFAULT '19';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.IA_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('IA_featnames'), lower('IA_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_IA_featnames_snd_name ON tiger_data.IA_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_IA_featnames_lname ON tiger_data.IA_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_IA_featnames_tlid_statefp ON tiger_data.IA_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.IA_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '19');"
%PSQL% -c "vacuum analyze tiger_data.IA_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_19053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19187_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19195_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19181_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19185_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19177_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19197_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19191_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19193_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19179_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19183_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19189_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_19029_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_19*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IA_edges(CONSTRAINT pk_IA_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.IA_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('IA_edges'), lower('IA_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.IA_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '19');"
%PSQL% -c "CREATE INDEX idx_tiger_data_IA_edges_tlid ON tiger_data.IA_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IA_edgestfidr ON tiger_data.IA_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IA_edges_tfidl ON tiger_data.IA_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IA_edges_countyfp ON tiger_data.IA_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_IA_edges_the_geom_gist ON tiger_data.IA_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_IA_edges_zipl ON tiger_data.IA_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.IA_zip_state_loc(CONSTRAINT pk_IA_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.IA_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'IA', '19', p.name FROM tiger_data.IA_edges AS e INNER JOIN tiger_data.IA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.IA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_IA_zip_state_loc_place ON tiger_data.IA_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.IA_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '19');"
%PSQL% -c "vacuum analyze tiger_data.IA_edges;"
%PSQL% -c "vacuum analyze tiger_data.IA_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.IA_zip_lookup_base(CONSTRAINT pk_IA_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.IA_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'IA', c.name,p.name,'19'  FROM tiger_data.IA_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '19') INNER JOIN tiger_data.IA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.IA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.IA_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '19');"
%PSQL% -c "CREATE INDEX idx_tiger_data_IA_zip_lookup_base_citysnd ON tiger_data.IA_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_19053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19187_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19195_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19181_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19185_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19177_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19197_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19191_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19193_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19179_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19183_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19189_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_19029_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_19*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.IA_addr(CONSTRAINT pk_IA_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.IA_addr ALTER COLUMN statefp SET DEFAULT '19';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.IA_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('IA_addr'), lower('IA_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.IA_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '19');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IA_addr_least_address ON tiger_data.IA_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IA_addr_tlid_statefp ON tiger_data.IA_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_IA_addr_zip ON tiger_data.IA_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.IA_zip_state(CONSTRAINT pk_IA_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.IA_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'IA', '19' FROM tiger_data.IA_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.IA_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '19');"
	%PSQL% -c "vacuum analyze tiger_data.IA_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_20_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_20*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KS_place(CONSTRAINT pk_KS_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_20_place.dbf tiger_staging.ks_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.KS_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('KS_place'), lower('KS_place')); ALTER TABLE tiger_data.KS_place ADD CONSTRAINT uidx_KS_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_KS_place_soundex_name ON tiger_data.KS_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_KS_place_the_geom_gist ON tiger_data.KS_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.KS_place ADD CONSTRAINT chk_statefp CHECK (statefp = '20');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_20_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_20*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KS_cousub(CONSTRAINT pk_KS_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_KS_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_20_cousub.dbf tiger_staging.ks_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.KS_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('KS_cousub'), lower('KS_cousub')); ALTER TABLE tiger_data.KS_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '20');"
%PSQL% -c "CREATE INDEX tiger_data_KS_cousub_the_geom_gist ON tiger_data.KS_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_KS_cousub_countyfp ON tiger_data.KS_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_20_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_20*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KS_tract(CONSTRAINT pk_KS_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_20_tract.dbf tiger_staging.ks_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.KS_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('KS_tract'), lower('KS_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_KS_tract_the_geom_gist ON tiger_data.KS_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.KS_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.KS_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '20');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_20157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20199_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20195_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20187_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20181_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20177_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20189_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20209_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20191_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20183_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20207_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20193_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20205_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20185_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20179_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20201_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20203_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20197_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_20085_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_20*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KS_faces(CONSTRAINT pk_KS_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.KS_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('KS_faces'), lower('KS_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_KS_faces_the_geom_gist ON tiger_data.KS_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_KS_faces_tfid ON tiger_data.KS_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_KS_faces_countyfp ON tiger_data.KS_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.KS_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '20');"
	%PSQL% -c "vacuum analyze tiger_data.KS_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_20157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20199_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20195_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20187_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20181_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20177_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20189_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20209_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20191_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20183_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20207_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20193_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20205_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20185_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20179_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20201_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20203_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20197_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_20085_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_20*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KS_featnames(CONSTRAINT pk_KS_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.KS_featnames ALTER COLUMN statefp SET DEFAULT '20';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.KS_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('KS_featnames'), lower('KS_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_KS_featnames_snd_name ON tiger_data.KS_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_KS_featnames_lname ON tiger_data.KS_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_KS_featnames_tlid_statefp ON tiger_data.KS_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.KS_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '20');"
%PSQL% -c "vacuum analyze tiger_data.KS_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_20157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20199_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20195_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20187_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20181_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20177_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20189_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20209_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20191_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20183_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20207_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20193_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20205_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20185_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20179_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20201_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20203_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20197_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_20085_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_20*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KS_edges(CONSTRAINT pk_KS_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.KS_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('KS_edges'), lower('KS_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.KS_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '20');"
%PSQL% -c "CREATE INDEX idx_tiger_data_KS_edges_tlid ON tiger_data.KS_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_KS_edgestfidr ON tiger_data.KS_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_KS_edges_tfidl ON tiger_data.KS_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_KS_edges_countyfp ON tiger_data.KS_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_KS_edges_the_geom_gist ON tiger_data.KS_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_KS_edges_zipl ON tiger_data.KS_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.KS_zip_state_loc(CONSTRAINT pk_KS_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.KS_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'KS', '20', p.name FROM tiger_data.KS_edges AS e INNER JOIN tiger_data.KS_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.KS_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_KS_zip_state_loc_place ON tiger_data.KS_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.KS_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '20');"
%PSQL% -c "vacuum analyze tiger_data.KS_edges;"
%PSQL% -c "vacuum analyze tiger_data.KS_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.KS_zip_lookup_base(CONSTRAINT pk_KS_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.KS_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'KS', c.name,p.name,'20'  FROM tiger_data.KS_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '20') INNER JOIN tiger_data.KS_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.KS_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.KS_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '20');"
%PSQL% -c "CREATE INDEX idx_tiger_data_KS_zip_lookup_base_citysnd ON tiger_data.KS_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_20157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20199_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20195_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20187_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20181_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20177_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20189_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20209_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20191_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20183_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20207_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20193_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20205_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20185_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20179_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20201_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20203_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20197_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_20085_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_20*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KS_addr(CONSTRAINT pk_KS_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.KS_addr ALTER COLUMN statefp SET DEFAULT '20';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.KS_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('KS_addr'), lower('KS_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.KS_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '20');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_KS_addr_least_address ON tiger_data.KS_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_KS_addr_tlid_statefp ON tiger_data.KS_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_KS_addr_zip ON tiger_data.KS_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.KS_zip_state(CONSTRAINT pk_KS_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.KS_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'KS', '20' FROM tiger_data.KS_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.KS_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '20');"
	%PSQL% -c "vacuum analyze tiger_data.KS_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_21_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_21*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KY_place(CONSTRAINT pk_KY_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_21_place.dbf tiger_staging.ky_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.KY_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('KY_place'), lower('KY_place')); ALTER TABLE tiger_data.KY_place ADD CONSTRAINT uidx_KY_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_KY_place_soundex_name ON tiger_data.KY_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_KY_place_the_geom_gist ON tiger_data.KY_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.KY_place ADD CONSTRAINT chk_statefp CHECK (statefp = '21');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_21_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_21*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KY_cousub(CONSTRAINT pk_KY_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_KY_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_21_cousub.dbf tiger_staging.ky_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.KY_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('KY_cousub'), lower('KY_cousub')); ALTER TABLE tiger_data.KY_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '21');"
%PSQL% -c "CREATE INDEX tiger_data_KY_cousub_the_geom_gist ON tiger_data.KY_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_KY_cousub_countyfp ON tiger_data.KY_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_21_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_21*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KY_tract(CONSTRAINT pk_KY_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_21_tract.dbf tiger_staging.ky_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.KY_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('KY_tract'), lower('KY_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_KY_tract_the_geom_gist ON tiger_data.KY_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.KY_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.KY_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '21');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_21053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21231_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21209_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21193_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21177_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21237_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21201_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21189_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21197_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21217_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21229_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21235_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21183_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21195_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21227_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21225_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21221_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21199_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21211_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21219_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21213_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21205_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21185_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21203_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21223_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21191_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21215_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21239_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21207_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21179_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21187_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21181_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_21233_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_21*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KY_faces(CONSTRAINT pk_KY_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.KY_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('KY_faces'), lower('KY_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_KY_faces_the_geom_gist ON tiger_data.KY_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_KY_faces_tfid ON tiger_data.KY_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_KY_faces_countyfp ON tiger_data.KY_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.KY_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '21');"
	%PSQL% -c "vacuum analyze tiger_data.KY_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_21053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21231_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21209_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21193_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21177_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21237_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21201_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21189_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21197_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21217_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21229_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21235_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21183_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21195_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21227_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21225_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21221_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21199_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21211_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21219_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21213_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21205_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21185_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21203_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21223_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21191_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21215_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21239_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21207_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21179_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21187_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21181_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_21233_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_21*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KY_featnames(CONSTRAINT pk_KY_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.KY_featnames ALTER COLUMN statefp SET DEFAULT '21';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.KY_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('KY_featnames'), lower('KY_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_KY_featnames_snd_name ON tiger_data.KY_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_KY_featnames_lname ON tiger_data.KY_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_KY_featnames_tlid_statefp ON tiger_data.KY_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.KY_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '21');"
%PSQL% -c "vacuum analyze tiger_data.KY_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_21053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21231_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21209_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21193_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21177_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21237_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21201_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21189_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21197_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21217_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21229_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21235_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21183_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21195_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21227_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21225_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21221_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21199_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21211_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21219_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21213_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21205_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21185_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21203_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21223_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21191_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21215_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21239_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21207_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21179_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21187_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21181_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_21233_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_21*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KY_edges(CONSTRAINT pk_KY_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.KY_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('KY_edges'), lower('KY_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.KY_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '21');"
%PSQL% -c "CREATE INDEX idx_tiger_data_KY_edges_tlid ON tiger_data.KY_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_KY_edgestfidr ON tiger_data.KY_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_KY_edges_tfidl ON tiger_data.KY_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_KY_edges_countyfp ON tiger_data.KY_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_KY_edges_the_geom_gist ON tiger_data.KY_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_KY_edges_zipl ON tiger_data.KY_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.KY_zip_state_loc(CONSTRAINT pk_KY_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.KY_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'KY', '21', p.name FROM tiger_data.KY_edges AS e INNER JOIN tiger_data.KY_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.KY_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_KY_zip_state_loc_place ON tiger_data.KY_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.KY_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '21');"
%PSQL% -c "vacuum analyze tiger_data.KY_edges;"
%PSQL% -c "vacuum analyze tiger_data.KY_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.KY_zip_lookup_base(CONSTRAINT pk_KY_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.KY_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'KY', c.name,p.name,'21'  FROM tiger_data.KY_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '21') INNER JOIN tiger_data.KY_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.KY_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.KY_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '21');"
%PSQL% -c "CREATE INDEX idx_tiger_data_KY_zip_lookup_base_citysnd ON tiger_data.KY_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_21053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21231_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21209_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21193_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21177_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21237_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21201_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21189_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21197_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21217_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21229_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21235_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21183_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21195_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21227_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21225_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21221_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21199_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21211_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21219_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21213_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21205_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21185_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21203_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21223_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21191_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21215_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21239_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21207_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21179_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21187_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21181_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_21233_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_21*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.KY_addr(CONSTRAINT pk_KY_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.KY_addr ALTER COLUMN statefp SET DEFAULT '21';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.KY_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('KY_addr'), lower('KY_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.KY_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '21');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_KY_addr_least_address ON tiger_data.KY_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_KY_addr_tlid_statefp ON tiger_data.KY_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_KY_addr_zip ON tiger_data.KY_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.KY_zip_state(CONSTRAINT pk_KY_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.KY_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'KY', '21' FROM tiger_data.KY_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.KY_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '21');"
	%PSQL% -c "vacuum analyze tiger_data.KY_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_22_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_22*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.LA_place(CONSTRAINT pk_LA_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_22_place.dbf tiger_staging.la_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.LA_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('LA_place'), lower('LA_place')); ALTER TABLE tiger_data.LA_place ADD CONSTRAINT uidx_LA_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_LA_place_soundex_name ON tiger_data.LA_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_LA_place_the_geom_gist ON tiger_data.LA_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.LA_place ADD CONSTRAINT chk_statefp CHECK (statefp = '22');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_22_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_22*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.LA_cousub(CONSTRAINT pk_LA_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_LA_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_22_cousub.dbf tiger_staging.la_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.LA_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('LA_cousub'), lower('LA_cousub')); ALTER TABLE tiger_data.LA_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '22');"
%PSQL% -c "CREATE INDEX tiger_data_LA_cousub_the_geom_gist ON tiger_data.LA_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_LA_cousub_countyfp ON tiger_data.LA_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_22_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_22*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.LA_tract(CONSTRAINT pk_LA_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_22_tract.dbf tiger_staging.la_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.LA_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('LA_tract'), lower('LA_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_LA_tract_the_geom_gist ON tiger_data.LA_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.LA_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.LA_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '22');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_22019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_22041_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_22*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.LA_faces(CONSTRAINT pk_LA_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.LA_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('LA_faces'), lower('LA_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_LA_faces_the_geom_gist ON tiger_data.LA_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_LA_faces_tfid ON tiger_data.LA_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_LA_faces_countyfp ON tiger_data.LA_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.LA_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '22');"
	%PSQL% -c "vacuum analyze tiger_data.LA_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_22019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_22041_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_22*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.LA_featnames(CONSTRAINT pk_LA_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.LA_featnames ALTER COLUMN statefp SET DEFAULT '22';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.LA_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('LA_featnames'), lower('LA_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_LA_featnames_snd_name ON tiger_data.LA_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_LA_featnames_lname ON tiger_data.LA_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_LA_featnames_tlid_statefp ON tiger_data.LA_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.LA_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '22');"
%PSQL% -c "vacuum analyze tiger_data.LA_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_22019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_22041_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_22*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.LA_edges(CONSTRAINT pk_LA_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.LA_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('LA_edges'), lower('LA_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.LA_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '22');"
%PSQL% -c "CREATE INDEX idx_tiger_data_LA_edges_tlid ON tiger_data.LA_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_LA_edgestfidr ON tiger_data.LA_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_LA_edges_tfidl ON tiger_data.LA_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_LA_edges_countyfp ON tiger_data.LA_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_LA_edges_the_geom_gist ON tiger_data.LA_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_LA_edges_zipl ON tiger_data.LA_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.LA_zip_state_loc(CONSTRAINT pk_LA_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.LA_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'LA', '22', p.name FROM tiger_data.LA_edges AS e INNER JOIN tiger_data.LA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.LA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_LA_zip_state_loc_place ON tiger_data.LA_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.LA_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '22');"
%PSQL% -c "vacuum analyze tiger_data.LA_edges;"
%PSQL% -c "vacuum analyze tiger_data.LA_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.LA_zip_lookup_base(CONSTRAINT pk_LA_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.LA_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'LA', c.name,p.name,'22'  FROM tiger_data.LA_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '22') INNER JOIN tiger_data.LA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.LA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.LA_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '22');"
%PSQL% -c "CREATE INDEX idx_tiger_data_LA_zip_lookup_base_citysnd ON tiger_data.LA_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_22019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_22041_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_22*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.LA_addr(CONSTRAINT pk_LA_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.LA_addr ALTER COLUMN statefp SET DEFAULT '22';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.LA_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('LA_addr'), lower('LA_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.LA_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '22');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_LA_addr_least_address ON tiger_data.LA_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_LA_addr_tlid_statefp ON tiger_data.LA_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_LA_addr_zip ON tiger_data.LA_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.LA_zip_state(CONSTRAINT pk_LA_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.LA_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'LA', '22' FROM tiger_data.LA_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.LA_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '22');"
	%PSQL% -c "vacuum analyze tiger_data.LA_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_23_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_23*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ME_place(CONSTRAINT pk_ME_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_23_place.dbf tiger_staging.me_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.ME_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('ME_place'), lower('ME_place')); ALTER TABLE tiger_data.ME_place ADD CONSTRAINT uidx_ME_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_ME_place_soundex_name ON tiger_data.ME_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_ME_place_the_geom_gist ON tiger_data.ME_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.ME_place ADD CONSTRAINT chk_statefp CHECK (statefp = '23');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_23_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_23*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ME_cousub(CONSTRAINT pk_ME_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_ME_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_23_cousub.dbf tiger_staging.me_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.ME_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('ME_cousub'), lower('ME_cousub')); ALTER TABLE tiger_data.ME_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '23');"
%PSQL% -c "CREATE INDEX tiger_data_ME_cousub_the_geom_gist ON tiger_data.ME_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ME_cousub_countyfp ON tiger_data.ME_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_23_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_23*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ME_tract(CONSTRAINT pk_ME_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_23_tract.dbf tiger_staging.me_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.ME_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('ME_tract'), lower('ME_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_ME_tract_the_geom_gist ON tiger_data.ME_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.ME_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.ME_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '23');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_23001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_23025_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_23*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ME_faces(CONSTRAINT pk_ME_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.ME_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('ME_faces'), lower('ME_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_ME_faces_the_geom_gist ON tiger_data.ME_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ME_faces_tfid ON tiger_data.ME_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ME_faces_countyfp ON tiger_data.ME_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.ME_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '23');"
	%PSQL% -c "vacuum analyze tiger_data.ME_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_23001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_23025_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_23*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ME_featnames(CONSTRAINT pk_ME_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.ME_featnames ALTER COLUMN statefp SET DEFAULT '23';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.ME_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('ME_featnames'), lower('ME_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_ME_featnames_snd_name ON tiger_data.ME_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_ME_featnames_lname ON tiger_data.ME_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_ME_featnames_tlid_statefp ON tiger_data.ME_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.ME_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '23');"
%PSQL% -c "vacuum analyze tiger_data.ME_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_23001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_23025_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_23*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ME_edges(CONSTRAINT pk_ME_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.ME_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('ME_edges'), lower('ME_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.ME_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '23');"
%PSQL% -c "CREATE INDEX idx_tiger_data_ME_edges_tlid ON tiger_data.ME_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ME_edgestfidr ON tiger_data.ME_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ME_edges_tfidl ON tiger_data.ME_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ME_edges_countyfp ON tiger_data.ME_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_ME_edges_the_geom_gist ON tiger_data.ME_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ME_edges_zipl ON tiger_data.ME_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.ME_zip_state_loc(CONSTRAINT pk_ME_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.ME_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'ME', '23', p.name FROM tiger_data.ME_edges AS e INNER JOIN tiger_data.ME_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.ME_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_ME_zip_state_loc_place ON tiger_data.ME_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.ME_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '23');"
%PSQL% -c "vacuum analyze tiger_data.ME_edges;"
%PSQL% -c "vacuum analyze tiger_data.ME_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.ME_zip_lookup_base(CONSTRAINT pk_ME_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.ME_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'ME', c.name,p.name,'23'  FROM tiger_data.ME_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '23') INNER JOIN tiger_data.ME_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.ME_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.ME_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '23');"
%PSQL% -c "CREATE INDEX idx_tiger_data_ME_zip_lookup_base_citysnd ON tiger_data.ME_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_23001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_23025_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_23*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ME_addr(CONSTRAINT pk_ME_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.ME_addr ALTER COLUMN statefp SET DEFAULT '23';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.ME_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('ME_addr'), lower('ME_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.ME_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '23');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ME_addr_least_address ON tiger_data.ME_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ME_addr_tlid_statefp ON tiger_data.ME_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ME_addr_zip ON tiger_data.ME_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.ME_zip_state(CONSTRAINT pk_ME_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.ME_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'ME', '23' FROM tiger_data.ME_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.ME_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '23');"
	%PSQL% -c "vacuum analyze tiger_data.ME_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_24_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_24*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MD_place(CONSTRAINT pk_MD_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_24_place.dbf tiger_staging.md_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MD_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('MD_place'), lower('MD_place')); ALTER TABLE tiger_data.MD_place ADD CONSTRAINT uidx_MD_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_MD_place_soundex_name ON tiger_data.MD_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_MD_place_the_geom_gist ON tiger_data.MD_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.MD_place ADD CONSTRAINT chk_statefp CHECK (statefp = '24');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_24_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_24*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MD_cousub(CONSTRAINT pk_MD_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_MD_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_24_cousub.dbf tiger_staging.md_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MD_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('MD_cousub'), lower('MD_cousub')); ALTER TABLE tiger_data.MD_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '24');"
%PSQL% -c "CREATE INDEX tiger_data_MD_cousub_the_geom_gist ON tiger_data.MD_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MD_cousub_countyfp ON tiger_data.MD_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_24_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_24*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MD_tract(CONSTRAINT pk_MD_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_24_tract.dbf tiger_staging.md_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MD_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('MD_tract'), lower('MD_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_MD_tract_the_geom_gist ON tiger_data.MD_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.MD_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.MD_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '24');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_24047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24510_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_24011_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_24*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MD_faces(CONSTRAINT pk_MD_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MD_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MD_faces'), lower('MD_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_MD_faces_the_geom_gist ON tiger_data.MD_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MD_faces_tfid ON tiger_data.MD_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MD_faces_countyfp ON tiger_data.MD_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.MD_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '24');"
	%PSQL% -c "vacuum analyze tiger_data.MD_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_24047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24510_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_24011_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_24*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MD_featnames(CONSTRAINT pk_MD_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.MD_featnames ALTER COLUMN statefp SET DEFAULT '24';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MD_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MD_featnames'), lower('MD_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_MD_featnames_snd_name ON tiger_data.MD_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MD_featnames_lname ON tiger_data.MD_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MD_featnames_tlid_statefp ON tiger_data.MD_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.MD_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '24');"
%PSQL% -c "vacuum analyze tiger_data.MD_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_24047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24510_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_24011_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_24*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MD_edges(CONSTRAINT pk_MD_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MD_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MD_edges'), lower('MD_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.MD_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '24');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MD_edges_tlid ON tiger_data.MD_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MD_edgestfidr ON tiger_data.MD_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MD_edges_tfidl ON tiger_data.MD_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MD_edges_countyfp ON tiger_data.MD_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_MD_edges_the_geom_gist ON tiger_data.MD_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MD_edges_zipl ON tiger_data.MD_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.MD_zip_state_loc(CONSTRAINT pk_MD_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.MD_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'MD', '24', p.name FROM tiger_data.MD_edges AS e INNER JOIN tiger_data.MD_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MD_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_MD_zip_state_loc_place ON tiger_data.MD_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.MD_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '24');"
%PSQL% -c "vacuum analyze tiger_data.MD_edges;"
%PSQL% -c "vacuum analyze tiger_data.MD_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.MD_zip_lookup_base(CONSTRAINT pk_MD_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.MD_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'MD', c.name,p.name,'24'  FROM tiger_data.MD_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '24') INNER JOIN tiger_data.MD_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MD_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.MD_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '24');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MD_zip_lookup_base_citysnd ON tiger_data.MD_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_24047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24510_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_24011_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_24*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MD_addr(CONSTRAINT pk_MD_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.MD_addr ALTER COLUMN statefp SET DEFAULT '24';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MD_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MD_addr'), lower('MD_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.MD_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '24');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MD_addr_least_address ON tiger_data.MD_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MD_addr_tlid_statefp ON tiger_data.MD_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MD_addr_zip ON tiger_data.MD_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.MD_zip_state(CONSTRAINT pk_MD_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.MD_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'MD', '24' FROM tiger_data.MD_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.MD_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '24');"
	%PSQL% -c "vacuum analyze tiger_data.MD_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_25_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_25*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MA_place(CONSTRAINT pk_MA_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_25_place.dbf tiger_staging.ma_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MA_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('MA_place'), lower('MA_place')); ALTER TABLE tiger_data.MA_place ADD CONSTRAINT uidx_MA_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_MA_place_soundex_name ON tiger_data.MA_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_MA_place_the_geom_gist ON tiger_data.MA_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.MA_place ADD CONSTRAINT chk_statefp CHECK (statefp = '25');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_25_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_25*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MA_cousub(CONSTRAINT pk_MA_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_MA_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_25_cousub.dbf tiger_staging.ma_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MA_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('MA_cousub'), lower('MA_cousub')); ALTER TABLE tiger_data.MA_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '25');"
%PSQL% -c "CREATE INDEX tiger_data_MA_cousub_the_geom_gist ON tiger_data.MA_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MA_cousub_countyfp ON tiger_data.MA_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_25_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_25*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MA_tract(CONSTRAINT pk_MA_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_25_tract.dbf tiger_staging.ma_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MA_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('MA_tract'), lower('MA_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_MA_tract_the_geom_gist ON tiger_data.MA_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.MA_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.MA_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '25');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_25015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_25011_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_25*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MA_faces(CONSTRAINT pk_MA_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MA_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MA_faces'), lower('MA_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_MA_faces_the_geom_gist ON tiger_data.MA_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MA_faces_tfid ON tiger_data.MA_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MA_faces_countyfp ON tiger_data.MA_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.MA_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '25');"
	%PSQL% -c "vacuum analyze tiger_data.MA_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_25015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_25011_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_25*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MA_featnames(CONSTRAINT pk_MA_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.MA_featnames ALTER COLUMN statefp SET DEFAULT '25';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MA_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MA_featnames'), lower('MA_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_MA_featnames_snd_name ON tiger_data.MA_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MA_featnames_lname ON tiger_data.MA_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MA_featnames_tlid_statefp ON tiger_data.MA_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.MA_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '25');"
%PSQL% -c "vacuum analyze tiger_data.MA_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_25015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_25011_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_25*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MA_edges(CONSTRAINT pk_MA_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MA_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MA_edges'), lower('MA_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.MA_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '25');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MA_edges_tlid ON tiger_data.MA_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MA_edgestfidr ON tiger_data.MA_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MA_edges_tfidl ON tiger_data.MA_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MA_edges_countyfp ON tiger_data.MA_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_MA_edges_the_geom_gist ON tiger_data.MA_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MA_edges_zipl ON tiger_data.MA_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.MA_zip_state_loc(CONSTRAINT pk_MA_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.MA_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'MA', '25', p.name FROM tiger_data.MA_edges AS e INNER JOIN tiger_data.MA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_MA_zip_state_loc_place ON tiger_data.MA_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.MA_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '25');"
%PSQL% -c "vacuum analyze tiger_data.MA_edges;"
%PSQL% -c "vacuum analyze tiger_data.MA_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.MA_zip_lookup_base(CONSTRAINT pk_MA_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.MA_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'MA', c.name,p.name,'25'  FROM tiger_data.MA_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '25') INNER JOIN tiger_data.MA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.MA_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '25');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MA_zip_lookup_base_citysnd ON tiger_data.MA_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_25015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_25011_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_25*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MA_addr(CONSTRAINT pk_MA_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.MA_addr ALTER COLUMN statefp SET DEFAULT '25';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MA_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MA_addr'), lower('MA_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.MA_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '25');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MA_addr_least_address ON tiger_data.MA_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MA_addr_tlid_statefp ON tiger_data.MA_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MA_addr_zip ON tiger_data.MA_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.MA_zip_state(CONSTRAINT pk_MA_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.MA_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'MA', '25' FROM tiger_data.MA_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.MA_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '25');"
	%PSQL% -c "vacuum analyze tiger_data.MA_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_26_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_26*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MI_place(CONSTRAINT pk_MI_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_26_place.dbf tiger_staging.mi_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MI_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('MI_place'), lower('MI_place')); ALTER TABLE tiger_data.MI_place ADD CONSTRAINT uidx_MI_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_MI_place_soundex_name ON tiger_data.MI_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_MI_place_the_geom_gist ON tiger_data.MI_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.MI_place ADD CONSTRAINT chk_statefp CHECK (statefp = '26');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_26_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_26*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MI_cousub(CONSTRAINT pk_MI_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_MI_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_26_cousub.dbf tiger_staging.mi_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MI_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('MI_cousub'), lower('MI_cousub')); ALTER TABLE tiger_data.MI_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '26');"
%PSQL% -c "CREATE INDEX tiger_data_MI_cousub_the_geom_gist ON tiger_data.MI_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MI_cousub_countyfp ON tiger_data.MI_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_26_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_26*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MI_tract(CONSTRAINT pk_MI_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_26_tract.dbf tiger_staging.mi_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MI_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('MI_tract'), lower('MI_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_MI_tract_the_geom_gist ON tiger_data.MI_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.MI_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.MI_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '26');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_26109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_26091_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_26*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MI_faces(CONSTRAINT pk_MI_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MI_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MI_faces'), lower('MI_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_MI_faces_the_geom_gist ON tiger_data.MI_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MI_faces_tfid ON tiger_data.MI_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MI_faces_countyfp ON tiger_data.MI_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.MI_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '26');"
	%PSQL% -c "vacuum analyze tiger_data.MI_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_26109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_26091_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_26*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MI_featnames(CONSTRAINT pk_MI_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.MI_featnames ALTER COLUMN statefp SET DEFAULT '26';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MI_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MI_featnames'), lower('MI_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_MI_featnames_snd_name ON tiger_data.MI_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MI_featnames_lname ON tiger_data.MI_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MI_featnames_tlid_statefp ON tiger_data.MI_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.MI_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '26');"
%PSQL% -c "vacuum analyze tiger_data.MI_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_26109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_26091_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_26*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MI_edges(CONSTRAINT pk_MI_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MI_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MI_edges'), lower('MI_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.MI_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '26');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MI_edges_tlid ON tiger_data.MI_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MI_edgestfidr ON tiger_data.MI_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MI_edges_tfidl ON tiger_data.MI_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MI_edges_countyfp ON tiger_data.MI_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_MI_edges_the_geom_gist ON tiger_data.MI_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MI_edges_zipl ON tiger_data.MI_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.MI_zip_state_loc(CONSTRAINT pk_MI_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.MI_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'MI', '26', p.name FROM tiger_data.MI_edges AS e INNER JOIN tiger_data.MI_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MI_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_MI_zip_state_loc_place ON tiger_data.MI_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.MI_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '26');"
%PSQL% -c "vacuum analyze tiger_data.MI_edges;"
%PSQL% -c "vacuum analyze tiger_data.MI_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.MI_zip_lookup_base(CONSTRAINT pk_MI_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.MI_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'MI', c.name,p.name,'26'  FROM tiger_data.MI_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '26') INNER JOIN tiger_data.MI_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MI_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.MI_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '26');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MI_zip_lookup_base_citysnd ON tiger_data.MI_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_26109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_26091_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_26*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MI_addr(CONSTRAINT pk_MI_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.MI_addr ALTER COLUMN statefp SET DEFAULT '26';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MI_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MI_addr'), lower('MI_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.MI_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '26');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MI_addr_least_address ON tiger_data.MI_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MI_addr_tlid_statefp ON tiger_data.MI_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MI_addr_zip ON tiger_data.MI_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.MI_zip_state(CONSTRAINT pk_MI_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.MI_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'MI', '26' FROM tiger_data.MI_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.MI_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '26');"
	%PSQL% -c "vacuum analyze tiger_data.MI_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_27_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_27*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MN_place(CONSTRAINT pk_MN_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_27_place.dbf tiger_staging.mn_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MN_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('MN_place'), lower('MN_place')); ALTER TABLE tiger_data.MN_place ADD CONSTRAINT uidx_MN_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_MN_place_soundex_name ON tiger_data.MN_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_MN_place_the_geom_gist ON tiger_data.MN_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.MN_place ADD CONSTRAINT chk_statefp CHECK (statefp = '27');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_27_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_27*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MN_cousub(CONSTRAINT pk_MN_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_MN_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_27_cousub.dbf tiger_staging.mn_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MN_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('MN_cousub'), lower('MN_cousub')); ALTER TABLE tiger_data.MN_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '27');"
%PSQL% -c "CREATE INDEX tiger_data_MN_cousub_the_geom_gist ON tiger_data.MN_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MN_cousub_countyfp ON tiger_data.MN_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_27_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_27*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MN_tract(CONSTRAINT pk_MN_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_27_tract.dbf tiger_staging.mn_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MN_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('MN_tract'), lower('MN_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_MN_tract_the_geom_gist ON tiger_data.MN_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.MN_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.MN_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '27');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_27095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_27135_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_27*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MN_faces(CONSTRAINT pk_MN_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MN_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MN_faces'), lower('MN_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_MN_faces_the_geom_gist ON tiger_data.MN_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MN_faces_tfid ON tiger_data.MN_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MN_faces_countyfp ON tiger_data.MN_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.MN_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '27');"
	%PSQL% -c "vacuum analyze tiger_data.MN_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_27095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_27135_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_27*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MN_featnames(CONSTRAINT pk_MN_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.MN_featnames ALTER COLUMN statefp SET DEFAULT '27';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MN_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MN_featnames'), lower('MN_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_MN_featnames_snd_name ON tiger_data.MN_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MN_featnames_lname ON tiger_data.MN_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MN_featnames_tlid_statefp ON tiger_data.MN_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.MN_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '27');"
%PSQL% -c "vacuum analyze tiger_data.MN_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_27095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_27135_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_27*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MN_edges(CONSTRAINT pk_MN_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MN_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MN_edges'), lower('MN_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.MN_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '27');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MN_edges_tlid ON tiger_data.MN_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MN_edgestfidr ON tiger_data.MN_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MN_edges_tfidl ON tiger_data.MN_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MN_edges_countyfp ON tiger_data.MN_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_MN_edges_the_geom_gist ON tiger_data.MN_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MN_edges_zipl ON tiger_data.MN_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.MN_zip_state_loc(CONSTRAINT pk_MN_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.MN_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'MN', '27', p.name FROM tiger_data.MN_edges AS e INNER JOIN tiger_data.MN_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MN_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_MN_zip_state_loc_place ON tiger_data.MN_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.MN_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '27');"
%PSQL% -c "vacuum analyze tiger_data.MN_edges;"
%PSQL% -c "vacuum analyze tiger_data.MN_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.MN_zip_lookup_base(CONSTRAINT pk_MN_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.MN_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'MN', c.name,p.name,'27'  FROM tiger_data.MN_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '27') INNER JOIN tiger_data.MN_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MN_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.MN_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '27');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MN_zip_lookup_base_citysnd ON tiger_data.MN_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_27095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_27135_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_27*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MN_addr(CONSTRAINT pk_MN_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.MN_addr ALTER COLUMN statefp SET DEFAULT '27';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MN_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MN_addr'), lower('MN_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.MN_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '27');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MN_addr_least_address ON tiger_data.MN_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MN_addr_tlid_statefp ON tiger_data.MN_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MN_addr_zip ON tiger_data.MN_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.MN_zip_state(CONSTRAINT pk_MN_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.MN_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'MN', '27' FROM tiger_data.MN_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.MN_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '27');"
	%PSQL% -c "vacuum analyze tiger_data.MN_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_28_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_28*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MS_place(CONSTRAINT pk_MS_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_28_place.dbf tiger_staging.ms_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MS_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('MS_place'), lower('MS_place')); ALTER TABLE tiger_data.MS_place ADD CONSTRAINT uidx_MS_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_MS_place_soundex_name ON tiger_data.MS_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_MS_place_the_geom_gist ON tiger_data.MS_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.MS_place ADD CONSTRAINT chk_statefp CHECK (statefp = '28');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_28_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_28*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MS_cousub(CONSTRAINT pk_MS_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_MS_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_28_cousub.dbf tiger_staging.ms_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MS_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('MS_cousub'), lower('MS_cousub')); ALTER TABLE tiger_data.MS_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '28');"
%PSQL% -c "CREATE INDEX tiger_data_MS_cousub_the_geom_gist ON tiger_data.MS_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MS_cousub_countyfp ON tiger_data.MS_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_28_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_28*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MS_tract(CONSTRAINT pk_MS_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_28_tract.dbf tiger_staging.ms_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MS_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('MS_tract'), lower('MS_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_MS_tract_the_geom_gist ON tiger_data.MS_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.MS_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.MS_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '28');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_28061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_28155_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_28*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MS_faces(CONSTRAINT pk_MS_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MS_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MS_faces'), lower('MS_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_MS_faces_the_geom_gist ON tiger_data.MS_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MS_faces_tfid ON tiger_data.MS_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MS_faces_countyfp ON tiger_data.MS_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.MS_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '28');"
	%PSQL% -c "vacuum analyze tiger_data.MS_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_28061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_28155_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_28*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MS_featnames(CONSTRAINT pk_MS_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.MS_featnames ALTER COLUMN statefp SET DEFAULT '28';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MS_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MS_featnames'), lower('MS_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_MS_featnames_snd_name ON tiger_data.MS_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MS_featnames_lname ON tiger_data.MS_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MS_featnames_tlid_statefp ON tiger_data.MS_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.MS_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '28');"
%PSQL% -c "vacuum analyze tiger_data.MS_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_28061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_28155_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_28*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MS_edges(CONSTRAINT pk_MS_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MS_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MS_edges'), lower('MS_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.MS_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '28');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MS_edges_tlid ON tiger_data.MS_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MS_edgestfidr ON tiger_data.MS_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MS_edges_tfidl ON tiger_data.MS_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MS_edges_countyfp ON tiger_data.MS_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_MS_edges_the_geom_gist ON tiger_data.MS_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MS_edges_zipl ON tiger_data.MS_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.MS_zip_state_loc(CONSTRAINT pk_MS_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.MS_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'MS', '28', p.name FROM tiger_data.MS_edges AS e INNER JOIN tiger_data.MS_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MS_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_MS_zip_state_loc_place ON tiger_data.MS_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.MS_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '28');"
%PSQL% -c "vacuum analyze tiger_data.MS_edges;"
%PSQL% -c "vacuum analyze tiger_data.MS_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.MS_zip_lookup_base(CONSTRAINT pk_MS_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.MS_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'MS', c.name,p.name,'28'  FROM tiger_data.MS_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '28') INNER JOIN tiger_data.MS_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MS_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.MS_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '28');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MS_zip_lookup_base_citysnd ON tiger_data.MS_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_28061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_28155_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_28*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MS_addr(CONSTRAINT pk_MS_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.MS_addr ALTER COLUMN statefp SET DEFAULT '28';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MS_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MS_addr'), lower('MS_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.MS_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '28');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MS_addr_least_address ON tiger_data.MS_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MS_addr_tlid_statefp ON tiger_data.MS_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MS_addr_zip ON tiger_data.MS_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.MS_zip_state(CONSTRAINT pk_MS_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.MS_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'MS', '28' FROM tiger_data.MS_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.MS_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '28');"
	%PSQL% -c "vacuum analyze tiger_data.MS_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_29_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_29*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MO_place(CONSTRAINT pk_MO_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_29_place.dbf tiger_staging.mo_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MO_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('MO_place'), lower('MO_place')); ALTER TABLE tiger_data.MO_place ADD CONSTRAINT uidx_MO_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_MO_place_soundex_name ON tiger_data.MO_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_MO_place_the_geom_gist ON tiger_data.MO_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.MO_place ADD CONSTRAINT chk_statefp CHECK (statefp = '29');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_29_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_29*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MO_cousub(CONSTRAINT pk_MO_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_MO_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_29_cousub.dbf tiger_staging.mo_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MO_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('MO_cousub'), lower('MO_cousub')); ALTER TABLE tiger_data.MO_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '29');"
%PSQL% -c "CREATE INDEX tiger_data_MO_cousub_the_geom_gist ON tiger_data.MO_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MO_cousub_countyfp ON tiger_data.MO_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_29_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_29*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MO_tract(CONSTRAINT pk_MO_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_29_tract.dbf tiger_staging.mo_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MO_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('MO_tract'), lower('MO_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_MO_tract_the_geom_gist ON tiger_data.MO_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.MO_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.MO_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '29');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_29083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29179_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29225_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29201_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29209_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29221_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29177_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29195_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29223_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29183_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29186_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29227_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29181_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29219_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29207_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29189_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29229_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29211_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29213_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29215_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29197_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29205_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29203_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29199_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29187_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29217_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29185_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29510_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_29029_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_29*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MO_faces(CONSTRAINT pk_MO_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MO_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MO_faces'), lower('MO_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_MO_faces_the_geom_gist ON tiger_data.MO_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MO_faces_tfid ON tiger_data.MO_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MO_faces_countyfp ON tiger_data.MO_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.MO_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '29');"
	%PSQL% -c "vacuum analyze tiger_data.MO_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_29083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29179_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29225_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29201_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29209_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29221_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29177_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29195_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29223_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29183_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29186_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29227_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29181_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29219_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29207_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29189_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29229_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29211_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29213_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29215_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29197_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29205_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29203_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29199_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29187_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29217_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29185_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29510_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_29029_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_29*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MO_featnames(CONSTRAINT pk_MO_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.MO_featnames ALTER COLUMN statefp SET DEFAULT '29';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MO_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MO_featnames'), lower('MO_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_MO_featnames_snd_name ON tiger_data.MO_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MO_featnames_lname ON tiger_data.MO_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MO_featnames_tlid_statefp ON tiger_data.MO_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.MO_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '29');"
%PSQL% -c "vacuum analyze tiger_data.MO_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_29083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29179_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29225_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29201_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29209_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29221_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29177_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29195_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29223_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29183_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29186_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29227_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29181_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29219_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29207_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29189_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29229_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29211_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29213_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29215_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29197_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29205_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29203_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29199_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29187_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29217_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29185_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29510_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_29029_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_29*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MO_edges(CONSTRAINT pk_MO_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MO_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MO_edges'), lower('MO_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.MO_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '29');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MO_edges_tlid ON tiger_data.MO_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MO_edgestfidr ON tiger_data.MO_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MO_edges_tfidl ON tiger_data.MO_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MO_edges_countyfp ON tiger_data.MO_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_MO_edges_the_geom_gist ON tiger_data.MO_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MO_edges_zipl ON tiger_data.MO_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.MO_zip_state_loc(CONSTRAINT pk_MO_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.MO_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'MO', '29', p.name FROM tiger_data.MO_edges AS e INNER JOIN tiger_data.MO_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MO_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_MO_zip_state_loc_place ON tiger_data.MO_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.MO_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '29');"
%PSQL% -c "vacuum analyze tiger_data.MO_edges;"
%PSQL% -c "vacuum analyze tiger_data.MO_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.MO_zip_lookup_base(CONSTRAINT pk_MO_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.MO_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'MO', c.name,p.name,'29'  FROM tiger_data.MO_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '29') INNER JOIN tiger_data.MO_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MO_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.MO_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '29');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MO_zip_lookup_base_citysnd ON tiger_data.MO_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_29083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29179_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29225_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29201_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29209_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29221_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29177_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29195_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29223_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29183_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29186_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29227_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29181_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29219_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29207_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29189_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29229_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29211_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29213_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29215_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29197_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29205_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29203_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29199_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29187_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29217_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29185_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29510_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_29029_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_29*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MO_addr(CONSTRAINT pk_MO_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.MO_addr ALTER COLUMN statefp SET DEFAULT '29';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MO_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MO_addr'), lower('MO_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.MO_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '29');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MO_addr_least_address ON tiger_data.MO_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MO_addr_tlid_statefp ON tiger_data.MO_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MO_addr_zip ON tiger_data.MO_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.MO_zip_state(CONSTRAINT pk_MO_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.MO_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'MO', '29' FROM tiger_data.MO_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.MO_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '29');"
	%PSQL% -c "vacuum analyze tiger_data.MO_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_30_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_30*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MT_place(CONSTRAINT pk_MT_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_30_place.dbf tiger_staging.mt_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MT_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('MT_place'), lower('MT_place')); ALTER TABLE tiger_data.MT_place ADD CONSTRAINT uidx_MT_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_MT_place_soundex_name ON tiger_data.MT_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_MT_place_the_geom_gist ON tiger_data.MT_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.MT_place ADD CONSTRAINT chk_statefp CHECK (statefp = '30');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_30_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_30*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MT_cousub(CONSTRAINT pk_MT_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_MT_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_30_cousub.dbf tiger_staging.mt_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MT_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('MT_cousub'), lower('MT_cousub')); ALTER TABLE tiger_data.MT_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '30');"
%PSQL% -c "CREATE INDEX tiger_data_MT_cousub_the_geom_gist ON tiger_data.MT_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MT_cousub_countyfp ON tiger_data.MT_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_30_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_30*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MT_tract(CONSTRAINT pk_MT_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_30_tract.dbf tiger_staging.mt_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MT_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('MT_tract'), lower('MT_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_MT_tract_the_geom_gist ON tiger_data.MT_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.MT_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.MT_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '30');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_30065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_30001_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_30*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MT_faces(CONSTRAINT pk_MT_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MT_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MT_faces'), lower('MT_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_MT_faces_the_geom_gist ON tiger_data.MT_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MT_faces_tfid ON tiger_data.MT_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MT_faces_countyfp ON tiger_data.MT_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.MT_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '30');"
	%PSQL% -c "vacuum analyze tiger_data.MT_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_30065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_30001_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_30*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MT_featnames(CONSTRAINT pk_MT_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.MT_featnames ALTER COLUMN statefp SET DEFAULT '30';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MT_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MT_featnames'), lower('MT_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_MT_featnames_snd_name ON tiger_data.MT_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MT_featnames_lname ON tiger_data.MT_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MT_featnames_tlid_statefp ON tiger_data.MT_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.MT_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '30');"
%PSQL% -c "vacuum analyze tiger_data.MT_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_30065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_30001_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_30*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MT_edges(CONSTRAINT pk_MT_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MT_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MT_edges'), lower('MT_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.MT_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '30');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MT_edges_tlid ON tiger_data.MT_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MT_edgestfidr ON tiger_data.MT_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MT_edges_tfidl ON tiger_data.MT_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MT_edges_countyfp ON tiger_data.MT_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_MT_edges_the_geom_gist ON tiger_data.MT_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MT_edges_zipl ON tiger_data.MT_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.MT_zip_state_loc(CONSTRAINT pk_MT_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.MT_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'MT', '30', p.name FROM tiger_data.MT_edges AS e INNER JOIN tiger_data.MT_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MT_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_MT_zip_state_loc_place ON tiger_data.MT_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.MT_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '30');"
%PSQL% -c "vacuum analyze tiger_data.MT_edges;"
%PSQL% -c "vacuum analyze tiger_data.MT_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.MT_zip_lookup_base(CONSTRAINT pk_MT_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.MT_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'MT', c.name,p.name,'30'  FROM tiger_data.MT_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '30') INNER JOIN tiger_data.MT_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MT_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.MT_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '30');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MT_zip_lookup_base_citysnd ON tiger_data.MT_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_30065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_30001_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_30*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MT_addr(CONSTRAINT pk_MT_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.MT_addr ALTER COLUMN statefp SET DEFAULT '30';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MT_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MT_addr'), lower('MT_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.MT_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '30');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MT_addr_least_address ON tiger_data.MT_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MT_addr_tlid_statefp ON tiger_data.MT_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MT_addr_zip ON tiger_data.MT_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.MT_zip_state(CONSTRAINT pk_MT_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.MT_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'MT', '30' FROM tiger_data.MT_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.MT_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '30');"
	%PSQL% -c "vacuum analyze tiger_data.MT_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_31_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_31*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NE_place(CONSTRAINT pk_NE_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_31_place.dbf tiger_staging.ne_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NE_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('NE_place'), lower('NE_place')); ALTER TABLE tiger_data.NE_place ADD CONSTRAINT uidx_NE_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_NE_place_soundex_name ON tiger_data.NE_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_NE_place_the_geom_gist ON tiger_data.NE_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.NE_place ADD CONSTRAINT chk_statefp CHECK (statefp = '31');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_31_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_31*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NE_cousub(CONSTRAINT pk_NE_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_NE_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_31_cousub.dbf tiger_staging.ne_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NE_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('NE_cousub'), lower('NE_cousub')); ALTER TABLE tiger_data.NE_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '31');"
%PSQL% -c "CREATE INDEX tiger_data_NE_cousub_the_geom_gist ON tiger_data.NE_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NE_cousub_countyfp ON tiger_data.NE_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_31_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_31*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NE_tract(CONSTRAINT pk_NE_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_31_tract.dbf tiger_staging.ne_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NE_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('NE_tract'), lower('NE_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_NE_tract_the_geom_gist ON tiger_data.NE_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.NE_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.NE_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '31');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_31039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31181_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31179_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31183_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31185_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31177_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_31031_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_31*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NE_faces(CONSTRAINT pk_NE_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NE_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NE_faces'), lower('NE_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_NE_faces_the_geom_gist ON tiger_data.NE_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NE_faces_tfid ON tiger_data.NE_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NE_faces_countyfp ON tiger_data.NE_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.NE_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '31');"
	%PSQL% -c "vacuum analyze tiger_data.NE_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_31039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31181_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31179_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31183_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31185_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31177_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_31031_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_31*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NE_featnames(CONSTRAINT pk_NE_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.NE_featnames ALTER COLUMN statefp SET DEFAULT '31';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NE_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NE_featnames'), lower('NE_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_NE_featnames_snd_name ON tiger_data.NE_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NE_featnames_lname ON tiger_data.NE_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NE_featnames_tlid_statefp ON tiger_data.NE_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.NE_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '31');"
%PSQL% -c "vacuum analyze tiger_data.NE_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_31039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31181_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31179_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31183_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31185_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31177_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_31031_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_31*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NE_edges(CONSTRAINT pk_NE_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NE_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NE_edges'), lower('NE_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.NE_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '31');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NE_edges_tlid ON tiger_data.NE_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NE_edgestfidr ON tiger_data.NE_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NE_edges_tfidl ON tiger_data.NE_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NE_edges_countyfp ON tiger_data.NE_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_NE_edges_the_geom_gist ON tiger_data.NE_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NE_edges_zipl ON tiger_data.NE_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.NE_zip_state_loc(CONSTRAINT pk_NE_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.NE_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'NE', '31', p.name FROM tiger_data.NE_edges AS e INNER JOIN tiger_data.NE_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NE_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_NE_zip_state_loc_place ON tiger_data.NE_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.NE_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '31');"
%PSQL% -c "vacuum analyze tiger_data.NE_edges;"
%PSQL% -c "vacuum analyze tiger_data.NE_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.NE_zip_lookup_base(CONSTRAINT pk_NE_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.NE_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'NE', c.name,p.name,'31'  FROM tiger_data.NE_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '31') INNER JOIN tiger_data.NE_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NE_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.NE_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '31');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NE_zip_lookup_base_citysnd ON tiger_data.NE_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_31039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31181_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31179_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31183_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31185_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31177_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_31031_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_31*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NE_addr(CONSTRAINT pk_NE_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.NE_addr ALTER COLUMN statefp SET DEFAULT '31';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NE_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NE_addr'), lower('NE_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.NE_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '31');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NE_addr_least_address ON tiger_data.NE_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NE_addr_tlid_statefp ON tiger_data.NE_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NE_addr_zip ON tiger_data.NE_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.NE_zip_state(CONSTRAINT pk_NE_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.NE_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'NE', '31' FROM tiger_data.NE_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.NE_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '31');"
	%PSQL% -c "vacuum analyze tiger_data.NE_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_32_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_32*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NV_place(CONSTRAINT pk_NV_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_32_place.dbf tiger_staging.nv_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NV_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('NV_place'), lower('NV_place')); ALTER TABLE tiger_data.NV_place ADD CONSTRAINT uidx_NV_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_NV_place_soundex_name ON tiger_data.NV_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_NV_place_the_geom_gist ON tiger_data.NV_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.NV_place ADD CONSTRAINT chk_statefp CHECK (statefp = '32');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_32_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_32*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NV_cousub(CONSTRAINT pk_NV_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_NV_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_32_cousub.dbf tiger_staging.nv_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NV_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('NV_cousub'), lower('NV_cousub')); ALTER TABLE tiger_data.NV_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '32');"
%PSQL% -c "CREATE INDEX tiger_data_NV_cousub_the_geom_gist ON tiger_data.NV_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NV_cousub_countyfp ON tiger_data.NV_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_32_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_32*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NV_tract(CONSTRAINT pk_NV_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_32_tract.dbf tiger_staging.nv_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NV_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('NV_tract'), lower('NV_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_NV_tract_the_geom_gist ON tiger_data.NV_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.NV_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.NV_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '32');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_32001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32510_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_32009_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_32*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NV_faces(CONSTRAINT pk_NV_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NV_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NV_faces'), lower('NV_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_NV_faces_the_geom_gist ON tiger_data.NV_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NV_faces_tfid ON tiger_data.NV_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NV_faces_countyfp ON tiger_data.NV_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.NV_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '32');"
	%PSQL% -c "vacuum analyze tiger_data.NV_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_32001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32510_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_32009_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_32*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NV_featnames(CONSTRAINT pk_NV_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.NV_featnames ALTER COLUMN statefp SET DEFAULT '32';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NV_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NV_featnames'), lower('NV_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_NV_featnames_snd_name ON tiger_data.NV_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NV_featnames_lname ON tiger_data.NV_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NV_featnames_tlid_statefp ON tiger_data.NV_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.NV_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '32');"
%PSQL% -c "vacuum analyze tiger_data.NV_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_32001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32510_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_32009_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_32*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NV_edges(CONSTRAINT pk_NV_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NV_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NV_edges'), lower('NV_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.NV_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '32');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NV_edges_tlid ON tiger_data.NV_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NV_edgestfidr ON tiger_data.NV_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NV_edges_tfidl ON tiger_data.NV_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NV_edges_countyfp ON tiger_data.NV_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_NV_edges_the_geom_gist ON tiger_data.NV_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NV_edges_zipl ON tiger_data.NV_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.NV_zip_state_loc(CONSTRAINT pk_NV_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.NV_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'NV', '32', p.name FROM tiger_data.NV_edges AS e INNER JOIN tiger_data.NV_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NV_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_NV_zip_state_loc_place ON tiger_data.NV_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.NV_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '32');"
%PSQL% -c "vacuum analyze tiger_data.NV_edges;"
%PSQL% -c "vacuum analyze tiger_data.NV_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.NV_zip_lookup_base(CONSTRAINT pk_NV_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.NV_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'NV', c.name,p.name,'32'  FROM tiger_data.NV_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '32') INNER JOIN tiger_data.NV_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NV_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.NV_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '32');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NV_zip_lookup_base_citysnd ON tiger_data.NV_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_32001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32510_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_32009_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_32*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NV_addr(CONSTRAINT pk_NV_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.NV_addr ALTER COLUMN statefp SET DEFAULT '32';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NV_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NV_addr'), lower('NV_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.NV_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '32');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NV_addr_least_address ON tiger_data.NV_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NV_addr_tlid_statefp ON tiger_data.NV_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NV_addr_zip ON tiger_data.NV_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.NV_zip_state(CONSTRAINT pk_NV_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.NV_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'NV', '32' FROM tiger_data.NV_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.NV_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '32');"
	%PSQL% -c "vacuum analyze tiger_data.NV_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_33_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_33*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NH_place(CONSTRAINT pk_NH_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_33_place.dbf tiger_staging.nh_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NH_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('NH_place'), lower('NH_place')); ALTER TABLE tiger_data.NH_place ADD CONSTRAINT uidx_NH_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_NH_place_soundex_name ON tiger_data.NH_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_NH_place_the_geom_gist ON tiger_data.NH_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.NH_place ADD CONSTRAINT chk_statefp CHECK (statefp = '33');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_33_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_33*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NH_cousub(CONSTRAINT pk_NH_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_NH_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_33_cousub.dbf tiger_staging.nh_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NH_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('NH_cousub'), lower('NH_cousub')); ALTER TABLE tiger_data.NH_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '33');"
%PSQL% -c "CREATE INDEX tiger_data_NH_cousub_the_geom_gist ON tiger_data.NH_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NH_cousub_countyfp ON tiger_data.NH_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_33_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_33*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NH_tract(CONSTRAINT pk_NH_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_33_tract.dbf tiger_staging.nh_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NH_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('NH_tract'), lower('NH_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_NH_tract_the_geom_gist ON tiger_data.NH_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.NH_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.NH_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '33');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_33009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_33019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_33005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_33007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_33013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_33003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_33015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_33011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_33017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_33001_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_33*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NH_faces(CONSTRAINT pk_NH_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NH_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NH_faces'), lower('NH_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_NH_faces_the_geom_gist ON tiger_data.NH_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NH_faces_tfid ON tiger_data.NH_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NH_faces_countyfp ON tiger_data.NH_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.NH_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '33');"
	%PSQL% -c "vacuum analyze tiger_data.NH_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_33009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_33019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_33005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_33007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_33013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_33003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_33015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_33011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_33017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_33001_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_33*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NH_featnames(CONSTRAINT pk_NH_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.NH_featnames ALTER COLUMN statefp SET DEFAULT '33';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NH_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NH_featnames'), lower('NH_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_NH_featnames_snd_name ON tiger_data.NH_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NH_featnames_lname ON tiger_data.NH_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NH_featnames_tlid_statefp ON tiger_data.NH_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.NH_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '33');"
%PSQL% -c "vacuum analyze tiger_data.NH_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_33009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_33019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_33005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_33007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_33013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_33003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_33015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_33011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_33017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_33001_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_33*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NH_edges(CONSTRAINT pk_NH_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NH_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NH_edges'), lower('NH_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.NH_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '33');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NH_edges_tlid ON tiger_data.NH_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NH_edgestfidr ON tiger_data.NH_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NH_edges_tfidl ON tiger_data.NH_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NH_edges_countyfp ON tiger_data.NH_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_NH_edges_the_geom_gist ON tiger_data.NH_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NH_edges_zipl ON tiger_data.NH_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.NH_zip_state_loc(CONSTRAINT pk_NH_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.NH_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'NH', '33', p.name FROM tiger_data.NH_edges AS e INNER JOIN tiger_data.NH_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NH_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_NH_zip_state_loc_place ON tiger_data.NH_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.NH_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '33');"
%PSQL% -c "vacuum analyze tiger_data.NH_edges;"
%PSQL% -c "vacuum analyze tiger_data.NH_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.NH_zip_lookup_base(CONSTRAINT pk_NH_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.NH_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'NH', c.name,p.name,'33'  FROM tiger_data.NH_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '33') INNER JOIN tiger_data.NH_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NH_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.NH_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '33');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NH_zip_lookup_base_citysnd ON tiger_data.NH_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_33009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_33019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_33005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_33007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_33013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_33003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_33015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_33011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_33017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_33001_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_33*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NH_addr(CONSTRAINT pk_NH_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.NH_addr ALTER COLUMN statefp SET DEFAULT '33';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NH_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NH_addr'), lower('NH_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.NH_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '33');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NH_addr_least_address ON tiger_data.NH_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NH_addr_tlid_statefp ON tiger_data.NH_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NH_addr_zip ON tiger_data.NH_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.NH_zip_state(CONSTRAINT pk_NH_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.NH_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'NH', '33' FROM tiger_data.NH_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.NH_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '33');"
	%PSQL% -c "vacuum analyze tiger_data.NH_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_34_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_34*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NJ_place(CONSTRAINT pk_NJ_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_34_place.dbf tiger_staging.nj_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NJ_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('NJ_place'), lower('NJ_place')); ALTER TABLE tiger_data.NJ_place ADD CONSTRAINT uidx_NJ_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_NJ_place_soundex_name ON tiger_data.NJ_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_NJ_place_the_geom_gist ON tiger_data.NJ_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.NJ_place ADD CONSTRAINT chk_statefp CHECK (statefp = '34');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_34_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_34*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NJ_cousub(CONSTRAINT pk_NJ_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_NJ_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_34_cousub.dbf tiger_staging.nj_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NJ_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('NJ_cousub'), lower('NJ_cousub')); ALTER TABLE tiger_data.NJ_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '34');"
%PSQL% -c "CREATE INDEX tiger_data_NJ_cousub_the_geom_gist ON tiger_data.NJ_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_cousub_countyfp ON tiger_data.NJ_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_34_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_34*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NJ_tract(CONSTRAINT pk_NJ_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_34_tract.dbf tiger_staging.nj_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NJ_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('NJ_tract'), lower('NJ_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_NJ_tract_the_geom_gist ON tiger_data.NJ_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.NJ_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.NJ_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '34');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_34037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_34021_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_34*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NJ_faces(CONSTRAINT pk_NJ_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NJ_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NJ_faces'), lower('NJ_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_NJ_faces_the_geom_gist ON tiger_data.NJ_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_faces_tfid ON tiger_data.NJ_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_faces_countyfp ON tiger_data.NJ_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.NJ_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '34');"
	%PSQL% -c "vacuum analyze tiger_data.NJ_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_34037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_34021_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_34*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NJ_featnames(CONSTRAINT pk_NJ_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.NJ_featnames ALTER COLUMN statefp SET DEFAULT '34';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NJ_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NJ_featnames'), lower('NJ_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_featnames_snd_name ON tiger_data.NJ_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_featnames_lname ON tiger_data.NJ_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_featnames_tlid_statefp ON tiger_data.NJ_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.NJ_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '34');"
%PSQL% -c "vacuum analyze tiger_data.NJ_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_34037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_34021_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_34*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NJ_edges(CONSTRAINT pk_NJ_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NJ_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NJ_edges'), lower('NJ_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.NJ_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '34');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_edges_tlid ON tiger_data.NJ_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_edgestfidr ON tiger_data.NJ_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_edges_tfidl ON tiger_data.NJ_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_edges_countyfp ON tiger_data.NJ_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_NJ_edges_the_geom_gist ON tiger_data.NJ_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_edges_zipl ON tiger_data.NJ_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.NJ_zip_state_loc(CONSTRAINT pk_NJ_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.NJ_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'NJ', '34', p.name FROM tiger_data.NJ_edges AS e INNER JOIN tiger_data.NJ_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NJ_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_zip_state_loc_place ON tiger_data.NJ_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.NJ_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '34');"
%PSQL% -c "vacuum analyze tiger_data.NJ_edges;"
%PSQL% -c "vacuum analyze tiger_data.NJ_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.NJ_zip_lookup_base(CONSTRAINT pk_NJ_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.NJ_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'NJ', c.name,p.name,'34'  FROM tiger_data.NJ_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '34') INNER JOIN tiger_data.NJ_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NJ_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.NJ_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '34');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_zip_lookup_base_citysnd ON tiger_data.NJ_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_34037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_34021_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_34*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NJ_addr(CONSTRAINT pk_NJ_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.NJ_addr ALTER COLUMN statefp SET DEFAULT '34';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NJ_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NJ_addr'), lower('NJ_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.NJ_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '34');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_addr_least_address ON tiger_data.NJ_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_addr_tlid_statefp ON tiger_data.NJ_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NJ_addr_zip ON tiger_data.NJ_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.NJ_zip_state(CONSTRAINT pk_NJ_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.NJ_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'NJ', '34' FROM tiger_data.NJ_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.NJ_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '34');"
	%PSQL% -c "vacuum analyze tiger_data.NJ_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_35_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_35*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NM_place(CONSTRAINT pk_NM_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_35_place.dbf tiger_staging.nm_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NM_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('NM_place'), lower('NM_place')); ALTER TABLE tiger_data.NM_place ADD CONSTRAINT uidx_NM_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_NM_place_soundex_name ON tiger_data.NM_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_NM_place_the_geom_gist ON tiger_data.NM_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.NM_place ADD CONSTRAINT chk_statefp CHECK (statefp = '35');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_35_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_35*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NM_cousub(CONSTRAINT pk_NM_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_NM_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_35_cousub.dbf tiger_staging.nm_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NM_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('NM_cousub'), lower('NM_cousub')); ALTER TABLE tiger_data.NM_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '35');"
%PSQL% -c "CREATE INDEX tiger_data_NM_cousub_the_geom_gist ON tiger_data.NM_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NM_cousub_countyfp ON tiger_data.NM_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_35_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_35*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NM_tract(CONSTRAINT pk_NM_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_35_tract.dbf tiger_staging.nm_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NM_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('NM_tract'), lower('NM_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_NM_tract_the_geom_gist ON tiger_data.NM_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.NM_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.NM_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '35');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_35011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35006_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35028_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_35061_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_35*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NM_faces(CONSTRAINT pk_NM_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NM_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NM_faces'), lower('NM_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_NM_faces_the_geom_gist ON tiger_data.NM_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NM_faces_tfid ON tiger_data.NM_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NM_faces_countyfp ON tiger_data.NM_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.NM_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '35');"
	%PSQL% -c "vacuum analyze tiger_data.NM_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_35011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35006_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35028_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_35061_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_35*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NM_featnames(CONSTRAINT pk_NM_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.NM_featnames ALTER COLUMN statefp SET DEFAULT '35';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NM_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NM_featnames'), lower('NM_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_NM_featnames_snd_name ON tiger_data.NM_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NM_featnames_lname ON tiger_data.NM_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NM_featnames_tlid_statefp ON tiger_data.NM_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.NM_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '35');"
%PSQL% -c "vacuum analyze tiger_data.NM_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_35011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35006_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35028_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_35061_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_35*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NM_edges(CONSTRAINT pk_NM_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NM_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NM_edges'), lower('NM_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.NM_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '35');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NM_edges_tlid ON tiger_data.NM_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NM_edgestfidr ON tiger_data.NM_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NM_edges_tfidl ON tiger_data.NM_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NM_edges_countyfp ON tiger_data.NM_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_NM_edges_the_geom_gist ON tiger_data.NM_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NM_edges_zipl ON tiger_data.NM_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.NM_zip_state_loc(CONSTRAINT pk_NM_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.NM_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'NM', '35', p.name FROM tiger_data.NM_edges AS e INNER JOIN tiger_data.NM_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NM_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_NM_zip_state_loc_place ON tiger_data.NM_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.NM_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '35');"
%PSQL% -c "vacuum analyze tiger_data.NM_edges;"
%PSQL% -c "vacuum analyze tiger_data.NM_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.NM_zip_lookup_base(CONSTRAINT pk_NM_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.NM_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'NM', c.name,p.name,'35'  FROM tiger_data.NM_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '35') INNER JOIN tiger_data.NM_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NM_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.NM_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '35');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NM_zip_lookup_base_citysnd ON tiger_data.NM_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_35011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35006_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35028_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_35061_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_35*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NM_addr(CONSTRAINT pk_NM_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.NM_addr ALTER COLUMN statefp SET DEFAULT '35';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NM_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NM_addr'), lower('NM_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.NM_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '35');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NM_addr_least_address ON tiger_data.NM_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NM_addr_tlid_statefp ON tiger_data.NM_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NM_addr_zip ON tiger_data.NM_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.NM_zip_state(CONSTRAINT pk_NM_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.NM_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'NM', '35' FROM tiger_data.NM_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.NM_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '35');"
	%PSQL% -c "vacuum analyze tiger_data.NM_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_36_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_36*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NY_place(CONSTRAINT pk_NY_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_36_place.dbf tiger_staging.ny_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NY_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('NY_place'), lower('NY_place')); ALTER TABLE tiger_data.NY_place ADD CONSTRAINT uidx_NY_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_NY_place_soundex_name ON tiger_data.NY_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_NY_place_the_geom_gist ON tiger_data.NY_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.NY_place ADD CONSTRAINT chk_statefp CHECK (statefp = '36');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_36_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_36*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NY_cousub(CONSTRAINT pk_NY_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_NY_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_36_cousub.dbf tiger_staging.ny_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NY_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('NY_cousub'), lower('NY_cousub')); ALTER TABLE tiger_data.NY_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '36');"
%PSQL% -c "CREATE INDEX tiger_data_NY_cousub_the_geom_gist ON tiger_data.NY_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NY_cousub_countyfp ON tiger_data.NY_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_36_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_36*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NY_tract(CONSTRAINT pk_NY_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_36_tract.dbf tiger_staging.ny_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NY_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('NY_tract'), lower('NY_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_NY_tract_the_geom_gist ON tiger_data.NY_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.NY_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.NY_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '36');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_36101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_36005_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_36*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NY_faces(CONSTRAINT pk_NY_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NY_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NY_faces'), lower('NY_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_NY_faces_the_geom_gist ON tiger_data.NY_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NY_faces_tfid ON tiger_data.NY_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NY_faces_countyfp ON tiger_data.NY_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.NY_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '36');"
	%PSQL% -c "vacuum analyze tiger_data.NY_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_36101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_36005_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_36*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NY_featnames(CONSTRAINT pk_NY_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.NY_featnames ALTER COLUMN statefp SET DEFAULT '36';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NY_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NY_featnames'), lower('NY_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_NY_featnames_snd_name ON tiger_data.NY_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NY_featnames_lname ON tiger_data.NY_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NY_featnames_tlid_statefp ON tiger_data.NY_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.NY_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '36');"
%PSQL% -c "vacuum analyze tiger_data.NY_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_36101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_36005_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_36*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NY_edges(CONSTRAINT pk_NY_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NY_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NY_edges'), lower('NY_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.NY_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '36');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NY_edges_tlid ON tiger_data.NY_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NY_edgestfidr ON tiger_data.NY_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NY_edges_tfidl ON tiger_data.NY_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NY_edges_countyfp ON tiger_data.NY_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_NY_edges_the_geom_gist ON tiger_data.NY_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NY_edges_zipl ON tiger_data.NY_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.NY_zip_state_loc(CONSTRAINT pk_NY_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.NY_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'NY', '36', p.name FROM tiger_data.NY_edges AS e INNER JOIN tiger_data.NY_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NY_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_NY_zip_state_loc_place ON tiger_data.NY_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.NY_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '36');"
%PSQL% -c "vacuum analyze tiger_data.NY_edges;"
%PSQL% -c "vacuum analyze tiger_data.NY_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.NY_zip_lookup_base(CONSTRAINT pk_NY_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.NY_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'NY', c.name,p.name,'36'  FROM tiger_data.NY_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '36') INNER JOIN tiger_data.NY_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NY_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.NY_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '36');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NY_zip_lookup_base_citysnd ON tiger_data.NY_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_36101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_36005_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_36*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NY_addr(CONSTRAINT pk_NY_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.NY_addr ALTER COLUMN statefp SET DEFAULT '36';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NY_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NY_addr'), lower('NY_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.NY_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '36');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NY_addr_least_address ON tiger_data.NY_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NY_addr_tlid_statefp ON tiger_data.NY_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NY_addr_zip ON tiger_data.NY_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.NY_zip_state(CONSTRAINT pk_NY_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.NY_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'NY', '36' FROM tiger_data.NY_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.NY_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '36');"
	%PSQL% -c "vacuum analyze tiger_data.NY_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_37_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_37*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NC_place(CONSTRAINT pk_NC_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_37_place.dbf tiger_staging.nc_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NC_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('NC_place'), lower('NC_place')); ALTER TABLE tiger_data.NC_place ADD CONSTRAINT uidx_NC_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_NC_place_soundex_name ON tiger_data.NC_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_NC_place_the_geom_gist ON tiger_data.NC_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.NC_place ADD CONSTRAINT chk_statefp CHECK (statefp = '37');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_37_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_37*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NC_cousub(CONSTRAINT pk_NC_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_NC_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_37_cousub.dbf tiger_staging.nc_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NC_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('NC_cousub'), lower('NC_cousub')); ALTER TABLE tiger_data.NC_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '37');"
%PSQL% -c "CREATE INDEX tiger_data_NC_cousub_the_geom_gist ON tiger_data.NC_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NC_cousub_countyfp ON tiger_data.NC_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_37_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_37*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NC_tract(CONSTRAINT pk_NC_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_37_tract.dbf tiger_staging.nc_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.NC_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('NC_tract'), lower('NC_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_NC_tract_the_geom_gist ON tiger_data.NC_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.NC_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.NC_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '37');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_37037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37193_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37189_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37185_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37187_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37195_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37177_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37179_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37199_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37197_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37191_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37183_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37181_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_37047_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_37*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NC_faces(CONSTRAINT pk_NC_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NC_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NC_faces'), lower('NC_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_NC_faces_the_geom_gist ON tiger_data.NC_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NC_faces_tfid ON tiger_data.NC_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NC_faces_countyfp ON tiger_data.NC_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.NC_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '37');"
	%PSQL% -c "vacuum analyze tiger_data.NC_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_37037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37193_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37189_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37185_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37187_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37195_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37177_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37179_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37199_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37197_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37191_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37183_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37181_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_37047_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_37*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NC_featnames(CONSTRAINT pk_NC_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.NC_featnames ALTER COLUMN statefp SET DEFAULT '37';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NC_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NC_featnames'), lower('NC_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_NC_featnames_snd_name ON tiger_data.NC_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NC_featnames_lname ON tiger_data.NC_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_NC_featnames_tlid_statefp ON tiger_data.NC_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.NC_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '37');"
%PSQL% -c "vacuum analyze tiger_data.NC_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_37037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37193_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37189_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37185_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37187_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37195_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37177_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37179_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37199_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37197_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37191_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37183_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37181_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_37047_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_37*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NC_edges(CONSTRAINT pk_NC_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NC_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NC_edges'), lower('NC_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.NC_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '37');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NC_edges_tlid ON tiger_data.NC_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NC_edgestfidr ON tiger_data.NC_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NC_edges_tfidl ON tiger_data.NC_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NC_edges_countyfp ON tiger_data.NC_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_NC_edges_the_geom_gist ON tiger_data.NC_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_NC_edges_zipl ON tiger_data.NC_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.NC_zip_state_loc(CONSTRAINT pk_NC_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.NC_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'NC', '37', p.name FROM tiger_data.NC_edges AS e INNER JOIN tiger_data.NC_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NC_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_NC_zip_state_loc_place ON tiger_data.NC_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.NC_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '37');"
%PSQL% -c "vacuum analyze tiger_data.NC_edges;"
%PSQL% -c "vacuum analyze tiger_data.NC_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.NC_zip_lookup_base(CONSTRAINT pk_NC_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.NC_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'NC', c.name,p.name,'37'  FROM tiger_data.NC_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '37') INNER JOIN tiger_data.NC_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.NC_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.NC_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '37');"
%PSQL% -c "CREATE INDEX idx_tiger_data_NC_zip_lookup_base_citysnd ON tiger_data.NC_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_37037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37193_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37189_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37185_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37187_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37195_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37177_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37179_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37199_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37197_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37191_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37183_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37181_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_37047_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_37*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.NC_addr(CONSTRAINT pk_NC_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.NC_addr ALTER COLUMN statefp SET DEFAULT '37';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.NC_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('NC_addr'), lower('NC_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.NC_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '37');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NC_addr_least_address ON tiger_data.NC_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NC_addr_tlid_statefp ON tiger_data.NC_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_NC_addr_zip ON tiger_data.NC_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.NC_zip_state(CONSTRAINT pk_NC_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.NC_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'NC', '37' FROM tiger_data.NC_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.NC_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '37');"
	%PSQL% -c "vacuum analyze tiger_data.NC_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_38_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_38*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ND_place(CONSTRAINT pk_ND_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_38_place.dbf tiger_staging.nd_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.ND_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('ND_place'), lower('ND_place')); ALTER TABLE tiger_data.ND_place ADD CONSTRAINT uidx_ND_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_ND_place_soundex_name ON tiger_data.ND_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_ND_place_the_geom_gist ON tiger_data.ND_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.ND_place ADD CONSTRAINT chk_statefp CHECK (statefp = '38');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_38_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_38*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ND_cousub(CONSTRAINT pk_ND_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_ND_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_38_cousub.dbf tiger_staging.nd_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.ND_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('ND_cousub'), lower('ND_cousub')); ALTER TABLE tiger_data.ND_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '38');"
%PSQL% -c "CREATE INDEX tiger_data_ND_cousub_the_geom_gist ON tiger_data.ND_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ND_cousub_countyfp ON tiger_data.ND_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_38_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_38*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ND_tract(CONSTRAINT pk_ND_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_38_tract.dbf tiger_staging.nd_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.ND_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('ND_tract'), lower('ND_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_ND_tract_the_geom_gist ON tiger_data.ND_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.ND_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.ND_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '38');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_38099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_38041_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_38*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ND_faces(CONSTRAINT pk_ND_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.ND_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('ND_faces'), lower('ND_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_ND_faces_the_geom_gist ON tiger_data.ND_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ND_faces_tfid ON tiger_data.ND_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ND_faces_countyfp ON tiger_data.ND_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.ND_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '38');"
	%PSQL% -c "vacuum analyze tiger_data.ND_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_38099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_38041_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_38*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ND_featnames(CONSTRAINT pk_ND_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.ND_featnames ALTER COLUMN statefp SET DEFAULT '38';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.ND_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('ND_featnames'), lower('ND_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_ND_featnames_snd_name ON tiger_data.ND_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_ND_featnames_lname ON tiger_data.ND_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_ND_featnames_tlid_statefp ON tiger_data.ND_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.ND_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '38');"
%PSQL% -c "vacuum analyze tiger_data.ND_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_38099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_38041_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_38*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ND_edges(CONSTRAINT pk_ND_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.ND_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('ND_edges'), lower('ND_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.ND_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '38');"
%PSQL% -c "CREATE INDEX idx_tiger_data_ND_edges_tlid ON tiger_data.ND_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ND_edgestfidr ON tiger_data.ND_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ND_edges_tfidl ON tiger_data.ND_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ND_edges_countyfp ON tiger_data.ND_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_ND_edges_the_geom_gist ON tiger_data.ND_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_ND_edges_zipl ON tiger_data.ND_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.ND_zip_state_loc(CONSTRAINT pk_ND_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.ND_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'ND', '38', p.name FROM tiger_data.ND_edges AS e INNER JOIN tiger_data.ND_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.ND_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_ND_zip_state_loc_place ON tiger_data.ND_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.ND_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '38');"
%PSQL% -c "vacuum analyze tiger_data.ND_edges;"
%PSQL% -c "vacuum analyze tiger_data.ND_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.ND_zip_lookup_base(CONSTRAINT pk_ND_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.ND_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'ND', c.name,p.name,'38'  FROM tiger_data.ND_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '38') INNER JOIN tiger_data.ND_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.ND_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.ND_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '38');"
%PSQL% -c "CREATE INDEX idx_tiger_data_ND_zip_lookup_base_citysnd ON tiger_data.ND_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_38099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_38041_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_38*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.ND_addr(CONSTRAINT pk_ND_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.ND_addr ALTER COLUMN statefp SET DEFAULT '38';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.ND_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('ND_addr'), lower('ND_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.ND_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '38');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ND_addr_least_address ON tiger_data.ND_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ND_addr_tlid_statefp ON tiger_data.ND_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_ND_addr_zip ON tiger_data.ND_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.ND_zip_state(CONSTRAINT pk_ND_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.ND_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'ND', '38' FROM tiger_data.ND_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.ND_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '38');"
	%PSQL% -c "vacuum analyze tiger_data.ND_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_69_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_69*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MP_place(CONSTRAINT pk_MP_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_69_place.dbf tiger_staging.mp_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MP_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('MP_place'), lower('MP_place')); ALTER TABLE tiger_data.MP_place ADD CONSTRAINT uidx_MP_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_MP_place_soundex_name ON tiger_data.MP_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_MP_place_the_geom_gist ON tiger_data.MP_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.MP_place ADD CONSTRAINT chk_statefp CHECK (statefp = '69');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_69_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_69*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MP_cousub(CONSTRAINT pk_MP_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_MP_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_69_cousub.dbf tiger_staging.mp_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MP_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('MP_cousub'), lower('MP_cousub')); ALTER TABLE tiger_data.MP_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '69');"
%PSQL% -c "CREATE INDEX tiger_data_MP_cousub_the_geom_gist ON tiger_data.MP_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MP_cousub_countyfp ON tiger_data.MP_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_69_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_69*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MP_tract(CONSTRAINT pk_MP_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_69_tract.dbf tiger_staging.mp_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.MP_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('MP_tract'), lower('MP_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_MP_tract_the_geom_gist ON tiger_data.MP_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.MP_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.MP_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '69');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_69100_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_69120_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_69085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_69110_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_69*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MP_faces(CONSTRAINT pk_MP_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MP_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MP_faces'), lower('MP_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_MP_faces_the_geom_gist ON tiger_data.MP_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MP_faces_tfid ON tiger_data.MP_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MP_faces_countyfp ON tiger_data.MP_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.MP_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '69');"
	%PSQL% -c "vacuum analyze tiger_data.MP_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_69100_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_69120_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_69085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_69110_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_69*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MP_featnames(CONSTRAINT pk_MP_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.MP_featnames ALTER COLUMN statefp SET DEFAULT '69';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MP_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MP_featnames'), lower('MP_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_MP_featnames_snd_name ON tiger_data.MP_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MP_featnames_lname ON tiger_data.MP_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_MP_featnames_tlid_statefp ON tiger_data.MP_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.MP_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '69');"
%PSQL% -c "vacuum analyze tiger_data.MP_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_69100_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_69120_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_69085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_69110_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_69*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MP_edges(CONSTRAINT pk_MP_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MP_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MP_edges'), lower('MP_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.MP_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '69');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MP_edges_tlid ON tiger_data.MP_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MP_edgestfidr ON tiger_data.MP_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MP_edges_tfidl ON tiger_data.MP_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MP_edges_countyfp ON tiger_data.MP_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_MP_edges_the_geom_gist ON tiger_data.MP_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_MP_edges_zipl ON tiger_data.MP_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.MP_zip_state_loc(CONSTRAINT pk_MP_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.MP_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'MP', '69', p.name FROM tiger_data.MP_edges AS e INNER JOIN tiger_data.MP_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MP_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_MP_zip_state_loc_place ON tiger_data.MP_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.MP_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '69');"
%PSQL% -c "vacuum analyze tiger_data.MP_edges;"
%PSQL% -c "vacuum analyze tiger_data.MP_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.MP_zip_lookup_base(CONSTRAINT pk_MP_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.MP_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'MP', c.name,p.name,'69'  FROM tiger_data.MP_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '69') INNER JOIN tiger_data.MP_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.MP_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.MP_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '69');"
%PSQL% -c "CREATE INDEX idx_tiger_data_MP_zip_lookup_base_citysnd ON tiger_data.MP_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_69100_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_69120_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_69085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_69110_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_69*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.MP_addr(CONSTRAINT pk_MP_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.MP_addr ALTER COLUMN statefp SET DEFAULT '69';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.MP_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('MP_addr'), lower('MP_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.MP_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '69');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MP_addr_least_address ON tiger_data.MP_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MP_addr_tlid_statefp ON tiger_data.MP_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_MP_addr_zip ON tiger_data.MP_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.MP_zip_state(CONSTRAINT pk_MP_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.MP_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'MP', '69' FROM tiger_data.MP_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.MP_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '69');"
	%PSQL% -c "vacuum analyze tiger_data.MP_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_39_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_39*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OH_place(CONSTRAINT pk_OH_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_39_place.dbf tiger_staging.oh_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.OH_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('OH_place'), lower('OH_place')); ALTER TABLE tiger_data.OH_place ADD CONSTRAINT uidx_OH_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_OH_place_soundex_name ON tiger_data.OH_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_OH_place_the_geom_gist ON tiger_data.OH_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.OH_place ADD CONSTRAINT chk_statefp CHECK (statefp = '39');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_39_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_39*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OH_cousub(CONSTRAINT pk_OH_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_OH_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_39_cousub.dbf tiger_staging.oh_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.OH_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('OH_cousub'), lower('OH_cousub')); ALTER TABLE tiger_data.OH_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '39');"
%PSQL% -c "CREATE INDEX tiger_data_OH_cousub_the_geom_gist ON tiger_data.OH_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OH_cousub_countyfp ON tiger_data.OH_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_39_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_39*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OH_tract(CONSTRAINT pk_OH_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_39_tract.dbf tiger_staging.oh_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.OH_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('OH_tract'), lower('OH_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_OH_tract_the_geom_gist ON tiger_data.OH_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.OH_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.OH_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '39');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_39063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_39107_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_39*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OH_faces(CONSTRAINT pk_OH_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.OH_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('OH_faces'), lower('OH_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_OH_faces_the_geom_gist ON tiger_data.OH_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OH_faces_tfid ON tiger_data.OH_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OH_faces_countyfp ON tiger_data.OH_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.OH_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '39');"
	%PSQL% -c "vacuum analyze tiger_data.OH_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_39063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_39107_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_39*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OH_featnames(CONSTRAINT pk_OH_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.OH_featnames ALTER COLUMN statefp SET DEFAULT '39';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.OH_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('OH_featnames'), lower('OH_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_OH_featnames_snd_name ON tiger_data.OH_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_OH_featnames_lname ON tiger_data.OH_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_OH_featnames_tlid_statefp ON tiger_data.OH_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.OH_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '39');"
%PSQL% -c "vacuum analyze tiger_data.OH_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_39063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_39107_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_39*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OH_edges(CONSTRAINT pk_OH_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.OH_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('OH_edges'), lower('OH_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.OH_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '39');"
%PSQL% -c "CREATE INDEX idx_tiger_data_OH_edges_tlid ON tiger_data.OH_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OH_edgestfidr ON tiger_data.OH_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OH_edges_tfidl ON tiger_data.OH_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OH_edges_countyfp ON tiger_data.OH_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_OH_edges_the_geom_gist ON tiger_data.OH_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OH_edges_zipl ON tiger_data.OH_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.OH_zip_state_loc(CONSTRAINT pk_OH_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.OH_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'OH', '39', p.name FROM tiger_data.OH_edges AS e INNER JOIN tiger_data.OH_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.OH_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_OH_zip_state_loc_place ON tiger_data.OH_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.OH_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '39');"
%PSQL% -c "vacuum analyze tiger_data.OH_edges;"
%PSQL% -c "vacuum analyze tiger_data.OH_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.OH_zip_lookup_base(CONSTRAINT pk_OH_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.OH_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'OH', c.name,p.name,'39'  FROM tiger_data.OH_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '39') INNER JOIN tiger_data.OH_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.OH_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.OH_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '39');"
%PSQL% -c "CREATE INDEX idx_tiger_data_OH_zip_lookup_base_citysnd ON tiger_data.OH_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_39063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_39107_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_39*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OH_addr(CONSTRAINT pk_OH_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.OH_addr ALTER COLUMN statefp SET DEFAULT '39';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.OH_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('OH_addr'), lower('OH_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.OH_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '39');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OH_addr_least_address ON tiger_data.OH_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OH_addr_tlid_statefp ON tiger_data.OH_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OH_addr_zip ON tiger_data.OH_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.OH_zip_state(CONSTRAINT pk_OH_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.OH_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'OH', '39' FROM tiger_data.OH_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.OH_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '39');"
	%PSQL% -c "vacuum analyze tiger_data.OH_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_40_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_40*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OK_place(CONSTRAINT pk_OK_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_40_place.dbf tiger_staging.ok_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.OK_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('OK_place'), lower('OK_place')); ALTER TABLE tiger_data.OK_place ADD CONSTRAINT uidx_OK_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_OK_place_soundex_name ON tiger_data.OK_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_OK_place_the_geom_gist ON tiger_data.OK_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.OK_place ADD CONSTRAINT chk_statefp CHECK (statefp = '40');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_40_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_40*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OK_cousub(CONSTRAINT pk_OK_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_OK_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_40_cousub.dbf tiger_staging.ok_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.OK_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('OK_cousub'), lower('OK_cousub')); ALTER TABLE tiger_data.OK_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '40');"
%PSQL% -c "CREATE INDEX tiger_data_OK_cousub_the_geom_gist ON tiger_data.OK_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OK_cousub_countyfp ON tiger_data.OK_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_40_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_40*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OK_tract(CONSTRAINT pk_OK_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_40_tract.dbf tiger_staging.ok_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.OK_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('OK_tract'), lower('OK_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_OK_tract_the_geom_gist ON tiger_data.OK_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.OK_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.OK_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '40');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_40001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_40047_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_40*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OK_faces(CONSTRAINT pk_OK_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.OK_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('OK_faces'), lower('OK_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_OK_faces_the_geom_gist ON tiger_data.OK_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OK_faces_tfid ON tiger_data.OK_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OK_faces_countyfp ON tiger_data.OK_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.OK_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '40');"
	%PSQL% -c "vacuum analyze tiger_data.OK_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_40001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_40047_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_40*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OK_featnames(CONSTRAINT pk_OK_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.OK_featnames ALTER COLUMN statefp SET DEFAULT '40';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.OK_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('OK_featnames'), lower('OK_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_OK_featnames_snd_name ON tiger_data.OK_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_OK_featnames_lname ON tiger_data.OK_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_OK_featnames_tlid_statefp ON tiger_data.OK_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.OK_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '40');"
%PSQL% -c "vacuum analyze tiger_data.OK_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_40001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_40047_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_40*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OK_edges(CONSTRAINT pk_OK_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.OK_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('OK_edges'), lower('OK_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.OK_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '40');"
%PSQL% -c "CREATE INDEX idx_tiger_data_OK_edges_tlid ON tiger_data.OK_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OK_edgestfidr ON tiger_data.OK_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OK_edges_tfidl ON tiger_data.OK_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OK_edges_countyfp ON tiger_data.OK_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_OK_edges_the_geom_gist ON tiger_data.OK_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OK_edges_zipl ON tiger_data.OK_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.OK_zip_state_loc(CONSTRAINT pk_OK_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.OK_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'OK', '40', p.name FROM tiger_data.OK_edges AS e INNER JOIN tiger_data.OK_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.OK_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_OK_zip_state_loc_place ON tiger_data.OK_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.OK_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '40');"
%PSQL% -c "vacuum analyze tiger_data.OK_edges;"
%PSQL% -c "vacuum analyze tiger_data.OK_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.OK_zip_lookup_base(CONSTRAINT pk_OK_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.OK_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'OK', c.name,p.name,'40'  FROM tiger_data.OK_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '40') INNER JOIN tiger_data.OK_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.OK_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.OK_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '40');"
%PSQL% -c "CREATE INDEX idx_tiger_data_OK_zip_lookup_base_citysnd ON tiger_data.OK_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_40001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_40047_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_40*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OK_addr(CONSTRAINT pk_OK_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.OK_addr ALTER COLUMN statefp SET DEFAULT '40';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.OK_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('OK_addr'), lower('OK_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.OK_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '40');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OK_addr_least_address ON tiger_data.OK_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OK_addr_tlid_statefp ON tiger_data.OK_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OK_addr_zip ON tiger_data.OK_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.OK_zip_state(CONSTRAINT pk_OK_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.OK_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'OK', '40' FROM tiger_data.OK_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.OK_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '40');"
	%PSQL% -c "vacuum analyze tiger_data.OK_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_41_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_41*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OR_place(CONSTRAINT pk_OR_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_41_place.dbf tiger_staging.or_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.OR_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('OR_place'), lower('OR_place')); ALTER TABLE tiger_data.OR_place ADD CONSTRAINT uidx_OR_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_OR_place_soundex_name ON tiger_data.OR_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_OR_place_the_geom_gist ON tiger_data.OR_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.OR_place ADD CONSTRAINT chk_statefp CHECK (statefp = '41');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_41_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_41*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OR_cousub(CONSTRAINT pk_OR_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_OR_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_41_cousub.dbf tiger_staging.or_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.OR_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('OR_cousub'), lower('OR_cousub')); ALTER TABLE tiger_data.OR_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '41');"
%PSQL% -c "CREATE INDEX tiger_data_OR_cousub_the_geom_gist ON tiger_data.OR_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OR_cousub_countyfp ON tiger_data.OR_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_41_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_41*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OR_tract(CONSTRAINT pk_OR_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_41_tract.dbf tiger_staging.or_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.OR_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('OR_tract'), lower('OR_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_OR_tract_the_geom_gist ON tiger_data.OR_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.OR_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.OR_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '41');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_41063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_41067_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_41*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OR_faces(CONSTRAINT pk_OR_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.OR_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('OR_faces'), lower('OR_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_OR_faces_the_geom_gist ON tiger_data.OR_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OR_faces_tfid ON tiger_data.OR_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OR_faces_countyfp ON tiger_data.OR_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.OR_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '41');"
	%PSQL% -c "vacuum analyze tiger_data.OR_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_41063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_41067_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_41*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OR_featnames(CONSTRAINT pk_OR_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.OR_featnames ALTER COLUMN statefp SET DEFAULT '41';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.OR_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('OR_featnames'), lower('OR_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_OR_featnames_snd_name ON tiger_data.OR_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_OR_featnames_lname ON tiger_data.OR_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_OR_featnames_tlid_statefp ON tiger_data.OR_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.OR_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '41');"
%PSQL% -c "vacuum analyze tiger_data.OR_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_41063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_41067_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_41*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OR_edges(CONSTRAINT pk_OR_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.OR_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('OR_edges'), lower('OR_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.OR_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '41');"
%PSQL% -c "CREATE INDEX idx_tiger_data_OR_edges_tlid ON tiger_data.OR_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OR_edgestfidr ON tiger_data.OR_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OR_edges_tfidl ON tiger_data.OR_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OR_edges_countyfp ON tiger_data.OR_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_OR_edges_the_geom_gist ON tiger_data.OR_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_OR_edges_zipl ON tiger_data.OR_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.OR_zip_state_loc(CONSTRAINT pk_OR_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.OR_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'OR', '41', p.name FROM tiger_data.OR_edges AS e INNER JOIN tiger_data.OR_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.OR_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_OR_zip_state_loc_place ON tiger_data.OR_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.OR_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '41');"
%PSQL% -c "vacuum analyze tiger_data.OR_edges;"
%PSQL% -c "vacuum analyze tiger_data.OR_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.OR_zip_lookup_base(CONSTRAINT pk_OR_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.OR_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'OR', c.name,p.name,'41'  FROM tiger_data.OR_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '41') INNER JOIN tiger_data.OR_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.OR_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.OR_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '41');"
%PSQL% -c "CREATE INDEX idx_tiger_data_OR_zip_lookup_base_citysnd ON tiger_data.OR_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_41063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_41067_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_41*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.OR_addr(CONSTRAINT pk_OR_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.OR_addr ALTER COLUMN statefp SET DEFAULT '41';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.OR_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('OR_addr'), lower('OR_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.OR_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '41');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OR_addr_least_address ON tiger_data.OR_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OR_addr_tlid_statefp ON tiger_data.OR_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_OR_addr_zip ON tiger_data.OR_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.OR_zip_state(CONSTRAINT pk_OR_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.OR_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'OR', '41' FROM tiger_data.OR_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.OR_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '41');"
	%PSQL% -c "vacuum analyze tiger_data.OR_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_42_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_42*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PA_place(CONSTRAINT pk_PA_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_42_place.dbf tiger_staging.pa_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.PA_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('PA_place'), lower('PA_place')); ALTER TABLE tiger_data.PA_place ADD CONSTRAINT uidx_PA_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_PA_place_soundex_name ON tiger_data.PA_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_PA_place_the_geom_gist ON tiger_data.PA_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.PA_place ADD CONSTRAINT chk_statefp CHECK (statefp = '42');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_42_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_42*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PA_cousub(CONSTRAINT pk_PA_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_PA_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_42_cousub.dbf tiger_staging.pa_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.PA_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('PA_cousub'), lower('PA_cousub')); ALTER TABLE tiger_data.PA_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '42');"
%PSQL% -c "CREATE INDEX tiger_data_PA_cousub_the_geom_gist ON tiger_data.PA_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_PA_cousub_countyfp ON tiger_data.PA_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_42_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_42*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PA_tract(CONSTRAINT pk_PA_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_42_tract.dbf tiger_staging.pa_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.PA_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('PA_tract'), lower('PA_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_PA_tract_the_geom_gist ON tiger_data.PA_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.PA_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.PA_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '42');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_42007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_42129_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_42*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PA_faces(CONSTRAINT pk_PA_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.PA_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('PA_faces'), lower('PA_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_PA_faces_the_geom_gist ON tiger_data.PA_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_PA_faces_tfid ON tiger_data.PA_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_PA_faces_countyfp ON tiger_data.PA_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.PA_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '42');"
	%PSQL% -c "vacuum analyze tiger_data.PA_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_42007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_42129_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_42*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PA_featnames(CONSTRAINT pk_PA_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.PA_featnames ALTER COLUMN statefp SET DEFAULT '42';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.PA_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('PA_featnames'), lower('PA_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_PA_featnames_snd_name ON tiger_data.PA_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_PA_featnames_lname ON tiger_data.PA_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_PA_featnames_tlid_statefp ON tiger_data.PA_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.PA_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '42');"
%PSQL% -c "vacuum analyze tiger_data.PA_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_42007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_42129_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_42*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PA_edges(CONSTRAINT pk_PA_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.PA_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('PA_edges'), lower('PA_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.PA_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '42');"
%PSQL% -c "CREATE INDEX idx_tiger_data_PA_edges_tlid ON tiger_data.PA_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_PA_edgestfidr ON tiger_data.PA_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_PA_edges_tfidl ON tiger_data.PA_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_PA_edges_countyfp ON tiger_data.PA_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_PA_edges_the_geom_gist ON tiger_data.PA_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_PA_edges_zipl ON tiger_data.PA_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.PA_zip_state_loc(CONSTRAINT pk_PA_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.PA_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'PA', '42', p.name FROM tiger_data.PA_edges AS e INNER JOIN tiger_data.PA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.PA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_PA_zip_state_loc_place ON tiger_data.PA_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.PA_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '42');"
%PSQL% -c "vacuum analyze tiger_data.PA_edges;"
%PSQL% -c "vacuum analyze tiger_data.PA_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.PA_zip_lookup_base(CONSTRAINT pk_PA_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.PA_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'PA', c.name,p.name,'42'  FROM tiger_data.PA_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '42') INNER JOIN tiger_data.PA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.PA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.PA_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '42');"
%PSQL% -c "CREATE INDEX idx_tiger_data_PA_zip_lookup_base_citysnd ON tiger_data.PA_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_42007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_42129_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_42*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PA_addr(CONSTRAINT pk_PA_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.PA_addr ALTER COLUMN statefp SET DEFAULT '42';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.PA_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('PA_addr'), lower('PA_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.PA_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '42');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_PA_addr_least_address ON tiger_data.PA_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_PA_addr_tlid_statefp ON tiger_data.PA_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_PA_addr_zip ON tiger_data.PA_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.PA_zip_state(CONSTRAINT pk_PA_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.PA_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'PA', '42' FROM tiger_data.PA_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.PA_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '42');"
	%PSQL% -c "vacuum analyze tiger_data.PA_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_72_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_72*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PR_place(CONSTRAINT pk_PR_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_72_place.dbf tiger_staging.pr_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.PR_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('PR_place'), lower('PR_place')); ALTER TABLE tiger_data.PR_place ADD CONSTRAINT uidx_PR_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_PR_place_soundex_name ON tiger_data.PR_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_PR_place_the_geom_gist ON tiger_data.PR_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.PR_place ADD CONSTRAINT chk_statefp CHECK (statefp = '72');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_72_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_72*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PR_cousub(CONSTRAINT pk_PR_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_PR_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_72_cousub.dbf tiger_staging.pr_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.PR_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('PR_cousub'), lower('PR_cousub')); ALTER TABLE tiger_data.PR_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '72');"
%PSQL% -c "CREATE INDEX tiger_data_PR_cousub_the_geom_gist ON tiger_data.PR_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_PR_cousub_countyfp ON tiger_data.PR_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_72_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_72*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PR_tract(CONSTRAINT pk_PR_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_72_tract.dbf tiger_staging.pr_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.PR_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('PR_tract'), lower('PR_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_PR_tract_the_geom_gist ON tiger_data.PR_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.PR_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.PR_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '72');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_72085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72054_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_72089_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_72*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PR_faces(CONSTRAINT pk_PR_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.PR_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('PR_faces'), lower('PR_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_PR_faces_the_geom_gist ON tiger_data.PR_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_PR_faces_tfid ON tiger_data.PR_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_PR_faces_countyfp ON tiger_data.PR_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.PR_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '72');"
	%PSQL% -c "vacuum analyze tiger_data.PR_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_72085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72054_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_72089_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_72*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PR_featnames(CONSTRAINT pk_PR_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.PR_featnames ALTER COLUMN statefp SET DEFAULT '72';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.PR_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('PR_featnames'), lower('PR_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_PR_featnames_snd_name ON tiger_data.PR_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_PR_featnames_lname ON tiger_data.PR_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_PR_featnames_tlid_statefp ON tiger_data.PR_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.PR_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '72');"
%PSQL% -c "vacuum analyze tiger_data.PR_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_72085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72054_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_72089_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_72*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PR_edges(CONSTRAINT pk_PR_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.PR_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('PR_edges'), lower('PR_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.PR_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '72');"
%PSQL% -c "CREATE INDEX idx_tiger_data_PR_edges_tlid ON tiger_data.PR_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_PR_edgestfidr ON tiger_data.PR_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_PR_edges_tfidl ON tiger_data.PR_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_PR_edges_countyfp ON tiger_data.PR_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_PR_edges_the_geom_gist ON tiger_data.PR_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_PR_edges_zipl ON tiger_data.PR_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.PR_zip_state_loc(CONSTRAINT pk_PR_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.PR_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'PR', '72', p.name FROM tiger_data.PR_edges AS e INNER JOIN tiger_data.PR_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.PR_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_PR_zip_state_loc_place ON tiger_data.PR_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.PR_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '72');"
%PSQL% -c "vacuum analyze tiger_data.PR_edges;"
%PSQL% -c "vacuum analyze tiger_data.PR_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.PR_zip_lookup_base(CONSTRAINT pk_PR_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.PR_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'PR', c.name,p.name,'72'  FROM tiger_data.PR_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '72') INNER JOIN tiger_data.PR_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.PR_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.PR_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '72');"
%PSQL% -c "CREATE INDEX idx_tiger_data_PR_zip_lookup_base_citysnd ON tiger_data.PR_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_72085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72054_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_72089_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_72*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.PR_addr(CONSTRAINT pk_PR_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.PR_addr ALTER COLUMN statefp SET DEFAULT '72';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.PR_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('PR_addr'), lower('PR_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.PR_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '72');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_PR_addr_least_address ON tiger_data.PR_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_PR_addr_tlid_statefp ON tiger_data.PR_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_PR_addr_zip ON tiger_data.PR_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.PR_zip_state(CONSTRAINT pk_PR_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.PR_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'PR', '72' FROM tiger_data.PR_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.PR_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '72');"
	%PSQL% -c "vacuum analyze tiger_data.PR_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_44_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_44*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.RI_place(CONSTRAINT pk_RI_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_44_place.dbf tiger_staging.ri_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.RI_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('RI_place'), lower('RI_place')); ALTER TABLE tiger_data.RI_place ADD CONSTRAINT uidx_RI_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_RI_place_soundex_name ON tiger_data.RI_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_RI_place_the_geom_gist ON tiger_data.RI_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.RI_place ADD CONSTRAINT chk_statefp CHECK (statefp = '44');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_44_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_44*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.RI_cousub(CONSTRAINT pk_RI_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_RI_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_44_cousub.dbf tiger_staging.ri_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.RI_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('RI_cousub'), lower('RI_cousub')); ALTER TABLE tiger_data.RI_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '44');"
%PSQL% -c "CREATE INDEX tiger_data_RI_cousub_the_geom_gist ON tiger_data.RI_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_RI_cousub_countyfp ON tiger_data.RI_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_44_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_44*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.RI_tract(CONSTRAINT pk_RI_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_44_tract.dbf tiger_staging.ri_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.RI_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('RI_tract'), lower('RI_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_RI_tract_the_geom_gist ON tiger_data.RI_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.RI_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.RI_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '44');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_44009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_44007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_44001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_44005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_44003_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_44*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.RI_faces(CONSTRAINT pk_RI_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.RI_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('RI_faces'), lower('RI_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_RI_faces_the_geom_gist ON tiger_data.RI_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_RI_faces_tfid ON tiger_data.RI_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_RI_faces_countyfp ON tiger_data.RI_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.RI_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '44');"
	%PSQL% -c "vacuum analyze tiger_data.RI_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_44009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_44007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_44001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_44005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_44003_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_44*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.RI_featnames(CONSTRAINT pk_RI_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.RI_featnames ALTER COLUMN statefp SET DEFAULT '44';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.RI_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('RI_featnames'), lower('RI_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_RI_featnames_snd_name ON tiger_data.RI_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_RI_featnames_lname ON tiger_data.RI_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_RI_featnames_tlid_statefp ON tiger_data.RI_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.RI_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '44');"
%PSQL% -c "vacuum analyze tiger_data.RI_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_44009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_44007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_44001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_44005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_44003_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_44*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.RI_edges(CONSTRAINT pk_RI_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.RI_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('RI_edges'), lower('RI_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.RI_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '44');"
%PSQL% -c "CREATE INDEX idx_tiger_data_RI_edges_tlid ON tiger_data.RI_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_RI_edgestfidr ON tiger_data.RI_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_RI_edges_tfidl ON tiger_data.RI_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_RI_edges_countyfp ON tiger_data.RI_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_RI_edges_the_geom_gist ON tiger_data.RI_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_RI_edges_zipl ON tiger_data.RI_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.RI_zip_state_loc(CONSTRAINT pk_RI_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.RI_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'RI', '44', p.name FROM tiger_data.RI_edges AS e INNER JOIN tiger_data.RI_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.RI_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_RI_zip_state_loc_place ON tiger_data.RI_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.RI_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '44');"
%PSQL% -c "vacuum analyze tiger_data.RI_edges;"
%PSQL% -c "vacuum analyze tiger_data.RI_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.RI_zip_lookup_base(CONSTRAINT pk_RI_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.RI_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'RI', c.name,p.name,'44'  FROM tiger_data.RI_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '44') INNER JOIN tiger_data.RI_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.RI_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.RI_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '44');"
%PSQL% -c "CREATE INDEX idx_tiger_data_RI_zip_lookup_base_citysnd ON tiger_data.RI_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_44009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_44007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_44001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_44005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_44003_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_44*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.RI_addr(CONSTRAINT pk_RI_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.RI_addr ALTER COLUMN statefp SET DEFAULT '44';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.RI_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('RI_addr'), lower('RI_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.RI_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '44');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_RI_addr_least_address ON tiger_data.RI_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_RI_addr_tlid_statefp ON tiger_data.RI_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_RI_addr_zip ON tiger_data.RI_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.RI_zip_state(CONSTRAINT pk_RI_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.RI_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'RI', '44' FROM tiger_data.RI_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.RI_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '44');"
	%PSQL% -c "vacuum analyze tiger_data.RI_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_45_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_45*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SC_place(CONSTRAINT pk_SC_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_45_place.dbf tiger_staging.sc_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.SC_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('SC_place'), lower('SC_place')); ALTER TABLE tiger_data.SC_place ADD CONSTRAINT uidx_SC_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_SC_place_soundex_name ON tiger_data.SC_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_SC_place_the_geom_gist ON tiger_data.SC_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.SC_place ADD CONSTRAINT chk_statefp CHECK (statefp = '45');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_45_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_45*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SC_cousub(CONSTRAINT pk_SC_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_SC_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_45_cousub.dbf tiger_staging.sc_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.SC_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('SC_cousub'), lower('SC_cousub')); ALTER TABLE tiger_data.SC_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '45');"
%PSQL% -c "CREATE INDEX tiger_data_SC_cousub_the_geom_gist ON tiger_data.SC_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_SC_cousub_countyfp ON tiger_data.SC_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_45_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_45*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SC_tract(CONSTRAINT pk_SC_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_45_tract.dbf tiger_staging.sc_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.SC_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('SC_tract'), lower('SC_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_SC_tract_the_geom_gist ON tiger_data.SC_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.SC_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.SC_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '45');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_45023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_45025_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_45*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SC_faces(CONSTRAINT pk_SC_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.SC_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('SC_faces'), lower('SC_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_SC_faces_the_geom_gist ON tiger_data.SC_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_SC_faces_tfid ON tiger_data.SC_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_SC_faces_countyfp ON tiger_data.SC_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.SC_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '45');"
	%PSQL% -c "vacuum analyze tiger_data.SC_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_45023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_45025_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_45*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SC_featnames(CONSTRAINT pk_SC_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.SC_featnames ALTER COLUMN statefp SET DEFAULT '45';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.SC_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('SC_featnames'), lower('SC_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_SC_featnames_snd_name ON tiger_data.SC_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_SC_featnames_lname ON tiger_data.SC_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_SC_featnames_tlid_statefp ON tiger_data.SC_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.SC_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '45');"
%PSQL% -c "vacuum analyze tiger_data.SC_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_45023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_45025_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_45*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SC_edges(CONSTRAINT pk_SC_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.SC_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('SC_edges'), lower('SC_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.SC_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '45');"
%PSQL% -c "CREATE INDEX idx_tiger_data_SC_edges_tlid ON tiger_data.SC_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_SC_edgestfidr ON tiger_data.SC_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_SC_edges_tfidl ON tiger_data.SC_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_SC_edges_countyfp ON tiger_data.SC_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_SC_edges_the_geom_gist ON tiger_data.SC_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_SC_edges_zipl ON tiger_data.SC_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.SC_zip_state_loc(CONSTRAINT pk_SC_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.SC_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'SC', '45', p.name FROM tiger_data.SC_edges AS e INNER JOIN tiger_data.SC_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.SC_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_SC_zip_state_loc_place ON tiger_data.SC_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.SC_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '45');"
%PSQL% -c "vacuum analyze tiger_data.SC_edges;"
%PSQL% -c "vacuum analyze tiger_data.SC_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.SC_zip_lookup_base(CONSTRAINT pk_SC_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.SC_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'SC', c.name,p.name,'45'  FROM tiger_data.SC_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '45') INNER JOIN tiger_data.SC_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.SC_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.SC_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '45');"
%PSQL% -c "CREATE INDEX idx_tiger_data_SC_zip_lookup_base_citysnd ON tiger_data.SC_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_45023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_45025_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_45*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SC_addr(CONSTRAINT pk_SC_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.SC_addr ALTER COLUMN statefp SET DEFAULT '45';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.SC_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('SC_addr'), lower('SC_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.SC_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '45');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_SC_addr_least_address ON tiger_data.SC_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_SC_addr_tlid_statefp ON tiger_data.SC_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_SC_addr_zip ON tiger_data.SC_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.SC_zip_state(CONSTRAINT pk_SC_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.SC_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'SC', '45' FROM tiger_data.SC_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.SC_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '45');"
	%PSQL% -c "vacuum analyze tiger_data.SC_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_46_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_46*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SD_place(CONSTRAINT pk_SD_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_46_place.dbf tiger_staging.sd_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.SD_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('SD_place'), lower('SD_place')); ALTER TABLE tiger_data.SD_place ADD CONSTRAINT uidx_SD_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_SD_place_soundex_name ON tiger_data.SD_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_SD_place_the_geom_gist ON tiger_data.SD_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.SD_place ADD CONSTRAINT chk_statefp CHECK (statefp = '46');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_46_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_46*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SD_cousub(CONSTRAINT pk_SD_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_SD_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_46_cousub.dbf tiger_staging.sd_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.SD_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('SD_cousub'), lower('SD_cousub')); ALTER TABLE tiger_data.SD_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '46');"
%PSQL% -c "CREATE INDEX tiger_data_SD_cousub_the_geom_gist ON tiger_data.SD_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_SD_cousub_countyfp ON tiger_data.SD_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_46_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_46*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SD_tract(CONSTRAINT pk_SD_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_46_tract.dbf tiger_staging.sd_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.SD_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('SD_tract'), lower('SD_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_SD_tract_the_geom_gist ON tiger_data.SD_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.SD_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.SD_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '46');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_46099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46102_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_46091_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_46*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SD_faces(CONSTRAINT pk_SD_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.SD_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('SD_faces'), lower('SD_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_SD_faces_the_geom_gist ON tiger_data.SD_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_SD_faces_tfid ON tiger_data.SD_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_SD_faces_countyfp ON tiger_data.SD_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.SD_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '46');"
	%PSQL% -c "vacuum analyze tiger_data.SD_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_46099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46102_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_46091_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_46*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SD_featnames(CONSTRAINT pk_SD_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.SD_featnames ALTER COLUMN statefp SET DEFAULT '46';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.SD_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('SD_featnames'), lower('SD_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_SD_featnames_snd_name ON tiger_data.SD_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_SD_featnames_lname ON tiger_data.SD_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_SD_featnames_tlid_statefp ON tiger_data.SD_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.SD_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '46');"
%PSQL% -c "vacuum analyze tiger_data.SD_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_46099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46102_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_46091_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_46*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SD_edges(CONSTRAINT pk_SD_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.SD_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('SD_edges'), lower('SD_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.SD_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '46');"
%PSQL% -c "CREATE INDEX idx_tiger_data_SD_edges_tlid ON tiger_data.SD_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_SD_edgestfidr ON tiger_data.SD_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_SD_edges_tfidl ON tiger_data.SD_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_SD_edges_countyfp ON tiger_data.SD_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_SD_edges_the_geom_gist ON tiger_data.SD_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_SD_edges_zipl ON tiger_data.SD_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.SD_zip_state_loc(CONSTRAINT pk_SD_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.SD_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'SD', '46', p.name FROM tiger_data.SD_edges AS e INNER JOIN tiger_data.SD_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.SD_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_SD_zip_state_loc_place ON tiger_data.SD_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.SD_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '46');"
%PSQL% -c "vacuum analyze tiger_data.SD_edges;"
%PSQL% -c "vacuum analyze tiger_data.SD_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.SD_zip_lookup_base(CONSTRAINT pk_SD_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.SD_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'SD', c.name,p.name,'46'  FROM tiger_data.SD_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '46') INNER JOIN tiger_data.SD_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.SD_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.SD_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '46');"
%PSQL% -c "CREATE INDEX idx_tiger_data_SD_zip_lookup_base_citysnd ON tiger_data.SD_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_46099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46102_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_46091_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_46*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.SD_addr(CONSTRAINT pk_SD_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.SD_addr ALTER COLUMN statefp SET DEFAULT '46';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.SD_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('SD_addr'), lower('SD_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.SD_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '46');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_SD_addr_least_address ON tiger_data.SD_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_SD_addr_tlid_statefp ON tiger_data.SD_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_SD_addr_zip ON tiger_data.SD_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.SD_zip_state(CONSTRAINT pk_SD_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.SD_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'SD', '46' FROM tiger_data.SD_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.SD_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '46');"
	%PSQL% -c "vacuum analyze tiger_data.SD_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_47_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_47*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TN_place(CONSTRAINT pk_TN_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_47_place.dbf tiger_staging.tn_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.TN_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('TN_place'), lower('TN_place')); ALTER TABLE tiger_data.TN_place ADD CONSTRAINT uidx_TN_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_TN_place_soundex_name ON tiger_data.TN_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_TN_place_the_geom_gist ON tiger_data.TN_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.TN_place ADD CONSTRAINT chk_statefp CHECK (statefp = '47');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_47_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_47*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TN_cousub(CONSTRAINT pk_TN_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_TN_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_47_cousub.dbf tiger_staging.tn_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.TN_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('TN_cousub'), lower('TN_cousub')); ALTER TABLE tiger_data.TN_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '47');"
%PSQL% -c "CREATE INDEX tiger_data_TN_cousub_the_geom_gist ON tiger_data.TN_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_TN_cousub_countyfp ON tiger_data.TN_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_47_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_47*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TN_tract(CONSTRAINT pk_TN_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_47_tract.dbf tiger_staging.tn_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.TN_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('TN_tract'), lower('TN_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_TN_tract_the_geom_gist ON tiger_data.TN_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.TN_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.TN_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '47');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_47065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47185_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47177_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47179_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47181_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47187_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47189_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47183_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_47101_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_47*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TN_faces(CONSTRAINT pk_TN_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.TN_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('TN_faces'), lower('TN_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_TN_faces_the_geom_gist ON tiger_data.TN_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_TN_faces_tfid ON tiger_data.TN_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_TN_faces_countyfp ON tiger_data.TN_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.TN_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '47');"
	%PSQL% -c "vacuum analyze tiger_data.TN_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_47065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47185_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47177_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47179_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47181_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47187_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47189_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47183_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_47101_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_47*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TN_featnames(CONSTRAINT pk_TN_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.TN_featnames ALTER COLUMN statefp SET DEFAULT '47';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.TN_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('TN_featnames'), lower('TN_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_TN_featnames_snd_name ON tiger_data.TN_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_TN_featnames_lname ON tiger_data.TN_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_TN_featnames_tlid_statefp ON tiger_data.TN_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.TN_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '47');"
%PSQL% -c "vacuum analyze tiger_data.TN_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_47065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47185_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47177_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47179_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47181_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47187_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47189_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47183_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_47101_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_47*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TN_edges(CONSTRAINT pk_TN_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.TN_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('TN_edges'), lower('TN_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.TN_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '47');"
%PSQL% -c "CREATE INDEX idx_tiger_data_TN_edges_tlid ON tiger_data.TN_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_TN_edgestfidr ON tiger_data.TN_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_TN_edges_tfidl ON tiger_data.TN_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_TN_edges_countyfp ON tiger_data.TN_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_TN_edges_the_geom_gist ON tiger_data.TN_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_TN_edges_zipl ON tiger_data.TN_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.TN_zip_state_loc(CONSTRAINT pk_TN_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.TN_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'TN', '47', p.name FROM tiger_data.TN_edges AS e INNER JOIN tiger_data.TN_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.TN_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_TN_zip_state_loc_place ON tiger_data.TN_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.TN_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '47');"
%PSQL% -c "vacuum analyze tiger_data.TN_edges;"
%PSQL% -c "vacuum analyze tiger_data.TN_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.TN_zip_lookup_base(CONSTRAINT pk_TN_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.TN_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'TN', c.name,p.name,'47'  FROM tiger_data.TN_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '47') INNER JOIN tiger_data.TN_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.TN_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.TN_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '47');"
%PSQL% -c "CREATE INDEX idx_tiger_data_TN_zip_lookup_base_citysnd ON tiger_data.TN_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_47065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47185_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47177_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47179_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47181_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47187_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47189_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47183_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_47101_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_47*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TN_addr(CONSTRAINT pk_TN_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.TN_addr ALTER COLUMN statefp SET DEFAULT '47';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.TN_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('TN_addr'), lower('TN_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.TN_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '47');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_TN_addr_least_address ON tiger_data.TN_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_TN_addr_tlid_statefp ON tiger_data.TN_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_TN_addr_zip ON tiger_data.TN_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.TN_zip_state(CONSTRAINT pk_TN_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.TN_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'TN', '47' FROM tiger_data.TN_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.TN_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '47');"
	%PSQL% -c "vacuum analyze tiger_data.TN_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_48_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_48*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TX_place(CONSTRAINT pk_TX_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_48_place.dbf tiger_staging.tx_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.TX_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('TX_place'), lower('TX_place')); ALTER TABLE tiger_data.TX_place ADD CONSTRAINT uidx_TX_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_TX_place_soundex_name ON tiger_data.TX_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_TX_place_the_geom_gist ON tiger_data.TX_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.TX_place ADD CONSTRAINT chk_statefp CHECK (statefp = '48');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_48_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_48*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TX_cousub(CONSTRAINT pk_TX_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_TX_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_48_cousub.dbf tiger_staging.tx_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.TX_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('TX_cousub'), lower('TX_cousub')); ALTER TABLE tiger_data.TX_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '48');"
%PSQL% -c "CREATE INDEX tiger_data_TX_cousub_the_geom_gist ON tiger_data.TX_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_TX_cousub_countyfp ON tiger_data.TX_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_48_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_48*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TX_tract(CONSTRAINT pk_TX_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_48_tract.dbf tiger_staging.tx_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.TX_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('TX_tract'), lower('TX_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_TX_tract_the_geom_gist ON tiger_data.TX_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.TX_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.TX_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '48');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_48327_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48189_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48361_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48265_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48177_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48391_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48247_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48353_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48245_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48215_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48413_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48181_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48507_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48397_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48309_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48277_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48289_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48435_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48433_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48311_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48367_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48271_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48203_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48383_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48357_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48477_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48333_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48359_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48403_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48305_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48223_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48225_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48461_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48381_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48401_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48237_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48211_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48417_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48407_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48259_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48481_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48255_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48257_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48251_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48473_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48323_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48273_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48317_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48375_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48369_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48449_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48445_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48385_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48275_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48209_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48325_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48345_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48485_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48329_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48469_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48457_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48377_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48489_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48303_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48213_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48471_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48201_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48371_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48347_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48187_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48439_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48239_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48437_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48431_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48495_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48295_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48497_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48419_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48179_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48229_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48491_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48467_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48253_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48185_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48235_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48231_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48335_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48349_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48499_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48243_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48337_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48207_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48151_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48373_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48503_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48287_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48191_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48221_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48405_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48313_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48331_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48389_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48355_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48399_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48443_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48315_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48291_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48241_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48195_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48199_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48447_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48415_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48293_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48387_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48321_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48197_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48363_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48297_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48421_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48463_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48493_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48427_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48267_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48307_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48217_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48263_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48301_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48279_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48233_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48283_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48465_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48423_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48395_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48451_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48501_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48261_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48411_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48269_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48425_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48455_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48183_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48475_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48487_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48193_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48429_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48285_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48393_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48379_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48343_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48281_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48459_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48483_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48409_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48479_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48341_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48351_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48219_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48365_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48339_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48299_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48319_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48441_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48227_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48205_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48249_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48505_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_48453_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_48*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TX_faces(CONSTRAINT pk_TX_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.TX_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('TX_faces'), lower('TX_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_TX_faces_the_geom_gist ON tiger_data.TX_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_TX_faces_tfid ON tiger_data.TX_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_TX_faces_countyfp ON tiger_data.TX_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.TX_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '48');"
	%PSQL% -c "vacuum analyze tiger_data.TX_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_48327_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48189_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48361_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48265_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48177_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48391_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48247_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48353_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48245_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48215_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48413_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48181_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48507_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48397_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48309_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48277_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48289_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48435_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48433_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48311_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48367_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48271_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48203_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48383_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48357_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48477_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48333_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48359_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48403_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48305_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48223_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48225_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48461_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48381_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48401_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48237_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48211_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48417_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48407_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48259_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48481_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48255_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48257_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48251_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48473_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48323_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48273_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48317_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48375_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48369_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48449_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48445_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48385_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48275_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48209_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48325_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48345_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48485_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48329_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48469_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48457_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48377_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48489_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48303_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48213_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48471_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48201_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48371_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48347_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48187_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48439_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48239_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48437_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48431_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48495_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48295_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48497_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48419_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48179_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48229_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48491_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48467_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48253_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48185_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48235_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48231_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48335_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48349_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48499_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48243_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48337_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48207_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48151_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48373_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48503_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48287_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48191_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48221_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48405_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48313_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48331_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48389_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48355_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48399_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48443_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48315_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48291_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48241_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48195_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48199_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48447_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48415_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48293_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48387_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48321_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48197_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48363_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48297_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48421_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48463_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48493_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48427_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48267_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48307_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48217_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48263_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48301_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48279_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48233_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48283_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48465_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48423_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48395_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48451_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48501_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48261_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48411_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48269_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48425_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48455_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48183_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48475_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48487_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48193_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48429_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48285_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48393_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48379_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48343_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48281_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48459_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48483_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48409_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48479_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48341_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48351_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48219_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48365_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48339_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48299_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48319_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48441_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48227_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48205_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48249_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48505_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_48453_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_48*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TX_featnames(CONSTRAINT pk_TX_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.TX_featnames ALTER COLUMN statefp SET DEFAULT '48';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.TX_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('TX_featnames'), lower('TX_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_TX_featnames_snd_name ON tiger_data.TX_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_TX_featnames_lname ON tiger_data.TX_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_TX_featnames_tlid_statefp ON tiger_data.TX_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.TX_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '48');"
%PSQL% -c "vacuum analyze tiger_data.TX_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_48327_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48189_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48361_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48265_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48177_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48391_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48247_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48353_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48245_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48215_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48413_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48181_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48507_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48397_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48309_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48277_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48289_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48435_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48433_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48311_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48367_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48271_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48203_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48383_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48357_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48477_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48333_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48359_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48403_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48305_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48223_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48225_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48461_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48381_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48401_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48237_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48211_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48417_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48407_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48259_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48481_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48255_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48257_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48251_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48473_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48323_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48273_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48317_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48375_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48369_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48449_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48445_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48385_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48275_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48209_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48325_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48345_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48485_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48329_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48469_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48457_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48377_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48489_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48303_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48213_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48471_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48201_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48371_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48347_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48187_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48439_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48239_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48437_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48431_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48495_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48295_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48497_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48419_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48179_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48229_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48491_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48467_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48253_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48185_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48235_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48231_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48335_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48349_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48499_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48243_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48337_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48207_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48151_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48373_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48503_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48287_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48191_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48221_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48405_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48313_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48331_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48389_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48355_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48399_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48443_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48315_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48291_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48241_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48195_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48199_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48447_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48415_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48293_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48387_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48321_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48197_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48363_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48297_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48421_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48463_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48493_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48427_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48267_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48307_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48217_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48263_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48301_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48279_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48233_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48283_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48465_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48423_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48395_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48451_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48501_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48261_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48411_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48269_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48425_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48455_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48183_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48475_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48487_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48193_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48429_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48285_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48393_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48379_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48343_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48281_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48459_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48483_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48409_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48479_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48341_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48351_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48219_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48365_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48339_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48299_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48319_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48441_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48227_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48205_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48249_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48505_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_48453_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_48*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TX_edges(CONSTRAINT pk_TX_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.TX_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('TX_edges'), lower('TX_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.TX_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '48');"
%PSQL% -c "CREATE INDEX idx_tiger_data_TX_edges_tlid ON tiger_data.TX_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_TX_edgestfidr ON tiger_data.TX_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_TX_edges_tfidl ON tiger_data.TX_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_TX_edges_countyfp ON tiger_data.TX_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_TX_edges_the_geom_gist ON tiger_data.TX_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_TX_edges_zipl ON tiger_data.TX_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.TX_zip_state_loc(CONSTRAINT pk_TX_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.TX_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'TX', '48', p.name FROM tiger_data.TX_edges AS e INNER JOIN tiger_data.TX_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.TX_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_TX_zip_state_loc_place ON tiger_data.TX_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.TX_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '48');"
%PSQL% -c "vacuum analyze tiger_data.TX_edges;"
%PSQL% -c "vacuum analyze tiger_data.TX_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.TX_zip_lookup_base(CONSTRAINT pk_TX_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.TX_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'TX', c.name,p.name,'48'  FROM tiger_data.TX_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '48') INNER JOIN tiger_data.TX_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.TX_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.TX_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '48');"
%PSQL% -c "CREATE INDEX idx_tiger_data_TX_zip_lookup_base_citysnd ON tiger_data.TX_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_48327_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48189_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48361_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48265_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48177_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48391_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48247_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48353_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48245_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48215_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48413_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48181_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48507_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48397_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48309_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48277_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48289_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48435_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48433_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48311_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48367_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48271_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48203_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48383_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48357_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48477_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48333_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48359_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48403_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48305_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48223_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48225_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48461_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48381_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48401_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48237_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48211_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48417_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48407_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48259_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48481_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48255_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48257_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48251_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48473_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48323_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48273_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48317_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48375_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48369_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48449_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48445_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48385_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48275_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48209_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48325_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48345_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48485_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48329_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48469_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48457_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48377_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48489_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48303_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48213_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48471_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48201_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48371_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48347_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48187_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48439_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48239_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48437_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48431_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48495_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48295_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48497_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48419_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48179_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48229_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48491_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48467_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48253_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48185_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48235_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48231_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48335_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48349_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48499_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48243_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48337_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48207_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48151_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48373_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48503_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48287_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48191_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48221_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48405_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48313_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48331_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48389_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48355_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48399_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48443_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48315_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48291_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48241_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48195_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48199_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48447_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48415_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48293_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48387_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48321_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48197_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48363_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48297_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48421_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48463_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48493_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48427_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48267_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48307_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48217_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48263_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48301_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48279_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48233_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48283_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48465_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48423_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48395_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48451_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48501_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48261_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48411_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48269_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48425_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48455_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48183_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48475_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48487_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48193_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48429_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48285_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48393_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48379_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48343_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48281_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48459_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48483_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48409_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48479_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48341_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48351_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48219_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48365_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48339_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48299_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48319_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48441_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48227_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48205_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48249_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48505_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_48453_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_48*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.TX_addr(CONSTRAINT pk_TX_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.TX_addr ALTER COLUMN statefp SET DEFAULT '48';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.TX_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('TX_addr'), lower('TX_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.TX_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '48');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_TX_addr_least_address ON tiger_data.TX_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_TX_addr_tlid_statefp ON tiger_data.TX_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_TX_addr_zip ON tiger_data.TX_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.TX_zip_state(CONSTRAINT pk_TX_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.TX_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'TX', '48' FROM tiger_data.TX_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.TX_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '48');"
	%PSQL% -c "vacuum analyze tiger_data.TX_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_49_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_49*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.UT_place(CONSTRAINT pk_UT_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_49_place.dbf tiger_staging.ut_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.UT_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('UT_place'), lower('UT_place')); ALTER TABLE tiger_data.UT_place ADD CONSTRAINT uidx_UT_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_UT_place_soundex_name ON tiger_data.UT_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_UT_place_the_geom_gist ON tiger_data.UT_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.UT_place ADD CONSTRAINT chk_statefp CHECK (statefp = '49');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_49_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_49*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.UT_cousub(CONSTRAINT pk_UT_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_UT_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_49_cousub.dbf tiger_staging.ut_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.UT_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('UT_cousub'), lower('UT_cousub')); ALTER TABLE tiger_data.UT_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '49');"
%PSQL% -c "CREATE INDEX tiger_data_UT_cousub_the_geom_gist ON tiger_data.UT_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_UT_cousub_countyfp ON tiger_data.UT_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_49_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_49*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.UT_tract(CONSTRAINT pk_UT_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_49_tract.dbf tiger_staging.ut_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.UT_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('UT_tract'), lower('UT_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_UT_tract_the_geom_gist ON tiger_data.UT_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.UT_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.UT_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '49');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_49033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_49045_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_49*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.UT_faces(CONSTRAINT pk_UT_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.UT_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('UT_faces'), lower('UT_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_UT_faces_the_geom_gist ON tiger_data.UT_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_UT_faces_tfid ON tiger_data.UT_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_UT_faces_countyfp ON tiger_data.UT_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.UT_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '49');"
	%PSQL% -c "vacuum analyze tiger_data.UT_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_49033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_49045_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_49*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.UT_featnames(CONSTRAINT pk_UT_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.UT_featnames ALTER COLUMN statefp SET DEFAULT '49';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.UT_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('UT_featnames'), lower('UT_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_UT_featnames_snd_name ON tiger_data.UT_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_UT_featnames_lname ON tiger_data.UT_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_UT_featnames_tlid_statefp ON tiger_data.UT_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.UT_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '49');"
%PSQL% -c "vacuum analyze tiger_data.UT_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_49033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_49045_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_49*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.UT_edges(CONSTRAINT pk_UT_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.UT_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('UT_edges'), lower('UT_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.UT_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '49');"
%PSQL% -c "CREATE INDEX idx_tiger_data_UT_edges_tlid ON tiger_data.UT_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_UT_edgestfidr ON tiger_data.UT_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_UT_edges_tfidl ON tiger_data.UT_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_UT_edges_countyfp ON tiger_data.UT_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_UT_edges_the_geom_gist ON tiger_data.UT_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_UT_edges_zipl ON tiger_data.UT_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.UT_zip_state_loc(CONSTRAINT pk_UT_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.UT_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'UT', '49', p.name FROM tiger_data.UT_edges AS e INNER JOIN tiger_data.UT_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.UT_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_UT_zip_state_loc_place ON tiger_data.UT_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.UT_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '49');"
%PSQL% -c "vacuum analyze tiger_data.UT_edges;"
%PSQL% -c "vacuum analyze tiger_data.UT_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.UT_zip_lookup_base(CONSTRAINT pk_UT_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.UT_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'UT', c.name,p.name,'49'  FROM tiger_data.UT_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '49') INNER JOIN tiger_data.UT_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.UT_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.UT_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '49');"
%PSQL% -c "CREATE INDEX idx_tiger_data_UT_zip_lookup_base_citysnd ON tiger_data.UT_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_49033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_49045_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_49*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.UT_addr(CONSTRAINT pk_UT_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.UT_addr ALTER COLUMN statefp SET DEFAULT '49';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.UT_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('UT_addr'), lower('UT_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.UT_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '49');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_UT_addr_least_address ON tiger_data.UT_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_UT_addr_tlid_statefp ON tiger_data.UT_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_UT_addr_zip ON tiger_data.UT_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.UT_zip_state(CONSTRAINT pk_UT_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.UT_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'UT', '49' FROM tiger_data.UT_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.UT_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '49');"
	%PSQL% -c "vacuum analyze tiger_data.UT_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_50_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_50*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VT_place(CONSTRAINT pk_VT_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_50_place.dbf tiger_staging.vt_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.VT_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('VT_place'), lower('VT_place')); ALTER TABLE tiger_data.VT_place ADD CONSTRAINT uidx_VT_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_VT_place_soundex_name ON tiger_data.VT_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_VT_place_the_geom_gist ON tiger_data.VT_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.VT_place ADD CONSTRAINT chk_statefp CHECK (statefp = '50');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_50_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_50*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VT_cousub(CONSTRAINT pk_VT_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_VT_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_50_cousub.dbf tiger_staging.vt_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.VT_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('VT_cousub'), lower('VT_cousub')); ALTER TABLE tiger_data.VT_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '50');"
%PSQL% -c "CREATE INDEX tiger_data_VT_cousub_the_geom_gist ON tiger_data.VT_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VT_cousub_countyfp ON tiger_data.VT_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_50_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_50*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VT_tract(CONSTRAINT pk_VT_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_50_tract.dbf tiger_staging.vt_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.VT_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('VT_tract'), lower('VT_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_VT_tract_the_geom_gist ON tiger_data.VT_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.VT_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.VT_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '50');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_50011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_50019_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_50*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VT_faces(CONSTRAINT pk_VT_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.VT_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('VT_faces'), lower('VT_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_VT_faces_the_geom_gist ON tiger_data.VT_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VT_faces_tfid ON tiger_data.VT_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VT_faces_countyfp ON tiger_data.VT_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.VT_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '50');"
	%PSQL% -c "vacuum analyze tiger_data.VT_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_50011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_50019_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_50*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VT_featnames(CONSTRAINT pk_VT_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.VT_featnames ALTER COLUMN statefp SET DEFAULT '50';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.VT_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('VT_featnames'), lower('VT_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_VT_featnames_snd_name ON tiger_data.VT_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_VT_featnames_lname ON tiger_data.VT_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_VT_featnames_tlid_statefp ON tiger_data.VT_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.VT_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '50');"
%PSQL% -c "vacuum analyze tiger_data.VT_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_50011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_50019_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_50*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VT_edges(CONSTRAINT pk_VT_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.VT_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('VT_edges'), lower('VT_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.VT_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '50');"
%PSQL% -c "CREATE INDEX idx_tiger_data_VT_edges_tlid ON tiger_data.VT_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VT_edgestfidr ON tiger_data.VT_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VT_edges_tfidl ON tiger_data.VT_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VT_edges_countyfp ON tiger_data.VT_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_VT_edges_the_geom_gist ON tiger_data.VT_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VT_edges_zipl ON tiger_data.VT_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.VT_zip_state_loc(CONSTRAINT pk_VT_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.VT_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'VT', '50', p.name FROM tiger_data.VT_edges AS e INNER JOIN tiger_data.VT_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.VT_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_VT_zip_state_loc_place ON tiger_data.VT_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.VT_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '50');"
%PSQL% -c "vacuum analyze tiger_data.VT_edges;"
%PSQL% -c "vacuum analyze tiger_data.VT_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.VT_zip_lookup_base(CONSTRAINT pk_VT_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.VT_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'VT', c.name,p.name,'50'  FROM tiger_data.VT_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '50') INNER JOIN tiger_data.VT_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.VT_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.VT_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '50');"
%PSQL% -c "CREATE INDEX idx_tiger_data_VT_zip_lookup_base_citysnd ON tiger_data.VT_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_50011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_50019_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_50*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VT_addr(CONSTRAINT pk_VT_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.VT_addr ALTER COLUMN statefp SET DEFAULT '50';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.VT_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('VT_addr'), lower('VT_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.VT_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '50');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VT_addr_least_address ON tiger_data.VT_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VT_addr_tlid_statefp ON tiger_data.VT_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VT_addr_zip ON tiger_data.VT_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.VT_zip_state(CONSTRAINT pk_VT_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.VT_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'VT', '50' FROM tiger_data.VT_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.VT_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '50');"
	%PSQL% -c "vacuum analyze tiger_data.VT_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_78_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_78*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VI_place(CONSTRAINT pk_VI_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_78_place.dbf tiger_staging.vi_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.VI_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('VI_place'), lower('VI_place')); ALTER TABLE tiger_data.VI_place ADD CONSTRAINT uidx_VI_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_VI_place_soundex_name ON tiger_data.VI_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_VI_place_the_geom_gist ON tiger_data.VI_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.VI_place ADD CONSTRAINT chk_statefp CHECK (statefp = '78');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_78_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_78*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VI_cousub(CONSTRAINT pk_VI_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_VI_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_78_cousub.dbf tiger_staging.vi_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.VI_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('VI_cousub'), lower('VI_cousub')); ALTER TABLE tiger_data.VI_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '78');"
%PSQL% -c "CREATE INDEX tiger_data_VI_cousub_the_geom_gist ON tiger_data.VI_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VI_cousub_countyfp ON tiger_data.VI_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_78_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_78*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VI_tract(CONSTRAINT pk_VI_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_78_tract.dbf tiger_staging.vi_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.VI_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('VI_tract'), lower('VI_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_VI_tract_the_geom_gist ON tiger_data.VI_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.VI_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.VI_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '78');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_78030_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_78010_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_78020_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_78*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VI_faces(CONSTRAINT pk_VI_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.VI_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('VI_faces'), lower('VI_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_VI_faces_the_geom_gist ON tiger_data.VI_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VI_faces_tfid ON tiger_data.VI_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VI_faces_countyfp ON tiger_data.VI_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.VI_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '78');"
	%PSQL% -c "vacuum analyze tiger_data.VI_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_78030_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_78010_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_78020_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_78*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VI_featnames(CONSTRAINT pk_VI_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.VI_featnames ALTER COLUMN statefp SET DEFAULT '78';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.VI_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('VI_featnames'), lower('VI_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_VI_featnames_snd_name ON tiger_data.VI_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_VI_featnames_lname ON tiger_data.VI_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_VI_featnames_tlid_statefp ON tiger_data.VI_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.VI_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '78');"
%PSQL% -c "vacuum analyze tiger_data.VI_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_78030_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_78010_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_78020_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_78*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VI_edges(CONSTRAINT pk_VI_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.VI_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('VI_edges'), lower('VI_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.VI_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '78');"
%PSQL% -c "CREATE INDEX idx_tiger_data_VI_edges_tlid ON tiger_data.VI_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VI_edgestfidr ON tiger_data.VI_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VI_edges_tfidl ON tiger_data.VI_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VI_edges_countyfp ON tiger_data.VI_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_VI_edges_the_geom_gist ON tiger_data.VI_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VI_edges_zipl ON tiger_data.VI_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.VI_zip_state_loc(CONSTRAINT pk_VI_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.VI_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'VI', '78', p.name FROM tiger_data.VI_edges AS e INNER JOIN tiger_data.VI_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.VI_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_VI_zip_state_loc_place ON tiger_data.VI_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.VI_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '78');"
%PSQL% -c "vacuum analyze tiger_data.VI_edges;"
%PSQL% -c "vacuum analyze tiger_data.VI_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.VI_zip_lookup_base(CONSTRAINT pk_VI_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.VI_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'VI', c.name,p.name,'78'  FROM tiger_data.VI_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '78') INNER JOIN tiger_data.VI_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.VI_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.VI_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '78');"
%PSQL% -c "CREATE INDEX idx_tiger_data_VI_zip_lookup_base_citysnd ON tiger_data.VI_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_78030_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_78010_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_78020_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_78*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VI_addr(CONSTRAINT pk_VI_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.VI_addr ALTER COLUMN statefp SET DEFAULT '78';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.VI_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('VI_addr'), lower('VI_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.VI_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '78');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VI_addr_least_address ON tiger_data.VI_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VI_addr_tlid_statefp ON tiger_data.VI_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VI_addr_zip ON tiger_data.VI_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.VI_zip_state(CONSTRAINT pk_VI_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.VI_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'VI', '78' FROM tiger_data.VI_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.VI_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '78');"
	%PSQL% -c "vacuum analyze tiger_data.VI_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_51_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_51*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VA_place(CONSTRAINT pk_VA_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_51_place.dbf tiger_staging.va_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.VA_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('VA_place'), lower('VA_place')); ALTER TABLE tiger_data.VA_place ADD CONSTRAINT uidx_VA_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_VA_place_soundex_name ON tiger_data.VA_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_VA_place_the_geom_gist ON tiger_data.VA_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.VA_place ADD CONSTRAINT chk_statefp CHECK (statefp = '51');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_51_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_51*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VA_cousub(CONSTRAINT pk_VA_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_VA_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_51_cousub.dbf tiger_staging.va_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.VA_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('VA_cousub'), lower('VA_cousub')); ALTER TABLE tiger_data.VA_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '51');"
%PSQL% -c "CREATE INDEX tiger_data_VA_cousub_the_geom_gist ON tiger_data.VA_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VA_cousub_countyfp ON tiger_data.VA_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_51_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_51*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VA_tract(CONSTRAINT pk_VA_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_51_tract.dbf tiger_staging.va_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.VA_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('VA_tract'), lower('VA_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_VA_tract_the_geom_gist ON tiger_data.VA_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.VA_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.VA_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '51');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_51775_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51735_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51179_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51167_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51181_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51510_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51540_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51820_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51157_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51595_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51580_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51760_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51145_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51610_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51770_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51550_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51750_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51600_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51660_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51620_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51530_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51143_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51197_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51153_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51169_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51036_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51685_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51700_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51840_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51183_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51173_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51191_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51161_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51590_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51670_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51171_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51740_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51678_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51155_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51710_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51520_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51720_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51790_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51830_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51193_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51163_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51195_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51690_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51630_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51147_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51640_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51680_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51730_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51175_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51800_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51185_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51199_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51165_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51187_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51683_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51177_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51149_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51650_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51570_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51810_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51159_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_51117_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_51*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VA_faces(CONSTRAINT pk_VA_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.VA_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('VA_faces'), lower('VA_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_VA_faces_the_geom_gist ON tiger_data.VA_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VA_faces_tfid ON tiger_data.VA_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VA_faces_countyfp ON tiger_data.VA_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.VA_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '51');"
	%PSQL% -c "vacuum analyze tiger_data.VA_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_51775_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51735_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51179_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51167_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51181_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51510_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51540_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51820_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51157_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51595_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51580_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51760_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51145_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51610_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51770_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51550_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51750_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51600_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51660_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51620_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51530_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51143_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51197_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51153_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51169_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51036_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51685_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51700_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51840_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51183_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51173_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51191_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51161_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51590_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51670_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51171_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51740_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51678_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51155_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51710_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51520_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51720_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51790_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51830_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51193_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51163_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51195_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51690_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51630_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51147_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51640_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51680_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51730_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51175_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51800_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51185_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51199_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51165_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51187_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51683_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51177_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51149_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51650_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51570_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51810_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51159_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_51117_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_51*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VA_featnames(CONSTRAINT pk_VA_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.VA_featnames ALTER COLUMN statefp SET DEFAULT '51';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.VA_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('VA_featnames'), lower('VA_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_VA_featnames_snd_name ON tiger_data.VA_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_VA_featnames_lname ON tiger_data.VA_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_VA_featnames_tlid_statefp ON tiger_data.VA_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.VA_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '51');"
%PSQL% -c "vacuum analyze tiger_data.VA_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_51775_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51735_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51179_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51167_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51181_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51510_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51540_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51820_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51157_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51595_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51580_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51760_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51145_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51610_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51770_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51550_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51750_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51600_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51660_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51620_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51530_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51143_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51197_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51153_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51169_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51036_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51685_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51700_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51840_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51183_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51173_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51191_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51161_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51590_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51670_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51171_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51740_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51678_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51155_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51710_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51520_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51720_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51790_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51830_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51193_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51163_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51195_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51690_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51630_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51147_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51640_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51680_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51730_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51175_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51800_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51185_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51199_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51165_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51187_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51683_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51177_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51149_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51650_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51570_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51810_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51159_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_51117_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_51*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VA_edges(CONSTRAINT pk_VA_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.VA_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('VA_edges'), lower('VA_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.VA_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '51');"
%PSQL% -c "CREATE INDEX idx_tiger_data_VA_edges_tlid ON tiger_data.VA_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VA_edgestfidr ON tiger_data.VA_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VA_edges_tfidl ON tiger_data.VA_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VA_edges_countyfp ON tiger_data.VA_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_VA_edges_the_geom_gist ON tiger_data.VA_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_VA_edges_zipl ON tiger_data.VA_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.VA_zip_state_loc(CONSTRAINT pk_VA_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.VA_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'VA', '51', p.name FROM tiger_data.VA_edges AS e INNER JOIN tiger_data.VA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.VA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_VA_zip_state_loc_place ON tiger_data.VA_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.VA_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '51');"
%PSQL% -c "vacuum analyze tiger_data.VA_edges;"
%PSQL% -c "vacuum analyze tiger_data.VA_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.VA_zip_lookup_base(CONSTRAINT pk_VA_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.VA_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'VA', c.name,p.name,'51'  FROM tiger_data.VA_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '51') INNER JOIN tiger_data.VA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.VA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.VA_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '51');"
%PSQL% -c "CREATE INDEX idx_tiger_data_VA_zip_lookup_base_citysnd ON tiger_data.VA_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_51775_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51735_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51179_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51167_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51181_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51510_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51540_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51820_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51157_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51595_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51580_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51760_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51145_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51610_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51770_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51550_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51750_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51600_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51660_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51620_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51530_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51143_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51197_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51153_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51169_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51036_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51685_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51700_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51840_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51183_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51173_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51191_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51161_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51590_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51670_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51171_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51740_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51678_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51155_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51710_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51520_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51720_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51790_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51830_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51193_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51163_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51195_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51690_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51630_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51147_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51640_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51680_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51730_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51175_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51800_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51185_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51199_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51165_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51187_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51683_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51177_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51149_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51650_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51570_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51810_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51159_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_51117_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_51*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.VA_addr(CONSTRAINT pk_VA_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.VA_addr ALTER COLUMN statefp SET DEFAULT '51';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.VA_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('VA_addr'), lower('VA_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.VA_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '51');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VA_addr_least_address ON tiger_data.VA_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VA_addr_tlid_statefp ON tiger_data.VA_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_VA_addr_zip ON tiger_data.VA_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.VA_zip_state(CONSTRAINT pk_VA_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.VA_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'VA', '51' FROM tiger_data.VA_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.VA_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '51');"
	%PSQL% -c "vacuum analyze tiger_data.VA_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_53_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_53*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WA_place(CONSTRAINT pk_WA_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_53_place.dbf tiger_staging.wa_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.WA_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('WA_place'), lower('WA_place')); ALTER TABLE tiger_data.WA_place ADD CONSTRAINT uidx_WA_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_WA_place_soundex_name ON tiger_data.WA_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_WA_place_the_geom_gist ON tiger_data.WA_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.WA_place ADD CONSTRAINT chk_statefp CHECK (statefp = '53');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_53_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_53*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WA_cousub(CONSTRAINT pk_WA_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_WA_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_53_cousub.dbf tiger_staging.wa_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.WA_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('WA_cousub'), lower('WA_cousub')); ALTER TABLE tiger_data.WA_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '53');"
%PSQL% -c "CREATE INDEX tiger_data_WA_cousub_the_geom_gist ON tiger_data.WA_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WA_cousub_countyfp ON tiger_data.WA_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_53_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_53*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WA_tract(CONSTRAINT pk_WA_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_53_tract.dbf tiger_staging.wa_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.WA_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('WA_tract'), lower('WA_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_WA_tract_the_geom_gist ON tiger_data.WA_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.WA_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.WA_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '53');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_53069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_53059_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_53*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WA_faces(CONSTRAINT pk_WA_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WA_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WA_faces'), lower('WA_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_WA_faces_the_geom_gist ON tiger_data.WA_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WA_faces_tfid ON tiger_data.WA_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WA_faces_countyfp ON tiger_data.WA_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.WA_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '53');"
	%PSQL% -c "vacuum analyze tiger_data.WA_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_53069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_53059_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_53*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WA_featnames(CONSTRAINT pk_WA_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.WA_featnames ALTER COLUMN statefp SET DEFAULT '53';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WA_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WA_featnames'), lower('WA_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_WA_featnames_snd_name ON tiger_data.WA_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_WA_featnames_lname ON tiger_data.WA_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_WA_featnames_tlid_statefp ON tiger_data.WA_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.WA_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '53');"
%PSQL% -c "vacuum analyze tiger_data.WA_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_53069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_53059_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_53*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WA_edges(CONSTRAINT pk_WA_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WA_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WA_edges'), lower('WA_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.WA_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '53');"
%PSQL% -c "CREATE INDEX idx_tiger_data_WA_edges_tlid ON tiger_data.WA_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WA_edgestfidr ON tiger_data.WA_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WA_edges_tfidl ON tiger_data.WA_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WA_edges_countyfp ON tiger_data.WA_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_WA_edges_the_geom_gist ON tiger_data.WA_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WA_edges_zipl ON tiger_data.WA_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.WA_zip_state_loc(CONSTRAINT pk_WA_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.WA_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'WA', '53', p.name FROM tiger_data.WA_edges AS e INNER JOIN tiger_data.WA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.WA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_WA_zip_state_loc_place ON tiger_data.WA_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.WA_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '53');"
%PSQL% -c "vacuum analyze tiger_data.WA_edges;"
%PSQL% -c "vacuum analyze tiger_data.WA_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.WA_zip_lookup_base(CONSTRAINT pk_WA_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.WA_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'WA', c.name,p.name,'53'  FROM tiger_data.WA_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '53') INNER JOIN tiger_data.WA_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.WA_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.WA_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '53');"
%PSQL% -c "CREATE INDEX idx_tiger_data_WA_zip_lookup_base_citysnd ON tiger_data.WA_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_53069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_53059_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_53*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WA_addr(CONSTRAINT pk_WA_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.WA_addr ALTER COLUMN statefp SET DEFAULT '53';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WA_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WA_addr'), lower('WA_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.WA_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '53');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WA_addr_least_address ON tiger_data.WA_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WA_addr_tlid_statefp ON tiger_data.WA_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WA_addr_zip ON tiger_data.WA_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.WA_zip_state(CONSTRAINT pk_WA_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.WA_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'WA', '53' FROM tiger_data.WA_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.WA_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '53');"
	%PSQL% -c "vacuum analyze tiger_data.WA_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_54_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_54*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WV_place(CONSTRAINT pk_WV_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_54_place.dbf tiger_staging.wv_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.WV_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('WV_place'), lower('WV_place')); ALTER TABLE tiger_data.WV_place ADD CONSTRAINT uidx_WV_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_WV_place_soundex_name ON tiger_data.WV_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_WV_place_the_geom_gist ON tiger_data.WV_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.WV_place ADD CONSTRAINT chk_statefp CHECK (statefp = '54');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_54_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_54*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WV_cousub(CONSTRAINT pk_WV_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_WV_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_54_cousub.dbf tiger_staging.wv_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.WV_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('WV_cousub'), lower('WV_cousub')); ALTER TABLE tiger_data.WV_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '54');"
%PSQL% -c "CREATE INDEX tiger_data_WV_cousub_the_geom_gist ON tiger_data.WV_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WV_cousub_countyfp ON tiger_data.WV_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_54_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_54*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WV_tract(CONSTRAINT pk_WV_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_54_tract.dbf tiger_staging.wv_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.WV_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('WV_tract'), lower('WV_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_WV_tract_the_geom_gist ON tiger_data.WV_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.WV_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.WV_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '54');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_54075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_54099_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_54*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WV_faces(CONSTRAINT pk_WV_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WV_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WV_faces'), lower('WV_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_WV_faces_the_geom_gist ON tiger_data.WV_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WV_faces_tfid ON tiger_data.WV_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WV_faces_countyfp ON tiger_data.WV_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.WV_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '54');"
	%PSQL% -c "vacuum analyze tiger_data.WV_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_54075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_54099_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_54*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WV_featnames(CONSTRAINT pk_WV_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.WV_featnames ALTER COLUMN statefp SET DEFAULT '54';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WV_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WV_featnames'), lower('WV_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_WV_featnames_snd_name ON tiger_data.WV_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_WV_featnames_lname ON tiger_data.WV_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_WV_featnames_tlid_statefp ON tiger_data.WV_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.WV_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '54');"
%PSQL% -c "vacuum analyze tiger_data.WV_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_54075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_54099_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_54*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WV_edges(CONSTRAINT pk_WV_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WV_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WV_edges'), lower('WV_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.WV_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '54');"
%PSQL% -c "CREATE INDEX idx_tiger_data_WV_edges_tlid ON tiger_data.WV_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WV_edgestfidr ON tiger_data.WV_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WV_edges_tfidl ON tiger_data.WV_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WV_edges_countyfp ON tiger_data.WV_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_WV_edges_the_geom_gist ON tiger_data.WV_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WV_edges_zipl ON tiger_data.WV_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.WV_zip_state_loc(CONSTRAINT pk_WV_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.WV_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'WV', '54', p.name FROM tiger_data.WV_edges AS e INNER JOIN tiger_data.WV_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.WV_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_WV_zip_state_loc_place ON tiger_data.WV_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.WV_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '54');"
%PSQL% -c "vacuum analyze tiger_data.WV_edges;"
%PSQL% -c "vacuum analyze tiger_data.WV_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.WV_zip_lookup_base(CONSTRAINT pk_WV_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.WV_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'WV', c.name,p.name,'54'  FROM tiger_data.WV_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '54') INNER JOIN tiger_data.WV_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.WV_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.WV_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '54');"
%PSQL% -c "CREATE INDEX idx_tiger_data_WV_zip_lookup_base_citysnd ON tiger_data.WV_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_54075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_54099_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_54*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WV_addr(CONSTRAINT pk_WV_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.WV_addr ALTER COLUMN statefp SET DEFAULT '54';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WV_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WV_addr'), lower('WV_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.WV_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '54');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WV_addr_least_address ON tiger_data.WV_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WV_addr_tlid_statefp ON tiger_data.WV_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WV_addr_zip ON tiger_data.WV_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.WV_zip_state(CONSTRAINT pk_WV_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.WV_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'WV', '54' FROM tiger_data.WV_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.WV_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '54');"
	%PSQL% -c "vacuum analyze tiger_data.WV_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_55_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_55*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WI_place(CONSTRAINT pk_WI_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_55_place.dbf tiger_staging.wi_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.WI_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('WI_place'), lower('WI_place')); ALTER TABLE tiger_data.WI_place ADD CONSTRAINT uidx_WI_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_WI_place_soundex_name ON tiger_data.WI_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_WI_place_the_geom_gist ON tiger_data.WI_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.WI_place ADD CONSTRAINT chk_statefp CHECK (statefp = '55');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_55_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_55*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WI_cousub(CONSTRAINT pk_WI_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_WI_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_55_cousub.dbf tiger_staging.wi_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.WI_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('WI_cousub'), lower('WI_cousub')); ALTER TABLE tiger_data.WI_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '55');"
%PSQL% -c "CREATE INDEX tiger_data_WI_cousub_the_geom_gist ON tiger_data.WI_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WI_cousub_countyfp ON tiger_data.WI_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_55_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_55*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WI_tract(CONSTRAINT pk_WI_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_55_tract.dbf tiger_staging.wi_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.WI_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('WI_tract'), lower('WI_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_WI_tract_the_geom_gist ON tiger_data.WI_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.WI_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.WI_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '55');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_55111_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55093_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55063_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55053_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55047_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55127_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55123_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55059_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55079_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55085_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55137_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55129_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55065_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55135_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55125_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55089_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55117_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55131_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55097_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55061_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55067_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55105_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55083_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55113_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55121_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55095_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55087_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55119_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55073_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55051_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55081_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55101_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55115_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55015_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55055_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55077_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55103_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55141_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55139_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55069_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55091_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55049_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55075_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55099_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55109_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55057_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55107_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55133_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55078_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55071_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_55029_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_55*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WI_faces(CONSTRAINT pk_WI_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WI_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WI_faces'), lower('WI_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_WI_faces_the_geom_gist ON tiger_data.WI_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WI_faces_tfid ON tiger_data.WI_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WI_faces_countyfp ON tiger_data.WI_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.WI_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '55');"
	%PSQL% -c "vacuum analyze tiger_data.WI_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_55111_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55093_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55063_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55053_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55047_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55127_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55123_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55059_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55079_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55085_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55137_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55129_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55065_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55135_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55125_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55089_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55117_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55131_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55097_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55061_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55067_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55105_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55083_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55113_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55121_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55095_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55087_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55119_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55073_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55051_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55081_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55101_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55115_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55015_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55055_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55077_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55103_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55141_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55139_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55069_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55091_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55049_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55075_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55099_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55109_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55057_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55107_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55133_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55078_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55071_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_55029_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_55*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WI_featnames(CONSTRAINT pk_WI_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.WI_featnames ALTER COLUMN statefp SET DEFAULT '55';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WI_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WI_featnames'), lower('WI_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_WI_featnames_snd_name ON tiger_data.WI_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_WI_featnames_lname ON tiger_data.WI_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_WI_featnames_tlid_statefp ON tiger_data.WI_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.WI_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '55');"
%PSQL% -c "vacuum analyze tiger_data.WI_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_55111_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55093_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55063_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55053_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55047_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55127_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55123_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55059_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55079_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55085_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55137_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55129_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55065_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55135_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55125_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55089_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55117_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55131_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55097_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55061_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55067_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55105_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55083_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55113_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55121_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55095_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55087_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55119_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55073_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55051_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55081_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55101_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55115_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55015_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55055_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55077_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55103_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55141_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55139_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55069_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55091_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55049_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55075_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55099_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55109_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55057_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55107_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55133_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55078_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55071_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_55029_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_55*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WI_edges(CONSTRAINT pk_WI_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WI_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WI_edges'), lower('WI_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.WI_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '55');"
%PSQL% -c "CREATE INDEX idx_tiger_data_WI_edges_tlid ON tiger_data.WI_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WI_edgestfidr ON tiger_data.WI_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WI_edges_tfidl ON tiger_data.WI_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WI_edges_countyfp ON tiger_data.WI_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_WI_edges_the_geom_gist ON tiger_data.WI_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WI_edges_zipl ON tiger_data.WI_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.WI_zip_state_loc(CONSTRAINT pk_WI_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.WI_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'WI', '55', p.name FROM tiger_data.WI_edges AS e INNER JOIN tiger_data.WI_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.WI_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_WI_zip_state_loc_place ON tiger_data.WI_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.WI_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '55');"
%PSQL% -c "vacuum analyze tiger_data.WI_edges;"
%PSQL% -c "vacuum analyze tiger_data.WI_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.WI_zip_lookup_base(CONSTRAINT pk_WI_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.WI_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'WI', c.name,p.name,'55'  FROM tiger_data.WI_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '55') INNER JOIN tiger_data.WI_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.WI_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.WI_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '55');"
%PSQL% -c "CREATE INDEX idx_tiger_data_WI_zip_lookup_base_citysnd ON tiger_data.WI_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_55111_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55093_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55063_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55053_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55047_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55127_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55123_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55059_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55079_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55085_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55137_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55129_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55065_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55135_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55125_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55089_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55117_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55131_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55097_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55061_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55067_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55105_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55083_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55113_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55121_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55095_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55087_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55119_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55073_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55051_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55081_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55101_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55115_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55015_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55055_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55077_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55103_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55141_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55139_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55069_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55091_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55049_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55075_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55099_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55109_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55057_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55107_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55133_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55078_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55071_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_55029_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_55*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WI_addr(CONSTRAINT pk_WI_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.WI_addr ALTER COLUMN statefp SET DEFAULT '55';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WI_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WI_addr'), lower('WI_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.WI_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '55');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WI_addr_least_address ON tiger_data.WI_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WI_addr_tlid_statefp ON tiger_data.WI_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WI_addr_zip ON tiger_data.WI_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.WI_zip_state(CONSTRAINT pk_WI_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.WI_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'WI', '55' FROM tiger_data.WI_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.WI_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '55');"
	%PSQL% -c "vacuum analyze tiger_data.WI_addr;"
set TMPDIR="D:\gisdata\temp"
set UNZIPTOOL="C:\Program Files\WinRAR\Rar.exe"
set WGETTOOL="C:\Program Files\wget-1.20.3-win64\wget.exe"
set PGBIN=C:\Program Files\PostgreSQL\11\bin\
set PGPORT=5432
set PGHOST=localhost
set PGUSER=postgres
set PGPASSWORD=ee194098
set PGDATABASE=hat
set PSQL="C:\Program Files\PostgreSQL\11\bin\psql.exe"
set SHP2PGSQL="C:\Program Files\PostgreSQL\11\bin\shp2pgsql.exe"
cd "D:\gisdata"

cd \gisdata
copy D:/gisdata/PLACE/tl_2017_56_place.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/PLACE
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_56*_place.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WY_place(CONSTRAINT pk_WY_place PRIMARY KEY (plcidfp) ) INHERITS(tiger.place);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_56_place.dbf tiger_staging.wy_place | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.WY_place RENAME geoid TO plcidfp;SELECT loader_load_staged_data(lower('WY_place'), lower('WY_place')); ALTER TABLE tiger_data.WY_place ADD CONSTRAINT uidx_WY_place_gid UNIQUE (gid);"
%PSQL% -c "CREATE INDEX idx_WY_place_soundex_name ON tiger_data.WY_place USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX tiger_data_WY_place_the_geom_gist ON tiger_data.WY_place USING gist(the_geom);"
%PSQL% -c "ALTER TABLE tiger_data.WY_place ADD CONSTRAINT chk_statefp CHECK (statefp = '56');"
cd \gisdata
copy D:/gisdata/COUSUB/tl_2017_56_cousub.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/COUSUB
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_56*_cousub.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WY_cousub(CONSTRAINT pk_WY_cousub PRIMARY KEY (cosbidfp), CONSTRAINT uidx_WY_cousub_gid UNIQUE (gid)) INHERITS(tiger.cousub);" 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_56_cousub.dbf tiger_staging.wy_cousub | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.WY_cousub RENAME geoid TO cosbidfp;SELECT loader_load_staged_data(lower('WY_cousub'), lower('WY_cousub')); ALTER TABLE tiger_data.WY_cousub ADD CONSTRAINT chk_statefp CHECK (statefp = '56');"
%PSQL% -c "CREATE INDEX tiger_data_WY_cousub_the_geom_gist ON tiger_data.WY_cousub USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WY_cousub_countyfp ON tiger_data.WY_cousub USING btree(countyfp);"
cd \gisdata
copy D:/gisdata/TRACT/tl_2017_56_tract.zip D:/gisdata/
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/TRACT
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_2017_56*_tract.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WY_tract(CONSTRAINT pk_WY_tract PRIMARY KEY (tract_id) ) INHERITS(tiger.tract); " 
%SHP2PGSQL% -D -c -s 4269 -g the_geom   -W "latin1" tl_2017_56_tract.dbf tiger_staging.wy_tract | %PSQL%
%PSQL% -c "ALTER TABLE tiger_staging.WY_tract RENAME geoid TO tract_id;  SELECT loader_load_staged_data(lower('WY_tract'), lower('WY_tract')); "
	%PSQL% -c "CREATE INDEX tiger_data_WY_tract_the_geom_gist ON tiger_data.WY_tract USING gist(the_geom);"
	%PSQL% -c "VACUUM ANALYZE tiger_data.WY_tract;"
	%PSQL% -c "ALTER TABLE tiger_data.WY_tract ADD CONSTRAINT chk_statefp CHECK (statefp = '56');"
cd \gisdata
copy D:/gisdata/FACES/tl_2017_56023_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56013_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56041_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56003_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56017_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56043_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56009_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56037_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56011_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56007_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56005_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56025_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56021_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56031_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56045_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56001_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56029_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56019_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56033_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56027_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56039_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56035_faces.zip D:/gistdata
 copy D:/gisdata/FACES/tl_2017_56015_faces.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FACES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_56*_faces*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WY_faces(CONSTRAINT pk_WY_faces PRIMARY KEY (gid)) INHERITS(tiger.faces);" 
for /r %%z in (*faces*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WY_faces | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WY_faces'), lower('WY_faces'));")

%PSQL% -c "CREATE INDEX tiger_data_WY_faces_the_geom_gist ON tiger_data.WY_faces USING gist(the_geom);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WY_faces_tfid ON tiger_data.WY_faces USING btree (tfid);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WY_faces_countyfp ON tiger_data.WY_faces USING btree (countyfp);"
	%PSQL% -c "ALTER TABLE tiger_data.WY_faces ADD CONSTRAINT chk_statefp CHECK (statefp = '56');"
	%PSQL% -c "vacuum analyze tiger_data.WY_faces;"
cd \gisdata
copy D:/gisdata/FEATNAMES/tl_2017_56023_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56013_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56041_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56003_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56017_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56043_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56009_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56037_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56011_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56007_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56005_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56025_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56021_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56031_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56045_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56001_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56029_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56019_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56033_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56027_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56039_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56035_featnames.zip D:/gistdata
 copy D:/gisdata/FEATNAMES/tl_2017_56015_featnames.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/FEATNAMES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_56*_featnames*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WY_featnames(CONSTRAINT pk_WY_featnames PRIMARY KEY (gid)) INHERITS(tiger.featnames);ALTER TABLE tiger_data.WY_featnames ALTER COLUMN statefp SET DEFAULT '56';" 
for /r %%z in (*featnames*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WY_featnames | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WY_featnames'), lower('WY_featnames'));")

%PSQL% -c "CREATE INDEX idx_tiger_data_WY_featnames_snd_name ON tiger_data.WY_featnames USING btree (soundex(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_WY_featnames_lname ON tiger_data.WY_featnames USING btree (lower(name));"
%PSQL% -c "CREATE INDEX idx_tiger_data_WY_featnames_tlid_statefp ON tiger_data.WY_featnames USING btree (tlid,statefp);"
%PSQL% -c "ALTER TABLE tiger_data.WY_featnames ADD CONSTRAINT chk_statefp CHECK (statefp = '56');"
%PSQL% -c "vacuum analyze tiger_data.WY_featnames;"
cd \gisdata
copy D:/gisdata/EDGES/tl_2017_56023_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56013_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56041_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56003_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56017_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56043_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56009_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56037_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56011_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56007_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56005_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56025_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56021_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56031_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56045_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56001_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56029_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56019_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56033_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56027_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56039_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56035_edges.zip D:/gistdata
 copy D:/gisdata/EDGES/tl_2017_56015_edges.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/EDGES/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_56*_edges*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WY_edges(CONSTRAINT pk_WY_edges PRIMARY KEY (gid)) INHERITS(tiger.edges);"
for /r %%z in (*edges*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WY_edges | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WY_edges'), lower('WY_edges'));")

%PSQL% -c "ALTER TABLE tiger_data.WY_edges ADD CONSTRAINT chk_statefp CHECK (statefp = '56');"
%PSQL% -c "CREATE INDEX idx_tiger_data_WY_edges_tlid ON tiger_data.WY_edges USING btree (tlid);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WY_edgestfidr ON tiger_data.WY_edges USING btree (tfidr);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WY_edges_tfidl ON tiger_data.WY_edges USING btree (tfidl);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WY_edges_countyfp ON tiger_data.WY_edges USING btree (countyfp);"
%PSQL% -c "CREATE INDEX tiger_data_WY_edges_the_geom_gist ON tiger_data.WY_edges USING gist(the_geom);"
%PSQL% -c "CREATE INDEX idx_tiger_data_WY_edges_zipl ON tiger_data.WY_edges USING btree (zipl);"
%PSQL% -c "CREATE TABLE tiger_data.WY_zip_state_loc(CONSTRAINT pk_WY_zip_state_loc PRIMARY KEY(zip,stusps,place)) INHERITS(tiger.zip_state_loc);"
%PSQL% -c "INSERT INTO tiger_data.WY_zip_state_loc(zip,stusps,statefp,place) SELECT DISTINCT e.zipl, 'WY', '56', p.name FROM tiger_data.WY_edges AS e INNER JOIN tiger_data.WY_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.WY_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "CREATE INDEX idx_tiger_data_WY_zip_state_loc_place ON tiger_data.WY_zip_state_loc USING btree(soundex(place));"
%PSQL% -c "ALTER TABLE tiger_data.WY_zip_state_loc ADD CONSTRAINT chk_statefp CHECK (statefp = '56');"
%PSQL% -c "vacuum analyze tiger_data.WY_edges;"
%PSQL% -c "vacuum analyze tiger_data.WY_zip_state_loc;"
%PSQL% -c "CREATE TABLE tiger_data.WY_zip_lookup_base(CONSTRAINT pk_WY_zip_state_loc_city PRIMARY KEY(zip,state, county, city, statefp)) INHERITS(tiger.zip_lookup_base);"
%PSQL% -c "INSERT INTO tiger_data.WY_zip_lookup_base(zip,state,county,city, statefp) SELECT DISTINCT e.zipl, 'WY', c.name,p.name,'56'  FROM tiger_data.WY_edges AS e INNER JOIN tiger.county As c  ON (e.countyfp = c.countyfp AND e.statefp = c.statefp AND e.statefp = '56') INNER JOIN tiger_data.WY_faces AS f ON (e.tfidl = f.tfid OR e.tfidr = f.tfid) INNER JOIN tiger_data.WY_place As p ON(f.statefp = p.statefp AND f.placefp = p.placefp ) WHERE e.zipl IS NOT NULL;"
%PSQL% -c "ALTER TABLE tiger_data.WY_zip_lookup_base ADD CONSTRAINT chk_statefp CHECK (statefp = '56');"
%PSQL% -c "CREATE INDEX idx_tiger_data_WY_zip_lookup_base_citysnd ON tiger_data.WY_zip_lookup_base USING btree(soundex(city));"
cd \gisdata
copy D:/gisdata/ADDR/tl_2017_56023_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56013_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56041_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56003_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56017_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56043_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56009_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56037_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56011_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56007_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56005_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56025_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56021_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56031_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56045_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56001_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56029_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56019_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56033_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56027_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56039_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56035_addr.zip D:/gistdata
 copy D:/gisdata/ADDR/tl_2017_56015_addr.zip D:/gistdata
cd \gisdata/www2.census.gov/geo/tiger/TIGER2017/ADDR/
del %TMPDIR%\*.* /Q
%PSQL% -c "DROP SCHEMA IF EXISTS tiger_staging CASCADE;"
%PSQL% -c "CREATE SCHEMA tiger_staging;"
%PSQL% -c "DO language 'plpgsql' $$ BEGIN IF NOT EXISTS (SELECT * FROM information_schema.schemata WHERE schema_name = 'tiger_data' ) THEN CREATE SCHEMA tiger_data; END IF;  END $$"
for /r %%z in (tl_*_56*_addr*.zip ) do %UNZIPTOOL% e %%z  -o%TMPDIR%
cd %TMPDIR%
%PSQL% -c "CREATE TABLE tiger_data.WY_addr(CONSTRAINT pk_WY_addr PRIMARY KEY (gid)) INHERITS(tiger.addr);ALTER TABLE tiger_data.WY_addr ALTER COLUMN statefp SET DEFAULT '56';" 
for /r %%z in (*addr*.dbf) do (%SHP2PGSQL% -D   -D -s 4269 -g the_geom -W "latin1" %%z tiger_staging.WY_addr | %PSQL% & %PSQL% -c "SELECT loader_load_staged_data(lower('WY_addr'), lower('WY_addr'));")

%PSQL% -c "ALTER TABLE tiger_data.WY_addr ADD CONSTRAINT chk_statefp CHECK (statefp = '56');"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WY_addr_least_address ON tiger_data.WY_addr USING btree (least_hn(fromhn,tohn) );"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WY_addr_tlid_statefp ON tiger_data.WY_addr USING btree (tlid, statefp);"
	%PSQL% -c "CREATE INDEX idx_tiger_data_WY_addr_zip ON tiger_data.WY_addr USING btree (zip);"
	%PSQL% -c "CREATE TABLE tiger_data.WY_zip_state(CONSTRAINT pk_WY_zip_state PRIMARY KEY(zip,stusps)) INHERITS(tiger.zip_state); "
	%PSQL% -c "INSERT INTO tiger_data.WY_zip_state(zip,stusps,statefp) SELECT DISTINCT zip, 'WY', '56' FROM tiger_data.WY_addr WHERE zip is not null;"
	%PSQL% -c "ALTER TABLE tiger_data.WY_zip_state ADD CONSTRAINT chk_statefp CHECK (statefp = '56');"
	%PSQL% -c "vacuum analyze tiger_data.WY_addr;"
